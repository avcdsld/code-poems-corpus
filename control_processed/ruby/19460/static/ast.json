{
  "type": "program",
  "start": {
    "row": 0,
    "column": 0
  },
  "end": {
    "row": 36,
    "column": 5
  },
  "text": "def parse_series_formula(formula)  # :nodoc:\n    encoding = 0\n    length   = 0\n    count    = 0\n    tokens = []\n\n    return [''] if formula.nil?\n\n    # Strip the = sign at the beginning of the formula string\n    formula = formula.sub(/^=/, '')\n\n    # In order to raise formula errors from the point of view of the calling\n    # program we use an eval block and re-raise the error from here.\n    #\n    tokens = parser.parse_formula(formula)\n\n    # Force ranges to be a reference class.\n    tokens.collect! { |t| t.gsub(/_ref3d/, '_ref3dR') }\n    tokens.collect! { |t| t.gsub(/_range3d/, '_range3dR') }\n    tokens.collect! { |t| t.gsub(/_name/, '_nameR') }\n\n    # Parse the tokens into a formula string.\n    formula = parser.parse_tokens(tokens)\n\n    # Return formula for a single cell as used by title and series name.\n    return formula if formula.ord == 0x3A\n\n    # Extract the range from the parse formula.\n    if formula.ord == 0x3B\n        ptg, ext_ref, row_1, row_2, col_1, col_2 = formula.unpack('Cv5')\n\n        # TODO. Remove high bit on relative references.\n        count = row_2 - row_1 + 1\n    end\n\n    [formula, count]\n  end",
  "children": [
    {
      "type": "method",
      "start": {
        "row": 0,
        "column": 0
      },
      "end": {
        "row": 36,
        "column": 5
      },
      "text": "def parse_series_formula(formula)  # :nodoc:\n    encoding = 0\n    length   = 0\n    count    = 0\n    tokens = []\n\n    return [''] if formula.nil?\n\n    # Strip the = sign at the beginning of the formula string\n    formula = formula.sub(/^=/, '')\n\n    # In order to raise formula errors from the point of view of the calling\n    # program we use an eval block and re-raise the error from here.\n    #\n    tokens = parser.parse_formula(formula)\n\n    # Force ranges to be a reference class.\n    tokens.collect! { |t| t.gsub(/_ref3d/, '_ref3dR') }\n    tokens.collect! { |t| t.gsub(/_range3d/, '_range3dR') }\n    tokens.collect! { |t| t.gsub(/_name/, '_nameR') }\n\n    # Parse the tokens into a formula string.\n    formula = parser.parse_tokens(tokens)\n\n    # Return formula for a single cell as used by title and series name.\n    return formula if formula.ord == 0x3A\n\n    # Extract the range from the parse formula.\n    if formula.ord == 0x3B\n        ptg, ext_ref, row_1, row_2, col_1, col_2 = formula.unpack('Cv5')\n\n        # TODO. Remove high bit on relative references.\n        count = row_2 - row_1 + 1\n    end\n\n    [formula, count]\n  end",
      "children": [
        {
          "type": "def",
          "start": {
            "row": 0,
            "column": 0
          },
          "end": {
            "row": 0,
            "column": 3
          },
          "text": "def"
        },
        {
          "type": "identifier",
          "start": {
            "row": 0,
            "column": 4
          },
          "end": {
            "row": 0,
            "column": 24
          },
          "text": "parse_series_formula"
        },
        {
          "type": "method_parameters",
          "start": {
            "row": 0,
            "column": 24
          },
          "end": {
            "row": 0,
            "column": 33
          },
          "text": "(formula)",
          "children": [
            {
              "type": "(",
              "start": {
                "row": 0,
                "column": 24
              },
              "end": {
                "row": 0,
                "column": 25
              },
              "text": "("
            },
            {
              "type": "identifier",
              "start": {
                "row": 0,
                "column": 25
              },
              "end": {
                "row": 0,
                "column": 32
              },
              "text": "formula"
            },
            {
              "type": ")",
              "start": {
                "row": 0,
                "column": 32
              },
              "end": {
                "row": 0,
                "column": 33
              },
              "text": ")"
            }
          ]
        },
        {
          "type": "comment",
          "start": {
            "row": 0,
            "column": 35
          },
          "end": {
            "row": 0,
            "column": 44
          },
          "text": "# :nodoc:"
        },
        {
          "type": "body_statement",
          "start": {
            "row": 1,
            "column": 4
          },
          "end": {
            "row": 35,
            "column": 20
          },
          "text": "encoding = 0\n    length   = 0\n    count    = 0\n    tokens = []\n\n    return [''] if formula.nil?\n\n    # Strip the = sign at the beginning of the formula string\n    formula = formula.sub(/^=/, '')\n\n    # In order to raise formula errors from the point of view of the calling\n    # program we use an eval block and re-raise the error from here.\n    #\n    tokens = parser.parse_formula(formula)\n\n    # Force ranges to be a reference class.\n    tokens.collect! { |t| t.gsub(/_ref3d/, '_ref3dR') }\n    tokens.collect! { |t| t.gsub(/_range3d/, '_range3dR') }\n    tokens.collect! { |t| t.gsub(/_name/, '_nameR') }\n\n    # Parse the tokens into a formula string.\n    formula = parser.parse_tokens(tokens)\n\n    # Return formula for a single cell as used by title and series name.\n    return formula if formula.ord == 0x3A\n\n    # Extract the range from the parse formula.\n    if formula.ord == 0x3B\n        ptg, ext_ref, row_1, row_2, col_1, col_2 = formula.unpack('Cv5')\n\n        # TODO. Remove high bit on relative references.\n        count = row_2 - row_1 + 1\n    end\n\n    [formula, count]",
          "children": [
            {
              "type": "assignment",
              "start": {
                "row": 1,
                "column": 4
              },
              "end": {
                "row": 1,
                "column": 16
              },
              "text": "encoding = 0",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 4
                  },
                  "end": {
                    "row": 1,
                    "column": 12
                  },
                  "text": "encoding"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 1,
                    "column": 13
                  },
                  "end": {
                    "row": 1,
                    "column": 14
                  },
                  "text": "="
                },
                {
                  "type": "integer",
                  "start": {
                    "row": 1,
                    "column": 15
                  },
                  "end": {
                    "row": 1,
                    "column": 16
                  },
                  "text": "0"
                }
              ]
            },
            {
              "type": "assignment",
              "start": {
                "row": 2,
                "column": 4
              },
              "end": {
                "row": 2,
                "column": 16
              },
              "text": "length   = 0",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 2,
                    "column": 4
                  },
                  "end": {
                    "row": 2,
                    "column": 10
                  },
                  "text": "length"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 2,
                    "column": 13
                  },
                  "end": {
                    "row": 2,
                    "column": 14
                  },
                  "text": "="
                },
                {
                  "type": "integer",
                  "start": {
                    "row": 2,
                    "column": 15
                  },
                  "end": {
                    "row": 2,
                    "column": 16
                  },
                  "text": "0"
                }
              ]
            },
            {
              "type": "assignment",
              "start": {
                "row": 3,
                "column": 4
              },
              "end": {
                "row": 3,
                "column": 16
              },
              "text": "count    = 0",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 3,
                    "column": 4
                  },
                  "end": {
                    "row": 3,
                    "column": 9
                  },
                  "text": "count"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 3,
                    "column": 13
                  },
                  "end": {
                    "row": 3,
                    "column": 14
                  },
                  "text": "="
                },
                {
                  "type": "integer",
                  "start": {
                    "row": 3,
                    "column": 15
                  },
                  "end": {
                    "row": 3,
                    "column": 16
                  },
                  "text": "0"
                }
              ]
            },
            {
              "type": "assignment",
              "start": {
                "row": 4,
                "column": 4
              },
              "end": {
                "row": 4,
                "column": 15
              },
              "text": "tokens = []",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 4,
                    "column": 4
                  },
                  "end": {
                    "row": 4,
                    "column": 10
                  },
                  "text": "tokens"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 4,
                    "column": 11
                  },
                  "end": {
                    "row": 4,
                    "column": 12
                  },
                  "text": "="
                },
                {
                  "type": "array",
                  "start": {
                    "row": 4,
                    "column": 13
                  },
                  "end": {
                    "row": 4,
                    "column": 15
                  },
                  "text": "[]",
                  "children": [
                    {
                      "type": "[",
                      "start": {
                        "row": 4,
                        "column": 13
                      },
                      "end": {
                        "row": 4,
                        "column": 14
                      },
                      "text": "["
                    },
                    {
                      "type": "]",
                      "start": {
                        "row": 4,
                        "column": 14
                      },
                      "end": {
                        "row": 4,
                        "column": 15
                      },
                      "text": "]"
                    }
                  ]
                }
              ]
            },
            {
              "type": "if_modifier",
              "start": {
                "row": 6,
                "column": 4
              },
              "end": {
                "row": 6,
                "column": 31
              },
              "text": "return [''] if formula.nil?",
              "children": [
                {
                  "type": "return",
                  "start": {
                    "row": 6,
                    "column": 4
                  },
                  "end": {
                    "row": 6,
                    "column": 15
                  },
                  "text": "return ['']",
                  "children": [
                    {
                      "type": "return",
                      "start": {
                        "row": 6,
                        "column": 4
                      },
                      "end": {
                        "row": 6,
                        "column": 10
                      },
                      "text": "return"
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 6,
                        "column": 11
                      },
                      "end": {
                        "row": 6,
                        "column": 15
                      },
                      "text": "['']",
                      "children": [
                        {
                          "type": "array",
                          "start": {
                            "row": 6,
                            "column": 11
                          },
                          "end": {
                            "row": 6,
                            "column": 15
                          },
                          "text": "['']",
                          "children": [
                            {
                              "type": "[",
                              "start": {
                                "row": 6,
                                "column": 11
                              },
                              "end": {
                                "row": 6,
                                "column": 12
                              },
                              "text": "["
                            },
                            {
                              "type": "string",
                              "start": {
                                "row": 6,
                                "column": 12
                              },
                              "end": {
                                "row": 6,
                                "column": 14
                              },
                              "text": "''",
                              "children": [
                                {
                                  "type": "\"",
                                  "start": {
                                    "row": 6,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 6,
                                    "column": 13
                                  },
                                  "text": "'"
                                },
                                {
                                  "type": "\"",
                                  "start": {
                                    "row": 6,
                                    "column": 13
                                  },
                                  "end": {
                                    "row": 6,
                                    "column": 14
                                  },
                                  "text": "'"
                                }
                              ]
                            },
                            {
                              "type": "]",
                              "start": {
                                "row": 6,
                                "column": 14
                              },
                              "end": {
                                "row": 6,
                                "column": 15
                              },
                              "text": "]"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "if",
                  "start": {
                    "row": 6,
                    "column": 16
                  },
                  "end": {
                    "row": 6,
                    "column": 18
                  },
                  "text": "if"
                },
                {
                  "type": "call",
                  "start": {
                    "row": 6,
                    "column": 19
                  },
                  "end": {
                    "row": 6,
                    "column": 31
                  },
                  "text": "formula.nil?",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 6,
                        "column": 19
                      },
                      "end": {
                        "row": 6,
                        "column": 26
                      },
                      "text": "formula"
                    },
                    {
                      "type": ".",
                      "start": {
                        "row": 6,
                        "column": 26
                      },
                      "end": {
                        "row": 6,
                        "column": 27
                      },
                      "text": "."
                    },
                    {
                      "type": "identifier",
                      "start": {
                        "row": 6,
                        "column": 27
                      },
                      "end": {
                        "row": 6,
                        "column": 31
                      },
                      "text": "nil?"
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 8,
                "column": 4
              },
              "end": {
                "row": 8,
                "column": 61
              },
              "text": "# Strip the = sign at the beginning of the formula string"
            },
            {
              "type": "assignment",
              "start": {
                "row": 9,
                "column": 4
              },
              "end": {
                "row": 9,
                "column": 35
              },
              "text": "formula = formula.sub(/^=/, '')",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 9,
                    "column": 4
                  },
                  "end": {
                    "row": 9,
                    "column": 11
                  },
                  "text": "formula"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 9,
                    "column": 12
                  },
                  "end": {
                    "row": 9,
                    "column": 13
                  },
                  "text": "="
                },
                {
                  "type": "call",
                  "start": {
                    "row": 9,
                    "column": 14
                  },
                  "end": {
                    "row": 9,
                    "column": 35
                  },
                  "text": "formula.sub(/^=/, '')",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 9,
                        "column": 14
                      },
                      "end": {
                        "row": 9,
                        "column": 21
                      },
                      "text": "formula"
                    },
                    {
                      "type": ".",
                      "start": {
                        "row": 9,
                        "column": 21
                      },
                      "end": {
                        "row": 9,
                        "column": 22
                      },
                      "text": "."
                    },
                    {
                      "type": "identifier",
                      "start": {
                        "row": 9,
                        "column": 22
                      },
                      "end": {
                        "row": 9,
                        "column": 25
                      },
                      "text": "sub"
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 9,
                        "column": 25
                      },
                      "end": {
                        "row": 9,
                        "column": 35
                      },
                      "text": "(/^=/, '')",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 9,
                            "column": 25
                          },
                          "end": {
                            "row": 9,
                            "column": 26
                          },
                          "text": "("
                        },
                        {
                          "type": "regex",
                          "start": {
                            "row": 9,
                            "column": 26
                          },
                          "end": {
                            "row": 9,
                            "column": 30
                          },
                          "text": "/^=/",
                          "children": [
                            {
                              "type": "/",
                              "start": {
                                "row": 9,
                                "column": 26
                              },
                              "end": {
                                "row": 9,
                                "column": 27
                              },
                              "text": "/"
                            },
                            {
                              "type": "string_content",
                              "start": {
                                "row": 9,
                                "column": 27
                              },
                              "end": {
                                "row": 9,
                                "column": 29
                              },
                              "text": "^="
                            },
                            {
                              "type": "/",
                              "start": {
                                "row": 9,
                                "column": 29
                              },
                              "end": {
                                "row": 9,
                                "column": 30
                              },
                              "text": "/"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 9,
                            "column": 30
                          },
                          "end": {
                            "row": 9,
                            "column": 31
                          },
                          "text": ","
                        },
                        {
                          "type": "string",
                          "start": {
                            "row": 9,
                            "column": 32
                          },
                          "end": {
                            "row": 9,
                            "column": 34
                          },
                          "text": "''",
                          "children": [
                            {
                              "type": "\"",
                              "start": {
                                "row": 9,
                                "column": 32
                              },
                              "end": {
                                "row": 9,
                                "column": 33
                              },
                              "text": "'"
                            },
                            {
                              "type": "\"",
                              "start": {
                                "row": 9,
                                "column": 33
                              },
                              "end": {
                                "row": 9,
                                "column": 34
                              },
                              "text": "'"
                            }
                          ]
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 9,
                            "column": 34
                          },
                          "end": {
                            "row": 9,
                            "column": 35
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 11,
                "column": 4
              },
              "end": {
                "row": 11,
                "column": 76
              },
              "text": "# In order to raise formula errors from the point of view of the calling"
            },
            {
              "type": "comment",
              "start": {
                "row": 12,
                "column": 4
              },
              "end": {
                "row": 12,
                "column": 68
              },
              "text": "# program we use an eval block and re-raise the error from here."
            },
            {
              "type": "comment",
              "start": {
                "row": 13,
                "column": 4
              },
              "end": {
                "row": 13,
                "column": 5
              },
              "text": "#"
            },
            {
              "type": "assignment",
              "start": {
                "row": 14,
                "column": 4
              },
              "end": {
                "row": 14,
                "column": 42
              },
              "text": "tokens = parser.parse_formula(formula)",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 14,
                    "column": 4
                  },
                  "end": {
                    "row": 14,
                    "column": 10
                  },
                  "text": "tokens"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 14,
                    "column": 11
                  },
                  "end": {
                    "row": 14,
                    "column": 12
                  },
                  "text": "="
                },
                {
                  "type": "call",
                  "start": {
                    "row": 14,
                    "column": 13
                  },
                  "end": {
                    "row": 14,
                    "column": 42
                  },
                  "text": "parser.parse_formula(formula)",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 14,
                        "column": 13
                      },
                      "end": {
                        "row": 14,
                        "column": 19
                      },
                      "text": "parser"
                    },
                    {
                      "type": ".",
                      "start": {
                        "row": 14,
                        "column": 19
                      },
                      "end": {
                        "row": 14,
                        "column": 20
                      },
                      "text": "."
                    },
                    {
                      "type": "identifier",
                      "start": {
                        "row": 14,
                        "column": 20
                      },
                      "end": {
                        "row": 14,
                        "column": 33
                      },
                      "text": "parse_formula"
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 14,
                        "column": 33
                      },
                      "end": {
                        "row": 14,
                        "column": 42
                      },
                      "text": "(formula)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 14,
                            "column": 33
                          },
                          "end": {
                            "row": 14,
                            "column": 34
                          },
                          "text": "("
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 14,
                            "column": 34
                          },
                          "end": {
                            "row": 14,
                            "column": 41
                          },
                          "text": "formula"
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 14,
                            "column": 41
                          },
                          "end": {
                            "row": 14,
                            "column": 42
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 16,
                "column": 4
              },
              "end": {
                "row": 16,
                "column": 43
              },
              "text": "# Force ranges to be a reference class."
            },
            {
              "type": "call",
              "start": {
                "row": 17,
                "column": 4
              },
              "end": {
                "row": 17,
                "column": 55
              },
              "text": "tokens.collect! { |t| t.gsub(/_ref3d/, '_ref3dR') }",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 17,
                    "column": 4
                  },
                  "end": {
                    "row": 17,
                    "column": 10
                  },
                  "text": "tokens"
                },
                {
                  "type": ".",
                  "start": {
                    "row": 17,
                    "column": 10
                  },
                  "end": {
                    "row": 17,
                    "column": 11
                  },
                  "text": "."
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 17,
                    "column": 11
                  },
                  "end": {
                    "row": 17,
                    "column": 19
                  },
                  "text": "collect!"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 17,
                    "column": 20
                  },
                  "end": {
                    "row": 17,
                    "column": 55
                  },
                  "text": "{ |t| t.gsub(/_ref3d/, '_ref3dR') }",
                  "children": [
                    {
                      "type": "{",
                      "start": {
                        "row": 17,
                        "column": 20
                      },
                      "end": {
                        "row": 17,
                        "column": 21
                      },
                      "text": "{"
                    },
                    {
                      "type": "block_parameters",
                      "start": {
                        "row": 17,
                        "column": 22
                      },
                      "end": {
                        "row": 17,
                        "column": 25
                      },
                      "text": "|t|",
                      "children": [
                        {
                          "type": "|",
                          "start": {
                            "row": 17,
                            "column": 22
                          },
                          "end": {
                            "row": 17,
                            "column": 23
                          },
                          "text": "|"
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 17,
                            "column": 23
                          },
                          "end": {
                            "row": 17,
                            "column": 24
                          },
                          "text": "t"
                        },
                        {
                          "type": "|",
                          "start": {
                            "row": 17,
                            "column": 24
                          },
                          "end": {
                            "row": 17,
                            "column": 25
                          },
                          "text": "|"
                        }
                      ]
                    },
                    {
                      "type": "block_body",
                      "start": {
                        "row": 17,
                        "column": 26
                      },
                      "end": {
                        "row": 17,
                        "column": 53
                      },
                      "text": "t.gsub(/_ref3d/, '_ref3dR')",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 17,
                            "column": 26
                          },
                          "end": {
                            "row": 17,
                            "column": 53
                          },
                          "text": "t.gsub(/_ref3d/, '_ref3dR')",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 17,
                                "column": 26
                              },
                              "end": {
                                "row": 17,
                                "column": 27
                              },
                              "text": "t"
                            },
                            {
                              "type": ".",
                              "start": {
                                "row": 17,
                                "column": 27
                              },
                              "end": {
                                "row": 17,
                                "column": 28
                              },
                              "text": "."
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 17,
                                "column": 28
                              },
                              "end": {
                                "row": 17,
                                "column": 32
                              },
                              "text": "gsub"
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 17,
                                "column": 32
                              },
                              "end": {
                                "row": 17,
                                "column": 53
                              },
                              "text": "(/_ref3d/, '_ref3dR')",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 17,
                                    "column": 32
                                  },
                                  "end": {
                                    "row": 17,
                                    "column": 33
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "regex",
                                  "start": {
                                    "row": 17,
                                    "column": 33
                                  },
                                  "end": {
                                    "row": 17,
                                    "column": 41
                                  },
                                  "text": "/_ref3d/",
                                  "children": [
                                    {
                                      "type": "/",
                                      "start": {
                                        "row": 17,
                                        "column": 33
                                      },
                                      "end": {
                                        "row": 17,
                                        "column": 34
                                      },
                                      "text": "/"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 17,
                                        "column": 34
                                      },
                                      "end": {
                                        "row": 17,
                                        "column": 40
                                      },
                                      "text": "_ref3d"
                                    },
                                    {
                                      "type": "/",
                                      "start": {
                                        "row": 17,
                                        "column": 40
                                      },
                                      "end": {
                                        "row": 17,
                                        "column": 41
                                      },
                                      "text": "/"
                                    }
                                  ]
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 17,
                                    "column": 41
                                  },
                                  "end": {
                                    "row": 17,
                                    "column": 42
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "string",
                                  "start": {
                                    "row": 17,
                                    "column": 43
                                  },
                                  "end": {
                                    "row": 17,
                                    "column": 52
                                  },
                                  "text": "'_ref3dR'",
                                  "children": [
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 17,
                                        "column": 43
                                      },
                                      "end": {
                                        "row": 17,
                                        "column": 44
                                      },
                                      "text": "'"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 17,
                                        "column": 44
                                      },
                                      "end": {
                                        "row": 17,
                                        "column": 51
                                      },
                                      "text": "_ref3dR"
                                    },
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 17,
                                        "column": 51
                                      },
                                      "end": {
                                        "row": 17,
                                        "column": 52
                                      },
                                      "text": "'"
                                    }
                                  ]
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 17,
                                    "column": 52
                                  },
                                  "end": {
                                    "row": 17,
                                    "column": 53
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "}",
                      "start": {
                        "row": 17,
                        "column": 54
                      },
                      "end": {
                        "row": 17,
                        "column": 55
                      },
                      "text": "}"
                    }
                  ]
                }
              ]
            },
            {
              "type": "call",
              "start": {
                "row": 18,
                "column": 4
              },
              "end": {
                "row": 18,
                "column": 59
              },
              "text": "tokens.collect! { |t| t.gsub(/_range3d/, '_range3dR') }",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 18,
                    "column": 4
                  },
                  "end": {
                    "row": 18,
                    "column": 10
                  },
                  "text": "tokens"
                },
                {
                  "type": ".",
                  "start": {
                    "row": 18,
                    "column": 10
                  },
                  "end": {
                    "row": 18,
                    "column": 11
                  },
                  "text": "."
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 18,
                    "column": 11
                  },
                  "end": {
                    "row": 18,
                    "column": 19
                  },
                  "text": "collect!"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 18,
                    "column": 20
                  },
                  "end": {
                    "row": 18,
                    "column": 59
                  },
                  "text": "{ |t| t.gsub(/_range3d/, '_range3dR') }",
                  "children": [
                    {
                      "type": "{",
                      "start": {
                        "row": 18,
                        "column": 20
                      },
                      "end": {
                        "row": 18,
                        "column": 21
                      },
                      "text": "{"
                    },
                    {
                      "type": "block_parameters",
                      "start": {
                        "row": 18,
                        "column": 22
                      },
                      "end": {
                        "row": 18,
                        "column": 25
                      },
                      "text": "|t|",
                      "children": [
                        {
                          "type": "|",
                          "start": {
                            "row": 18,
                            "column": 22
                          },
                          "end": {
                            "row": 18,
                            "column": 23
                          },
                          "text": "|"
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 18,
                            "column": 23
                          },
                          "end": {
                            "row": 18,
                            "column": 24
                          },
                          "text": "t"
                        },
                        {
                          "type": "|",
                          "start": {
                            "row": 18,
                            "column": 24
                          },
                          "end": {
                            "row": 18,
                            "column": 25
                          },
                          "text": "|"
                        }
                      ]
                    },
                    {
                      "type": "block_body",
                      "start": {
                        "row": 18,
                        "column": 26
                      },
                      "end": {
                        "row": 18,
                        "column": 57
                      },
                      "text": "t.gsub(/_range3d/, '_range3dR')",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 18,
                            "column": 26
                          },
                          "end": {
                            "row": 18,
                            "column": 57
                          },
                          "text": "t.gsub(/_range3d/, '_range3dR')",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 18,
                                "column": 26
                              },
                              "end": {
                                "row": 18,
                                "column": 27
                              },
                              "text": "t"
                            },
                            {
                              "type": ".",
                              "start": {
                                "row": 18,
                                "column": 27
                              },
                              "end": {
                                "row": 18,
                                "column": 28
                              },
                              "text": "."
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 18,
                                "column": 28
                              },
                              "end": {
                                "row": 18,
                                "column": 32
                              },
                              "text": "gsub"
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 18,
                                "column": 32
                              },
                              "end": {
                                "row": 18,
                                "column": 57
                              },
                              "text": "(/_range3d/, '_range3dR')",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 18,
                                    "column": 32
                                  },
                                  "end": {
                                    "row": 18,
                                    "column": 33
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "regex",
                                  "start": {
                                    "row": 18,
                                    "column": 33
                                  },
                                  "end": {
                                    "row": 18,
                                    "column": 43
                                  },
                                  "text": "/_range3d/",
                                  "children": [
                                    {
                                      "type": "/",
                                      "start": {
                                        "row": 18,
                                        "column": 33
                                      },
                                      "end": {
                                        "row": 18,
                                        "column": 34
                                      },
                                      "text": "/"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 18,
                                        "column": 34
                                      },
                                      "end": {
                                        "row": 18,
                                        "column": 42
                                      },
                                      "text": "_range3d"
                                    },
                                    {
                                      "type": "/",
                                      "start": {
                                        "row": 18,
                                        "column": 42
                                      },
                                      "end": {
                                        "row": 18,
                                        "column": 43
                                      },
                                      "text": "/"
                                    }
                                  ]
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 18,
                                    "column": 43
                                  },
                                  "end": {
                                    "row": 18,
                                    "column": 44
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "string",
                                  "start": {
                                    "row": 18,
                                    "column": 45
                                  },
                                  "end": {
                                    "row": 18,
                                    "column": 56
                                  },
                                  "text": "'_range3dR'",
                                  "children": [
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 18,
                                        "column": 45
                                      },
                                      "end": {
                                        "row": 18,
                                        "column": 46
                                      },
                                      "text": "'"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 18,
                                        "column": 46
                                      },
                                      "end": {
                                        "row": 18,
                                        "column": 55
                                      },
                                      "text": "_range3dR"
                                    },
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 18,
                                        "column": 55
                                      },
                                      "end": {
                                        "row": 18,
                                        "column": 56
                                      },
                                      "text": "'"
                                    }
                                  ]
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 18,
                                    "column": 56
                                  },
                                  "end": {
                                    "row": 18,
                                    "column": 57
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "}",
                      "start": {
                        "row": 18,
                        "column": 58
                      },
                      "end": {
                        "row": 18,
                        "column": 59
                      },
                      "text": "}"
                    }
                  ]
                }
              ]
            },
            {
              "type": "call",
              "start": {
                "row": 19,
                "column": 4
              },
              "end": {
                "row": 19,
                "column": 53
              },
              "text": "tokens.collect! { |t| t.gsub(/_name/, '_nameR') }",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 19,
                    "column": 4
                  },
                  "end": {
                    "row": 19,
                    "column": 10
                  },
                  "text": "tokens"
                },
                {
                  "type": ".",
                  "start": {
                    "row": 19,
                    "column": 10
                  },
                  "end": {
                    "row": 19,
                    "column": 11
                  },
                  "text": "."
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 19,
                    "column": 11
                  },
                  "end": {
                    "row": 19,
                    "column": 19
                  },
                  "text": "collect!"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 19,
                    "column": 20
                  },
                  "end": {
                    "row": 19,
                    "column": 53
                  },
                  "text": "{ |t| t.gsub(/_name/, '_nameR') }",
                  "children": [
                    {
                      "type": "{",
                      "start": {
                        "row": 19,
                        "column": 20
                      },
                      "end": {
                        "row": 19,
                        "column": 21
                      },
                      "text": "{"
                    },
                    {
                      "type": "block_parameters",
                      "start": {
                        "row": 19,
                        "column": 22
                      },
                      "end": {
                        "row": 19,
                        "column": 25
                      },
                      "text": "|t|",
                      "children": [
                        {
                          "type": "|",
                          "start": {
                            "row": 19,
                            "column": 22
                          },
                          "end": {
                            "row": 19,
                            "column": 23
                          },
                          "text": "|"
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 19,
                            "column": 23
                          },
                          "end": {
                            "row": 19,
                            "column": 24
                          },
                          "text": "t"
                        },
                        {
                          "type": "|",
                          "start": {
                            "row": 19,
                            "column": 24
                          },
                          "end": {
                            "row": 19,
                            "column": 25
                          },
                          "text": "|"
                        }
                      ]
                    },
                    {
                      "type": "block_body",
                      "start": {
                        "row": 19,
                        "column": 26
                      },
                      "end": {
                        "row": 19,
                        "column": 51
                      },
                      "text": "t.gsub(/_name/, '_nameR')",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 19,
                            "column": 26
                          },
                          "end": {
                            "row": 19,
                            "column": 51
                          },
                          "text": "t.gsub(/_name/, '_nameR')",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 19,
                                "column": 26
                              },
                              "end": {
                                "row": 19,
                                "column": 27
                              },
                              "text": "t"
                            },
                            {
                              "type": ".",
                              "start": {
                                "row": 19,
                                "column": 27
                              },
                              "end": {
                                "row": 19,
                                "column": 28
                              },
                              "text": "."
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 19,
                                "column": 28
                              },
                              "end": {
                                "row": 19,
                                "column": 32
                              },
                              "text": "gsub"
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 19,
                                "column": 32
                              },
                              "end": {
                                "row": 19,
                                "column": 51
                              },
                              "text": "(/_name/, '_nameR')",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 19,
                                    "column": 32
                                  },
                                  "end": {
                                    "row": 19,
                                    "column": 33
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "regex",
                                  "start": {
                                    "row": 19,
                                    "column": 33
                                  },
                                  "end": {
                                    "row": 19,
                                    "column": 40
                                  },
                                  "text": "/_name/",
                                  "children": [
                                    {
                                      "type": "/",
                                      "start": {
                                        "row": 19,
                                        "column": 33
                                      },
                                      "end": {
                                        "row": 19,
                                        "column": 34
                                      },
                                      "text": "/"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 19,
                                        "column": 34
                                      },
                                      "end": {
                                        "row": 19,
                                        "column": 39
                                      },
                                      "text": "_name"
                                    },
                                    {
                                      "type": "/",
                                      "start": {
                                        "row": 19,
                                        "column": 39
                                      },
                                      "end": {
                                        "row": 19,
                                        "column": 40
                                      },
                                      "text": "/"
                                    }
                                  ]
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 19,
                                    "column": 40
                                  },
                                  "end": {
                                    "row": 19,
                                    "column": 41
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "string",
                                  "start": {
                                    "row": 19,
                                    "column": 42
                                  },
                                  "end": {
                                    "row": 19,
                                    "column": 50
                                  },
                                  "text": "'_nameR'",
                                  "children": [
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 19,
                                        "column": 42
                                      },
                                      "end": {
                                        "row": 19,
                                        "column": 43
                                      },
                                      "text": "'"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 19,
                                        "column": 43
                                      },
                                      "end": {
                                        "row": 19,
                                        "column": 49
                                      },
                                      "text": "_nameR"
                                    },
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 19,
                                        "column": 49
                                      },
                                      "end": {
                                        "row": 19,
                                        "column": 50
                                      },
                                      "text": "'"
                                    }
                                  ]
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 19,
                                    "column": 50
                                  },
                                  "end": {
                                    "row": 19,
                                    "column": 51
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "}",
                      "start": {
                        "row": 19,
                        "column": 52
                      },
                      "end": {
                        "row": 19,
                        "column": 53
                      },
                      "text": "}"
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 21,
                "column": 4
              },
              "end": {
                "row": 21,
                "column": 45
              },
              "text": "# Parse the tokens into a formula string."
            },
            {
              "type": "assignment",
              "start": {
                "row": 22,
                "column": 4
              },
              "end": {
                "row": 22,
                "column": 41
              },
              "text": "formula = parser.parse_tokens(tokens)",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 22,
                    "column": 4
                  },
                  "end": {
                    "row": 22,
                    "column": 11
                  },
                  "text": "formula"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 22,
                    "column": 12
                  },
                  "end": {
                    "row": 22,
                    "column": 13
                  },
                  "text": "="
                },
                {
                  "type": "call",
                  "start": {
                    "row": 22,
                    "column": 14
                  },
                  "end": {
                    "row": 22,
                    "column": 41
                  },
                  "text": "parser.parse_tokens(tokens)",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 22,
                        "column": 14
                      },
                      "end": {
                        "row": 22,
                        "column": 20
                      },
                      "text": "parser"
                    },
                    {
                      "type": ".",
                      "start": {
                        "row": 22,
                        "column": 20
                      },
                      "end": {
                        "row": 22,
                        "column": 21
                      },
                      "text": "."
                    },
                    {
                      "type": "identifier",
                      "start": {
                        "row": 22,
                        "column": 21
                      },
                      "end": {
                        "row": 22,
                        "column": 33
                      },
                      "text": "parse_tokens"
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 22,
                        "column": 33
                      },
                      "end": {
                        "row": 22,
                        "column": 41
                      },
                      "text": "(tokens)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 22,
                            "column": 33
                          },
                          "end": {
                            "row": 22,
                            "column": 34
                          },
                          "text": "("
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 22,
                            "column": 34
                          },
                          "end": {
                            "row": 22,
                            "column": 40
                          },
                          "text": "tokens"
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 22,
                            "column": 40
                          },
                          "end": {
                            "row": 22,
                            "column": 41
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 24,
                "column": 4
              },
              "end": {
                "row": 24,
                "column": 72
              },
              "text": "# Return formula for a single cell as used by title and series name."
            },
            {
              "type": "if_modifier",
              "start": {
                "row": 25,
                "column": 4
              },
              "end": {
                "row": 25,
                "column": 41
              },
              "text": "return formula if formula.ord == 0x3A",
              "children": [
                {
                  "type": "return",
                  "start": {
                    "row": 25,
                    "column": 4
                  },
                  "end": {
                    "row": 25,
                    "column": 18
                  },
                  "text": "return formula",
                  "children": [
                    {
                      "type": "return",
                      "start": {
                        "row": 25,
                        "column": 4
                      },
                      "end": {
                        "row": 25,
                        "column": 10
                      },
                      "text": "return"
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 25,
                        "column": 11
                      },
                      "end": {
                        "row": 25,
                        "column": 18
                      },
                      "text": "formula",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 25,
                            "column": 11
                          },
                          "end": {
                            "row": 25,
                            "column": 18
                          },
                          "text": "formula"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "if",
                  "start": {
                    "row": 25,
                    "column": 19
                  },
                  "end": {
                    "row": 25,
                    "column": 21
                  },
                  "text": "if"
                },
                {
                  "type": "binary",
                  "start": {
                    "row": 25,
                    "column": 22
                  },
                  "end": {
                    "row": 25,
                    "column": 41
                  },
                  "text": "formula.ord == 0x3A",
                  "children": [
                    {
                      "type": "call",
                      "start": {
                        "row": 25,
                        "column": 22
                      },
                      "end": {
                        "row": 25,
                        "column": 33
                      },
                      "text": "formula.ord",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 25,
                            "column": 22
                          },
                          "end": {
                            "row": 25,
                            "column": 29
                          },
                          "text": "formula"
                        },
                        {
                          "type": ".",
                          "start": {
                            "row": 25,
                            "column": 29
                          },
                          "end": {
                            "row": 25,
                            "column": 30
                          },
                          "text": "."
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 25,
                            "column": 30
                          },
                          "end": {
                            "row": 25,
                            "column": 33
                          },
                          "text": "ord"
                        }
                      ]
                    },
                    {
                      "type": "==",
                      "start": {
                        "row": 25,
                        "column": 34
                      },
                      "end": {
                        "row": 25,
                        "column": 36
                      },
                      "text": "=="
                    },
                    {
                      "type": "integer",
                      "start": {
                        "row": 25,
                        "column": 37
                      },
                      "end": {
                        "row": 25,
                        "column": 41
                      },
                      "text": "0x3A"
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 27,
                "column": 4
              },
              "end": {
                "row": 27,
                "column": 47
              },
              "text": "# Extract the range from the parse formula."
            },
            {
              "type": "if",
              "start": {
                "row": 28,
                "column": 4
              },
              "end": {
                "row": 33,
                "column": 7
              },
              "text": "if formula.ord == 0x3B\n        ptg, ext_ref, row_1, row_2, col_1, col_2 = formula.unpack('Cv5')\n\n        # TODO. Remove high bit on relative references.\n        count = row_2 - row_1 + 1\n    end",
              "children": [
                {
                  "type": "if",
                  "start": {
                    "row": 28,
                    "column": 4
                  },
                  "end": {
                    "row": 28,
                    "column": 6
                  },
                  "text": "if"
                },
                {
                  "type": "binary",
                  "start": {
                    "row": 28,
                    "column": 7
                  },
                  "end": {
                    "row": 28,
                    "column": 26
                  },
                  "text": "formula.ord == 0x3B",
                  "children": [
                    {
                      "type": "call",
                      "start": {
                        "row": 28,
                        "column": 7
                      },
                      "end": {
                        "row": 28,
                        "column": 18
                      },
                      "text": "formula.ord",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 28,
                            "column": 7
                          },
                          "end": {
                            "row": 28,
                            "column": 14
                          },
                          "text": "formula"
                        },
                        {
                          "type": ".",
                          "start": {
                            "row": 28,
                            "column": 14
                          },
                          "end": {
                            "row": 28,
                            "column": 15
                          },
                          "text": "."
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 28,
                            "column": 15
                          },
                          "end": {
                            "row": 28,
                            "column": 18
                          },
                          "text": "ord"
                        }
                      ]
                    },
                    {
                      "type": "==",
                      "start": {
                        "row": 28,
                        "column": 19
                      },
                      "end": {
                        "row": 28,
                        "column": 21
                      },
                      "text": "=="
                    },
                    {
                      "type": "integer",
                      "start": {
                        "row": 28,
                        "column": 22
                      },
                      "end": {
                        "row": 28,
                        "column": 26
                      },
                      "text": "0x3B"
                    }
                  ]
                },
                {
                  "type": "then",
                  "start": {
                    "row": 28,
                    "column": 26
                  },
                  "end": {
                    "row": 32,
                    "column": 33
                  },
                  "text": "\n        ptg, ext_ref, row_1, row_2, col_1, col_2 = formula.unpack('Cv5')\n\n        # TODO. Remove high bit on relative references.\n        count = row_2 - row_1 + 1",
                  "children": [
                    {
                      "type": "assignment",
                      "start": {
                        "row": 29,
                        "column": 8
                      },
                      "end": {
                        "row": 29,
                        "column": 72
                      },
                      "text": "ptg, ext_ref, row_1, row_2, col_1, col_2 = formula.unpack('Cv5')",
                      "children": [
                        {
                          "type": "left_assignment_list",
                          "start": {
                            "row": 29,
                            "column": 8
                          },
                          "end": {
                            "row": 29,
                            "column": 48
                          },
                          "text": "ptg, ext_ref, row_1, row_2, col_1, col_2",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 8
                              },
                              "end": {
                                "row": 29,
                                "column": 11
                              },
                              "text": "ptg"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 29,
                                "column": 11
                              },
                              "end": {
                                "row": 29,
                                "column": 12
                              },
                              "text": ","
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 13
                              },
                              "end": {
                                "row": 29,
                                "column": 20
                              },
                              "text": "ext_ref"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 29,
                                "column": 20
                              },
                              "end": {
                                "row": 29,
                                "column": 21
                              },
                              "text": ","
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 22
                              },
                              "end": {
                                "row": 29,
                                "column": 27
                              },
                              "text": "row_1"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 29,
                                "column": 27
                              },
                              "end": {
                                "row": 29,
                                "column": 28
                              },
                              "text": ","
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 29
                              },
                              "end": {
                                "row": 29,
                                "column": 34
                              },
                              "text": "row_2"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 29,
                                "column": 34
                              },
                              "end": {
                                "row": 29,
                                "column": 35
                              },
                              "text": ","
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 36
                              },
                              "end": {
                                "row": 29,
                                "column": 41
                              },
                              "text": "col_1"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 29,
                                "column": 41
                              },
                              "end": {
                                "row": 29,
                                "column": 42
                              },
                              "text": ","
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 43
                              },
                              "end": {
                                "row": 29,
                                "column": 48
                              },
                              "text": "col_2"
                            }
                          ]
                        },
                        {
                          "type": "=",
                          "start": {
                            "row": 29,
                            "column": 49
                          },
                          "end": {
                            "row": 29,
                            "column": 50
                          },
                          "text": "="
                        },
                        {
                          "type": "call",
                          "start": {
                            "row": 29,
                            "column": 51
                          },
                          "end": {
                            "row": 29,
                            "column": 72
                          },
                          "text": "formula.unpack('Cv5')",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 51
                              },
                              "end": {
                                "row": 29,
                                "column": 58
                              },
                              "text": "formula"
                            },
                            {
                              "type": ".",
                              "start": {
                                "row": 29,
                                "column": 58
                              },
                              "end": {
                                "row": 29,
                                "column": 59
                              },
                              "text": "."
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 29,
                                "column": 59
                              },
                              "end": {
                                "row": 29,
                                "column": 65
                              },
                              "text": "unpack"
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 29,
                                "column": 65
                              },
                              "end": {
                                "row": 29,
                                "column": 72
                              },
                              "text": "('Cv5')",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 29,
                                    "column": 65
                                  },
                                  "end": {
                                    "row": 29,
                                    "column": 66
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "string",
                                  "start": {
                                    "row": 29,
                                    "column": 66
                                  },
                                  "end": {
                                    "row": 29,
                                    "column": 71
                                  },
                                  "text": "'Cv5'",
                                  "children": [
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 29,
                                        "column": 66
                                      },
                                      "end": {
                                        "row": 29,
                                        "column": 67
                                      },
                                      "text": "'"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 29,
                                        "column": 67
                                      },
                                      "end": {
                                        "row": 29,
                                        "column": 70
                                      },
                                      "text": "Cv5"
                                    },
                                    {
                                      "type": "\"",
                                      "start": {
                                        "row": 29,
                                        "column": 70
                                      },
                                      "end": {
                                        "row": 29,
                                        "column": 71
                                      },
                                      "text": "'"
                                    }
                                  ]
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 29,
                                    "column": 71
                                  },
                                  "end": {
                                    "row": 29,
                                    "column": 72
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "comment",
                      "start": {
                        "row": 31,
                        "column": 8
                      },
                      "end": {
                        "row": 31,
                        "column": 55
                      },
                      "text": "# TODO. Remove high bit on relative references."
                    },
                    {
                      "type": "assignment",
                      "start": {
                        "row": 32,
                        "column": 8
                      },
                      "end": {
                        "row": 32,
                        "column": 33
                      },
                      "text": "count = row_2 - row_1 + 1",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 32,
                            "column": 8
                          },
                          "end": {
                            "row": 32,
                            "column": 13
                          },
                          "text": "count"
                        },
                        {
                          "type": "=",
                          "start": {
                            "row": 32,
                            "column": 14
                          },
                          "end": {
                            "row": 32,
                            "column": 15
                          },
                          "text": "="
                        },
                        {
                          "type": "binary",
                          "start": {
                            "row": 32,
                            "column": 16
                          },
                          "end": {
                            "row": 32,
                            "column": 33
                          },
                          "text": "row_2 - row_1 + 1",
                          "children": [
                            {
                              "type": "binary",
                              "start": {
                                "row": 32,
                                "column": 16
                              },
                              "end": {
                                "row": 32,
                                "column": 29
                              },
                              "text": "row_2 - row_1",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 32,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 32,
                                    "column": 21
                                  },
                                  "text": "row_2"
                                },
                                {
                                  "type": "-",
                                  "start": {
                                    "row": 32,
                                    "column": 22
                                  },
                                  "end": {
                                    "row": 32,
                                    "column": 23
                                  },
                                  "text": "-"
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 32,
                                    "column": 24
                                  },
                                  "end": {
                                    "row": 32,
                                    "column": 29
                                  },
                                  "text": "row_1"
                                }
                              ]
                            },
                            {
                              "type": "+",
                              "start": {
                                "row": 32,
                                "column": 30
                              },
                              "end": {
                                "row": 32,
                                "column": 31
                              },
                              "text": "+"
                            },
                            {
                              "type": "integer",
                              "start": {
                                "row": 32,
                                "column": 32
                              },
                              "end": {
                                "row": 32,
                                "column": 33
                              },
                              "text": "1"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "end",
                  "start": {
                    "row": 33,
                    "column": 4
                  },
                  "end": {
                    "row": 33,
                    "column": 7
                  },
                  "text": "end"
                }
              ]
            },
            {
              "type": "array",
              "start": {
                "row": 35,
                "column": 4
              },
              "end": {
                "row": 35,
                "column": 20
              },
              "text": "[formula, count]",
              "children": [
                {
                  "type": "[",
                  "start": {
                    "row": 35,
                    "column": 4
                  },
                  "end": {
                    "row": 35,
                    "column": 5
                  },
                  "text": "["
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 35,
                    "column": 5
                  },
                  "end": {
                    "row": 35,
                    "column": 12
                  },
                  "text": "formula"
                },
                {
                  "type": ",",
                  "start": {
                    "row": 35,
                    "column": 12
                  },
                  "end": {
                    "row": 35,
                    "column": 13
                  },
                  "text": ","
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 35,
                    "column": 14
                  },
                  "end": {
                    "row": 35,
                    "column": 19
                  },
                  "text": "count"
                },
                {
                  "type": "]",
                  "start": {
                    "row": 35,
                    "column": 19
                  },
                  "end": {
                    "row": 35,
                    "column": 20
                  },
                  "text": "]"
                }
              ]
            }
          ]
        },
        {
          "type": "end",
          "start": {
            "row": 36,
            "column": 2
          },
          "end": {
            "row": 36,
            "column": 5
          },
          "text": "end"
        }
      ]
    }
  ]
}