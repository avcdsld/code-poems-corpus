{
  "type": "module",
  "start": {
    "row": 0,
    "column": 0
  },
  "end": {
    "row": 30,
    "column": 26
  },
  "text": "def check_auth_gssapi_keyex(\n        self, username, gss_authenticated=AUTH_FAILED, cc_file=None\n    ):\n        \"\"\"\n        Authenticate the given user to the server if he is a valid krb5\n        principal and GSS-API Key Exchange was performed.\n        If GSS-API Key Exchange was not performed, this authentication method\n        won't be available.\n\n        :param str username: The username of the authenticating client\n        :param int gss_authenticated: The result of the krb5 authentication\n        :param str cc_filename: The krb5 client credentials cache filename\n        :return: ``AUTH_FAILED`` if the user is not authenticated otherwise\n                 ``AUTH_SUCCESSFUL``\n        :rtype: int\n        :note: Kerberos credential delegation is not supported.\n        :see: `.ssh_gss` `.kex_gss`\n        :note: : We are just checking in L{AuthHandler} that the given user is\n                 a valid krb5 principal!\n                 We don't check if the krb5 principal is allowed to log in on\n                 the server, because there is no way to do that in python. So\n                 if you develop your own SSH server with paramiko for a cetain\n                 plattform like Linux, you should call C{krb5_kuserok()} in\n                 your local kerberos library to make sure that the\n                 krb5_principal has an account on the server and is allowed\n                 to log in as a user.\n        :see: http://www.unix.com/man-page/all/3/krb5_kuserok/\n        \"\"\"\n        if gss_authenticated == AUTH_SUCCESSFUL:\n            return AUTH_SUCCESSFUL\n        return AUTH_FAILED",
  "children": [
    {
      "type": "function_definition",
      "start": {
        "row": 0,
        "column": 0
      },
      "end": {
        "row": 30,
        "column": 26
      },
      "text": "def check_auth_gssapi_keyex(\n        self, username, gss_authenticated=AUTH_FAILED, cc_file=None\n    ):\n        \"\"\"\n        Authenticate the given user to the server if he is a valid krb5\n        principal and GSS-API Key Exchange was performed.\n        If GSS-API Key Exchange was not performed, this authentication method\n        won't be available.\n\n        :param str username: The username of the authenticating client\n        :param int gss_authenticated: The result of the krb5 authentication\n        :param str cc_filename: The krb5 client credentials cache filename\n        :return: ``AUTH_FAILED`` if the user is not authenticated otherwise\n                 ``AUTH_SUCCESSFUL``\n        :rtype: int\n        :note: Kerberos credential delegation is not supported.\n        :see: `.ssh_gss` `.kex_gss`\n        :note: : We are just checking in L{AuthHandler} that the given user is\n                 a valid krb5 principal!\n                 We don't check if the krb5 principal is allowed to log in on\n                 the server, because there is no way to do that in python. So\n                 if you develop your own SSH server with paramiko for a cetain\n                 plattform like Linux, you should call C{krb5_kuserok()} in\n                 your local kerberos library to make sure that the\n                 krb5_principal has an account on the server and is allowed\n                 to log in as a user.\n        :see: http://www.unix.com/man-page/all/3/krb5_kuserok/\n        \"\"\"\n        if gss_authenticated == AUTH_SUCCESSFUL:\n            return AUTH_SUCCESSFUL\n        return AUTH_FAILED",
      "children": [
        {
          "type": "def",
          "start": {
            "row": 0,
            "column": 0
          },
          "end": {
            "row": 0,
            "column": 3
          },
          "text": "def"
        },
        {
          "type": "identifier",
          "start": {
            "row": 0,
            "column": 4
          },
          "end": {
            "row": 0,
            "column": 27
          },
          "text": "check_auth_gssapi_keyex"
        },
        {
          "type": "parameters",
          "start": {
            "row": 0,
            "column": 27
          },
          "end": {
            "row": 2,
            "column": 5
          },
          "text": "(\n        self, username, gss_authenticated=AUTH_FAILED, cc_file=None\n    )",
          "children": [
            {
              "type": "(",
              "start": {
                "row": 0,
                "column": 27
              },
              "end": {
                "row": 0,
                "column": 28
              },
              "text": "("
            },
            {
              "type": "identifier",
              "start": {
                "row": 1,
                "column": 8
              },
              "end": {
                "row": 1,
                "column": 12
              },
              "text": "self"
            },
            {
              "type": ",",
              "start": {
                "row": 1,
                "column": 12
              },
              "end": {
                "row": 1,
                "column": 13
              },
              "text": ","
            },
            {
              "type": "identifier",
              "start": {
                "row": 1,
                "column": 14
              },
              "end": {
                "row": 1,
                "column": 22
              },
              "text": "username"
            },
            {
              "type": ",",
              "start": {
                "row": 1,
                "column": 22
              },
              "end": {
                "row": 1,
                "column": 23
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 1,
                "column": 24
              },
              "end": {
                "row": 1,
                "column": 53
              },
              "text": "gss_authenticated=AUTH_FAILED",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 24
                  },
                  "end": {
                    "row": 1,
                    "column": 41
                  },
                  "text": "gss_authenticated"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 1,
                    "column": 41
                  },
                  "end": {
                    "row": 1,
                    "column": 42
                  },
                  "text": "="
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 42
                  },
                  "end": {
                    "row": 1,
                    "column": 53
                  },
                  "text": "AUTH_FAILED"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 1,
                "column": 53
              },
              "end": {
                "row": 1,
                "column": 54
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 1,
                "column": 55
              },
              "end": {
                "row": 1,
                "column": 67
              },
              "text": "cc_file=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 55
                  },
                  "end": {
                    "row": 1,
                    "column": 62
                  },
                  "text": "cc_file"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 1,
                    "column": 62
                  },
                  "end": {
                    "row": 1,
                    "column": 63
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 1,
                    "column": 63
                  },
                  "end": {
                    "row": 1,
                    "column": 67
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ")",
              "start": {
                "row": 2,
                "column": 4
              },
              "end": {
                "row": 2,
                "column": 5
              },
              "text": ")"
            }
          ]
        },
        {
          "type": ":",
          "start": {
            "row": 2,
            "column": 5
          },
          "end": {
            "row": 2,
            "column": 6
          },
          "text": ":"
        },
        {
          "type": "block",
          "start": {
            "row": 3,
            "column": 8
          },
          "end": {
            "row": 30,
            "column": 26
          },
          "text": "\"\"\"\n        Authenticate the given user to the server if he is a valid krb5\n        principal and GSS-API Key Exchange was performed.\n        If GSS-API Key Exchange was not performed, this authentication method\n        won't be available.\n\n        :param str username: The username of the authenticating client\n        :param int gss_authenticated: The result of the krb5 authentication\n        :param str cc_filename: The krb5 client credentials cache filename\n        :return: ``AUTH_FAILED`` if the user is not authenticated otherwise\n                 ``AUTH_SUCCESSFUL``\n        :rtype: int\n        :note: Kerberos credential delegation is not supported.\n        :see: `.ssh_gss` `.kex_gss`\n        :note: : We are just checking in L{AuthHandler} that the given user is\n                 a valid krb5 principal!\n                 We don't check if the krb5 principal is allowed to log in on\n                 the server, because there is no way to do that in python. So\n                 if you develop your own SSH server with paramiko for a cetain\n                 plattform like Linux, you should call C{krb5_kuserok()} in\n                 your local kerberos library to make sure that the\n                 krb5_principal has an account on the server and is allowed\n                 to log in as a user.\n        :see: http://www.unix.com/man-page/all/3/krb5_kuserok/\n        \"\"\"\n        if gss_authenticated == AUTH_SUCCESSFUL:\n            return AUTH_SUCCESSFUL\n        return AUTH_FAILED",
          "children": [
            {
              "type": "expression_statement",
              "start": {
                "row": 3,
                "column": 8
              },
              "end": {
                "row": 27,
                "column": 11
              },
              "text": "\"\"\"\n        Authenticate the given user to the server if he is a valid krb5\n        principal and GSS-API Key Exchange was performed.\n        If GSS-API Key Exchange was not performed, this authentication method\n        won't be available.\n\n        :param str username: The username of the authenticating client\n        :param int gss_authenticated: The result of the krb5 authentication\n        :param str cc_filename: The krb5 client credentials cache filename\n        :return: ``AUTH_FAILED`` if the user is not authenticated otherwise\n                 ``AUTH_SUCCESSFUL``\n        :rtype: int\n        :note: Kerberos credential delegation is not supported.\n        :see: `.ssh_gss` `.kex_gss`\n        :note: : We are just checking in L{AuthHandler} that the given user is\n                 a valid krb5 principal!\n                 We don't check if the krb5 principal is allowed to log in on\n                 the server, because there is no way to do that in python. So\n                 if you develop your own SSH server with paramiko for a cetain\n                 plattform like Linux, you should call C{krb5_kuserok()} in\n                 your local kerberos library to make sure that the\n                 krb5_principal has an account on the server and is allowed\n                 to log in as a user.\n        :see: http://www.unix.com/man-page/all/3/krb5_kuserok/\n        \"\"\"",
              "children": [
                {
                  "type": "string",
                  "start": {
                    "row": 3,
                    "column": 8
                  },
                  "end": {
                    "row": 27,
                    "column": 11
                  },
                  "text": "\"\"\"\n        Authenticate the given user to the server if he is a valid krb5\n        principal and GSS-API Key Exchange was performed.\n        If GSS-API Key Exchange was not performed, this authentication method\n        won't be available.\n\n        :param str username: The username of the authenticating client\n        :param int gss_authenticated: The result of the krb5 authentication\n        :param str cc_filename: The krb5 client credentials cache filename\n        :return: ``AUTH_FAILED`` if the user is not authenticated otherwise\n                 ``AUTH_SUCCESSFUL``\n        :rtype: int\n        :note: Kerberos credential delegation is not supported.\n        :see: `.ssh_gss` `.kex_gss`\n        :note: : We are just checking in L{AuthHandler} that the given user is\n                 a valid krb5 principal!\n                 We don't check if the krb5 principal is allowed to log in on\n                 the server, because there is no way to do that in python. So\n                 if you develop your own SSH server with paramiko for a cetain\n                 plattform like Linux, you should call C{krb5_kuserok()} in\n                 your local kerberos library to make sure that the\n                 krb5_principal has an account on the server and is allowed\n                 to log in as a user.\n        :see: http://www.unix.com/man-page/all/3/krb5_kuserok/\n        \"\"\"",
                  "children": [
                    {
                      "type": "string_start",
                      "start": {
                        "row": 3,
                        "column": 8
                      },
                      "end": {
                        "row": 3,
                        "column": 11
                      },
                      "text": "\"\"\""
                    },
                    {
                      "type": "string_content",
                      "start": {
                        "row": 3,
                        "column": 11
                      },
                      "end": {
                        "row": 27,
                        "column": 8
                      },
                      "text": "\n        Authenticate the given user to the server if he is a valid krb5\n        principal and GSS-API Key Exchange was performed.\n        If GSS-API Key Exchange was not performed, this authentication method\n        won't be available.\n\n        :param str username: The username of the authenticating client\n        :param int gss_authenticated: The result of the krb5 authentication\n        :param str cc_filename: The krb5 client credentials cache filename\n        :return: ``AUTH_FAILED`` if the user is not authenticated otherwise\n                 ``AUTH_SUCCESSFUL``\n        :rtype: int\n        :note: Kerberos credential delegation is not supported.\n        :see: `.ssh_gss` `.kex_gss`\n        :note: : We are just checking in L{AuthHandler} that the given user is\n                 a valid krb5 principal!\n                 We don't check if the krb5 principal is allowed to log in on\n                 the server, because there is no way to do that in python. So\n                 if you develop your own SSH server with paramiko for a cetain\n                 plattform like Linux, you should call C{krb5_kuserok()} in\n                 your local kerberos library to make sure that the\n                 krb5_principal has an account on the server and is allowed\n                 to log in as a user.\n        :see: http://www.unix.com/man-page/all/3/krb5_kuserok/\n        "
                    },
                    {
                      "type": "string_end",
                      "start": {
                        "row": 27,
                        "column": 8
                      },
                      "end": {
                        "row": 27,
                        "column": 11
                      },
                      "text": "\"\"\""
                    }
                  ]
                }
              ]
            },
            {
              "type": "if_statement",
              "start": {
                "row": 28,
                "column": 8
              },
              "end": {
                "row": 29,
                "column": 34
              },
              "text": "if gss_authenticated == AUTH_SUCCESSFUL:\n            return AUTH_SUCCESSFUL",
              "children": [
                {
                  "type": "if",
                  "start": {
                    "row": 28,
                    "column": 8
                  },
                  "end": {
                    "row": 28,
                    "column": 10
                  },
                  "text": "if"
                },
                {
                  "type": "comparison_operator",
                  "start": {
                    "row": 28,
                    "column": 11
                  },
                  "end": {
                    "row": 28,
                    "column": 47
                  },
                  "text": "gss_authenticated == AUTH_SUCCESSFUL",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 28,
                        "column": 11
                      },
                      "end": {
                        "row": 28,
                        "column": 28
                      },
                      "text": "gss_authenticated"
                    },
                    {
                      "type": "==",
                      "start": {
                        "row": 28,
                        "column": 29
                      },
                      "end": {
                        "row": 28,
                        "column": 31
                      },
                      "text": "=="
                    },
                    {
                      "type": "identifier",
                      "start": {
                        "row": 28,
                        "column": 32
                      },
                      "end": {
                        "row": 28,
                        "column": 47
                      },
                      "text": "AUTH_SUCCESSFUL"
                    }
                  ]
                },
                {
                  "type": ":",
                  "start": {
                    "row": 28,
                    "column": 47
                  },
                  "end": {
                    "row": 28,
                    "column": 48
                  },
                  "text": ":"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 29,
                    "column": 12
                  },
                  "end": {
                    "row": 29,
                    "column": 34
                  },
                  "text": "return AUTH_SUCCESSFUL",
                  "children": [
                    {
                      "type": "return_statement",
                      "start": {
                        "row": 29,
                        "column": 12
                      },
                      "end": {
                        "row": 29,
                        "column": 34
                      },
                      "text": "return AUTH_SUCCESSFUL",
                      "children": [
                        {
                          "type": "return",
                          "start": {
                            "row": 29,
                            "column": 12
                          },
                          "end": {
                            "row": 29,
                            "column": 18
                          },
                          "text": "return"
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 29,
                            "column": 19
                          },
                          "end": {
                            "row": 29,
                            "column": 34
                          },
                          "text": "AUTH_SUCCESSFUL"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "return_statement",
              "start": {
                "row": 30,
                "column": 8
              },
              "end": {
                "row": 30,
                "column": 26
              },
              "text": "return AUTH_FAILED",
              "children": [
                {
                  "type": "return",
                  "start": {
                    "row": 30,
                    "column": 8
                  },
                  "end": {
                    "row": 30,
                    "column": 14
                  },
                  "text": "return"
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 30,
                    "column": 15
                  },
                  "end": {
                    "row": 30,
                    "column": 26
                  },
                  "text": "AUTH_FAILED"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}