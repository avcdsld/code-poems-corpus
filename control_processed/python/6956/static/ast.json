{
  "type": "module",
  "start": {
    "row": 0,
    "column": 0
  },
  "end": {
    "row": 157,
    "column": 84
  },
  "text": "def fit(self, train_data, eval_data=None, eval_metric='acc',\n            epoch_end_callback=None, batch_end_callback=None, kvstore='local',\n            optimizer='sgd', optimizer_params=(('learning_rate', 0.01),),\n            eval_end_callback=None,\n            eval_batch_end_callback=None, initializer=mx.init.Uniform(0.01),\n            arg_params=None, aux_params=None, allow_missing=False,\n            force_rebind=False, force_init=False, begin_epoch=0, num_epoch=None,\n            validation_metric=None, monitor=None, sparse_row_id_fn=None):\n        \"\"\"Trains the module parameters.\n\n        Parameters\n        ----------\n        train_data : DataIter\n            Train DataIter.\n        eval_data : DataIter\n            If not ``None``, will be used as validation set and the performance\n            after each epoch will be evaluated.\n        eval_metric : str or EvalMetric\n            Defaults to 'accuracy'. The performance measure used to display during training.\n            Other possible predefined metrics are:\n            'ce' (CrossEntropy), 'f1', 'mae', 'mse', 'rmse', 'top_k_accuracy'.\n        epoch_end_callback : function or list of functions\n            Each callback will be called with the current `epoch`, `symbol`, `arg_params`\n            and `aux_params`.\n        batch_end_callback : function or list of function\n            Each callback will be called with a `BatchEndParam`.\n        kvstore : str or KVStore\n            Defaults to 'local'.\n        optimizer : str or Optimizer\n            Defaults to 'sgd'.\n        optimizer_params : dict\n            Defaults to ``(('learning_rate', 0.01),)``. The parameters for\n            the optimizer constructor.\n            The default value is not a dict, just to avoid pylint warning on dangerous\n            default values.\n        eval_end_callback : function or list of function\n            These will be called at the end of each full evaluation, with the metrics over\n            the entire evaluation set.\n        eval_batch_end_callback : function or list of function\n            These will be called at the end of each mini-batch during evaluation.\n        initializer : Initializer\n            The initializer is called to initialize the module parameters when they are\n            not already initialized.\n        arg_params : dict\n            Defaults to ``None``, if not ``None``, should be existing parameters from a trained\n            model or loaded from a checkpoint (previously saved model). In this case,\n            the value here will be used to initialize the module parameters, unless they\n            are already initialized by the user via a call to `init_params` or `fit`.\n            `arg_params` has a higher priority than `initializer`.\n        aux_params : dict\n            Defaults to ``None``. Similar to `arg_params`, except for auxiliary states.\n        allow_missing : bool\n            Defaults to ``False``. Indicates whether to allow missing parameters when `arg_params`\n            and `aux_params` are not ``None``. If this is ``True``, then the missing parameters\n            will be initialized via the `initializer`.\n        force_rebind : bool\n            Defaults to ``False``. Whether to force rebinding the executors if already bound.\n        force_init : bool\n            Defaults to ``False``. Indicates whether to force initialization even if the\n            parameters are already initialized.\n        begin_epoch : int\n            Defaults to 0. Indicates the starting epoch. Usually, if resumed from a\n            checkpoint saved at a previous training phase at epoch N, then this value should be\n            N+1.\n        num_epoch : int\n            Number of epochs for training.\n        sparse_row_id_fn : A callback function\n            The function  takes `data_batch` as an input and returns a dict of\n            str -> NDArray. The resulting dict is used for pulling row_sparse\n            parameters from the kvstore, where the str key is the name of the param,\n            and the value is the row id of the param to pull.\n        validation_metric: str or EvalMetric\n            The performance measure used to display during validation.\n        \"\"\"\n        assert num_epoch is not None, 'please specify number of epochs'\n\n        self.bind(data_shapes=train_data.provide_data, label_shapes=train_data.provide_label,\n                  for_training=True, force_rebind=force_rebind)\n        if monitor is not None:\n            self.install_monitor(monitor)\n        self.init_params(initializer=initializer, arg_params=arg_params, aux_params=aux_params,\n                         allow_missing=allow_missing, force_init=force_init)\n        self.init_optimizer(kvstore=kvstore, optimizer=optimizer, optimizer_params=optimizer_params)\n\n        if validation_metric is None:\n            validation_metric = eval_metric\n        if not isinstance(eval_metric, mx.metric.EvalMetric):\n            eval_metric = mx.metric.create(eval_metric)\n\n        ################################################################################\n        # training loop\n        ################################################################################\n        for epoch in range(begin_epoch, num_epoch):\n            eval_metric.reset()\n            tic = time.time()\n            if epoch % self.update_freq == 0:\n                self.update_full_grads(train_data)\n\n            train_data.reset()\n            data_iter = iter(train_data)\n            end_of_batch = False\n            nbatch = 0\n            next_data_batch = next(data_iter)\n\n            while not end_of_batch:\n                data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1\n            for name, val in eval_name_vals:\n                self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)\n            toc = time.time()\n            self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))\n\n            # sync aux params across devices\n            arg_params, aux_params = self.get_params()\n            self.set_params(arg_params, aux_params)\n\n            if epoch_end_callback is not None:\n                for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)\n\n            # ----------------------------------------\n            # evaluation on validation set\n            if eval_data:\n                res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
  "children": [
    {
      "type": "function_definition",
      "start": {
        "row": 0,
        "column": 0
      },
      "end": {
        "row": 157,
        "column": 84
      },
      "text": "def fit(self, train_data, eval_data=None, eval_metric='acc',\n            epoch_end_callback=None, batch_end_callback=None, kvstore='local',\n            optimizer='sgd', optimizer_params=(('learning_rate', 0.01),),\n            eval_end_callback=None,\n            eval_batch_end_callback=None, initializer=mx.init.Uniform(0.01),\n            arg_params=None, aux_params=None, allow_missing=False,\n            force_rebind=False, force_init=False, begin_epoch=0, num_epoch=None,\n            validation_metric=None, monitor=None, sparse_row_id_fn=None):\n        \"\"\"Trains the module parameters.\n\n        Parameters\n        ----------\n        train_data : DataIter\n            Train DataIter.\n        eval_data : DataIter\n            If not ``None``, will be used as validation set and the performance\n            after each epoch will be evaluated.\n        eval_metric : str or EvalMetric\n            Defaults to 'accuracy'. The performance measure used to display during training.\n            Other possible predefined metrics are:\n            'ce' (CrossEntropy), 'f1', 'mae', 'mse', 'rmse', 'top_k_accuracy'.\n        epoch_end_callback : function or list of functions\n            Each callback will be called with the current `epoch`, `symbol`, `arg_params`\n            and `aux_params`.\n        batch_end_callback : function or list of function\n            Each callback will be called with a `BatchEndParam`.\n        kvstore : str or KVStore\n            Defaults to 'local'.\n        optimizer : str or Optimizer\n            Defaults to 'sgd'.\n        optimizer_params : dict\n            Defaults to ``(('learning_rate', 0.01),)``. The parameters for\n            the optimizer constructor.\n            The default value is not a dict, just to avoid pylint warning on dangerous\n            default values.\n        eval_end_callback : function or list of function\n            These will be called at the end of each full evaluation, with the metrics over\n            the entire evaluation set.\n        eval_batch_end_callback : function or list of function\n            These will be called at the end of each mini-batch during evaluation.\n        initializer : Initializer\n            The initializer is called to initialize the module parameters when they are\n            not already initialized.\n        arg_params : dict\n            Defaults to ``None``, if not ``None``, should be existing parameters from a trained\n            model or loaded from a checkpoint (previously saved model). In this case,\n            the value here will be used to initialize the module parameters, unless they\n            are already initialized by the user via a call to `init_params` or `fit`.\n            `arg_params` has a higher priority than `initializer`.\n        aux_params : dict\n            Defaults to ``None``. Similar to `arg_params`, except for auxiliary states.\n        allow_missing : bool\n            Defaults to ``False``. Indicates whether to allow missing parameters when `arg_params`\n            and `aux_params` are not ``None``. If this is ``True``, then the missing parameters\n            will be initialized via the `initializer`.\n        force_rebind : bool\n            Defaults to ``False``. Whether to force rebinding the executors if already bound.\n        force_init : bool\n            Defaults to ``False``. Indicates whether to force initialization even if the\n            parameters are already initialized.\n        begin_epoch : int\n            Defaults to 0. Indicates the starting epoch. Usually, if resumed from a\n            checkpoint saved at a previous training phase at epoch N, then this value should be\n            N+1.\n        num_epoch : int\n            Number of epochs for training.\n        sparse_row_id_fn : A callback function\n            The function  takes `data_batch` as an input and returns a dict of\n            str -> NDArray. The resulting dict is used for pulling row_sparse\n            parameters from the kvstore, where the str key is the name of the param,\n            and the value is the row id of the param to pull.\n        validation_metric: str or EvalMetric\n            The performance measure used to display during validation.\n        \"\"\"\n        assert num_epoch is not None, 'please specify number of epochs'\n\n        self.bind(data_shapes=train_data.provide_data, label_shapes=train_data.provide_label,\n                  for_training=True, force_rebind=force_rebind)\n        if monitor is not None:\n            self.install_monitor(monitor)\n        self.init_params(initializer=initializer, arg_params=arg_params, aux_params=aux_params,\n                         allow_missing=allow_missing, force_init=force_init)\n        self.init_optimizer(kvstore=kvstore, optimizer=optimizer, optimizer_params=optimizer_params)\n\n        if validation_metric is None:\n            validation_metric = eval_metric\n        if not isinstance(eval_metric, mx.metric.EvalMetric):\n            eval_metric = mx.metric.create(eval_metric)\n\n        ################################################################################\n        # training loop\n        ################################################################################\n        for epoch in range(begin_epoch, num_epoch):\n            eval_metric.reset()\n            tic = time.time()\n            if epoch % self.update_freq == 0:\n                self.update_full_grads(train_data)\n\n            train_data.reset()\n            data_iter = iter(train_data)\n            end_of_batch = False\n            nbatch = 0\n            next_data_batch = next(data_iter)\n\n            while not end_of_batch:\n                data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1\n            for name, val in eval_name_vals:\n                self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)\n            toc = time.time()\n            self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))\n\n            # sync aux params across devices\n            arg_params, aux_params = self.get_params()\n            self.set_params(arg_params, aux_params)\n\n            if epoch_end_callback is not None:\n                for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)\n\n            # ----------------------------------------\n            # evaluation on validation set\n            if eval_data:\n                res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
      "children": [
        {
          "type": "def",
          "start": {
            "row": 0,
            "column": 0
          },
          "end": {
            "row": 0,
            "column": 3
          },
          "text": "def"
        },
        {
          "type": "identifier",
          "start": {
            "row": 0,
            "column": 4
          },
          "end": {
            "row": 0,
            "column": 7
          },
          "text": "fit"
        },
        {
          "type": "parameters",
          "start": {
            "row": 0,
            "column": 7
          },
          "end": {
            "row": 7,
            "column": 72
          },
          "text": "(self, train_data, eval_data=None, eval_metric='acc',\n            epoch_end_callback=None, batch_end_callback=None, kvstore='local',\n            optimizer='sgd', optimizer_params=(('learning_rate', 0.01),),\n            eval_end_callback=None,\n            eval_batch_end_callback=None, initializer=mx.init.Uniform(0.01),\n            arg_params=None, aux_params=None, allow_missing=False,\n            force_rebind=False, force_init=False, begin_epoch=0, num_epoch=None,\n            validation_metric=None, monitor=None, sparse_row_id_fn=None)",
          "children": [
            {
              "type": "(",
              "start": {
                "row": 0,
                "column": 7
              },
              "end": {
                "row": 0,
                "column": 8
              },
              "text": "("
            },
            {
              "type": "identifier",
              "start": {
                "row": 0,
                "column": 8
              },
              "end": {
                "row": 0,
                "column": 12
              },
              "text": "self"
            },
            {
              "type": ",",
              "start": {
                "row": 0,
                "column": 12
              },
              "end": {
                "row": 0,
                "column": 13
              },
              "text": ","
            },
            {
              "type": "identifier",
              "start": {
                "row": 0,
                "column": 14
              },
              "end": {
                "row": 0,
                "column": 24
              },
              "text": "train_data"
            },
            {
              "type": ",",
              "start": {
                "row": 0,
                "column": 24
              },
              "end": {
                "row": 0,
                "column": 25
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 0,
                "column": 26
              },
              "end": {
                "row": 0,
                "column": 40
              },
              "text": "eval_data=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 0,
                    "column": 26
                  },
                  "end": {
                    "row": 0,
                    "column": 35
                  },
                  "text": "eval_data"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 0,
                    "column": 35
                  },
                  "end": {
                    "row": 0,
                    "column": 36
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 0,
                    "column": 36
                  },
                  "end": {
                    "row": 0,
                    "column": 40
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 0,
                "column": 40
              },
              "end": {
                "row": 0,
                "column": 41
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 0,
                "column": 42
              },
              "end": {
                "row": 0,
                "column": 59
              },
              "text": "eval_metric='acc'",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 0,
                    "column": 42
                  },
                  "end": {
                    "row": 0,
                    "column": 53
                  },
                  "text": "eval_metric"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 0,
                    "column": 53
                  },
                  "end": {
                    "row": 0,
                    "column": 54
                  },
                  "text": "="
                },
                {
                  "type": "string",
                  "start": {
                    "row": 0,
                    "column": 54
                  },
                  "end": {
                    "row": 0,
                    "column": 59
                  },
                  "text": "'acc'",
                  "children": [
                    {
                      "type": "string_start",
                      "start": {
                        "row": 0,
                        "column": 54
                      },
                      "end": {
                        "row": 0,
                        "column": 55
                      },
                      "text": "'"
                    },
                    {
                      "type": "string_content",
                      "start": {
                        "row": 0,
                        "column": 55
                      },
                      "end": {
                        "row": 0,
                        "column": 58
                      },
                      "text": "acc"
                    },
                    {
                      "type": "string_end",
                      "start": {
                        "row": 0,
                        "column": 58
                      },
                      "end": {
                        "row": 0,
                        "column": 59
                      },
                      "text": "'"
                    }
                  ]
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 0,
                "column": 59
              },
              "end": {
                "row": 0,
                "column": 60
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 1,
                "column": 12
              },
              "end": {
                "row": 1,
                "column": 35
              },
              "text": "epoch_end_callback=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 12
                  },
                  "end": {
                    "row": 1,
                    "column": 30
                  },
                  "text": "epoch_end_callback"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 1,
                    "column": 30
                  },
                  "end": {
                    "row": 1,
                    "column": 31
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 1,
                    "column": 31
                  },
                  "end": {
                    "row": 1,
                    "column": 35
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 1,
                "column": 35
              },
              "end": {
                "row": 1,
                "column": 36
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 1,
                "column": 37
              },
              "end": {
                "row": 1,
                "column": 60
              },
              "text": "batch_end_callback=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 37
                  },
                  "end": {
                    "row": 1,
                    "column": 55
                  },
                  "text": "batch_end_callback"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 1,
                    "column": 55
                  },
                  "end": {
                    "row": 1,
                    "column": 56
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 1,
                    "column": 56
                  },
                  "end": {
                    "row": 1,
                    "column": 60
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 1,
                "column": 60
              },
              "end": {
                "row": 1,
                "column": 61
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 1,
                "column": 62
              },
              "end": {
                "row": 1,
                "column": 77
              },
              "text": "kvstore='local'",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 1,
                    "column": 62
                  },
                  "end": {
                    "row": 1,
                    "column": 69
                  },
                  "text": "kvstore"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 1,
                    "column": 69
                  },
                  "end": {
                    "row": 1,
                    "column": 70
                  },
                  "text": "="
                },
                {
                  "type": "string",
                  "start": {
                    "row": 1,
                    "column": 70
                  },
                  "end": {
                    "row": 1,
                    "column": 77
                  },
                  "text": "'local'",
                  "children": [
                    {
                      "type": "string_start",
                      "start": {
                        "row": 1,
                        "column": 70
                      },
                      "end": {
                        "row": 1,
                        "column": 71
                      },
                      "text": "'"
                    },
                    {
                      "type": "string_content",
                      "start": {
                        "row": 1,
                        "column": 71
                      },
                      "end": {
                        "row": 1,
                        "column": 76
                      },
                      "text": "local"
                    },
                    {
                      "type": "string_end",
                      "start": {
                        "row": 1,
                        "column": 76
                      },
                      "end": {
                        "row": 1,
                        "column": 77
                      },
                      "text": "'"
                    }
                  ]
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 1,
                "column": 77
              },
              "end": {
                "row": 1,
                "column": 78
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 2,
                "column": 12
              },
              "end": {
                "row": 2,
                "column": 27
              },
              "text": "optimizer='sgd'",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 2,
                    "column": 12
                  },
                  "end": {
                    "row": 2,
                    "column": 21
                  },
                  "text": "optimizer"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 2,
                    "column": 21
                  },
                  "end": {
                    "row": 2,
                    "column": 22
                  },
                  "text": "="
                },
                {
                  "type": "string",
                  "start": {
                    "row": 2,
                    "column": 22
                  },
                  "end": {
                    "row": 2,
                    "column": 27
                  },
                  "text": "'sgd'",
                  "children": [
                    {
                      "type": "string_start",
                      "start": {
                        "row": 2,
                        "column": 22
                      },
                      "end": {
                        "row": 2,
                        "column": 23
                      },
                      "text": "'"
                    },
                    {
                      "type": "string_content",
                      "start": {
                        "row": 2,
                        "column": 23
                      },
                      "end": {
                        "row": 2,
                        "column": 26
                      },
                      "text": "sgd"
                    },
                    {
                      "type": "string_end",
                      "start": {
                        "row": 2,
                        "column": 26
                      },
                      "end": {
                        "row": 2,
                        "column": 27
                      },
                      "text": "'"
                    }
                  ]
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 2,
                "column": 27
              },
              "end": {
                "row": 2,
                "column": 28
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 2,
                "column": 29
              },
              "end": {
                "row": 2,
                "column": 72
              },
              "text": "optimizer_params=(('learning_rate', 0.01),)",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 2,
                    "column": 29
                  },
                  "end": {
                    "row": 2,
                    "column": 45
                  },
                  "text": "optimizer_params"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 2,
                    "column": 45
                  },
                  "end": {
                    "row": 2,
                    "column": 46
                  },
                  "text": "="
                },
                {
                  "type": "tuple",
                  "start": {
                    "row": 2,
                    "column": 46
                  },
                  "end": {
                    "row": 2,
                    "column": 72
                  },
                  "text": "(('learning_rate', 0.01),)",
                  "children": [
                    {
                      "type": "(",
                      "start": {
                        "row": 2,
                        "column": 46
                      },
                      "end": {
                        "row": 2,
                        "column": 47
                      },
                      "text": "("
                    },
                    {
                      "type": "tuple",
                      "start": {
                        "row": 2,
                        "column": 47
                      },
                      "end": {
                        "row": 2,
                        "column": 70
                      },
                      "text": "('learning_rate', 0.01)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 2,
                            "column": 47
                          },
                          "end": {
                            "row": 2,
                            "column": 48
                          },
                          "text": "("
                        },
                        {
                          "type": "string",
                          "start": {
                            "row": 2,
                            "column": 48
                          },
                          "end": {
                            "row": 2,
                            "column": 63
                          },
                          "text": "'learning_rate'",
                          "children": [
                            {
                              "type": "string_start",
                              "start": {
                                "row": 2,
                                "column": 48
                              },
                              "end": {
                                "row": 2,
                                "column": 49
                              },
                              "text": "'"
                            },
                            {
                              "type": "string_content",
                              "start": {
                                "row": 2,
                                "column": 49
                              },
                              "end": {
                                "row": 2,
                                "column": 62
                              },
                              "text": "learning_rate"
                            },
                            {
                              "type": "string_end",
                              "start": {
                                "row": 2,
                                "column": 62
                              },
                              "end": {
                                "row": 2,
                                "column": 63
                              },
                              "text": "'"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 2,
                            "column": 63
                          },
                          "end": {
                            "row": 2,
                            "column": 64
                          },
                          "text": ","
                        },
                        {
                          "type": "float",
                          "start": {
                            "row": 2,
                            "column": 65
                          },
                          "end": {
                            "row": 2,
                            "column": 69
                          },
                          "text": "0.01"
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 2,
                            "column": 69
                          },
                          "end": {
                            "row": 2,
                            "column": 70
                          },
                          "text": ")"
                        }
                      ]
                    },
                    {
                      "type": ",",
                      "start": {
                        "row": 2,
                        "column": 70
                      },
                      "end": {
                        "row": 2,
                        "column": 71
                      },
                      "text": ","
                    },
                    {
                      "type": ")",
                      "start": {
                        "row": 2,
                        "column": 71
                      },
                      "end": {
                        "row": 2,
                        "column": 72
                      },
                      "text": ")"
                    }
                  ]
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 2,
                "column": 72
              },
              "end": {
                "row": 2,
                "column": 73
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 3,
                "column": 12
              },
              "end": {
                "row": 3,
                "column": 34
              },
              "text": "eval_end_callback=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 3,
                    "column": 12
                  },
                  "end": {
                    "row": 3,
                    "column": 29
                  },
                  "text": "eval_end_callback"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 3,
                    "column": 29
                  },
                  "end": {
                    "row": 3,
                    "column": 30
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 3,
                    "column": 30
                  },
                  "end": {
                    "row": 3,
                    "column": 34
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 3,
                "column": 34
              },
              "end": {
                "row": 3,
                "column": 35
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 4,
                "column": 12
              },
              "end": {
                "row": 4,
                "column": 40
              },
              "text": "eval_batch_end_callback=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 4,
                    "column": 12
                  },
                  "end": {
                    "row": 4,
                    "column": 35
                  },
                  "text": "eval_batch_end_callback"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 4,
                    "column": 35
                  },
                  "end": {
                    "row": 4,
                    "column": 36
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 4,
                    "column": 36
                  },
                  "end": {
                    "row": 4,
                    "column": 40
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 4,
                "column": 40
              },
              "end": {
                "row": 4,
                "column": 41
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 4,
                "column": 42
              },
              "end": {
                "row": 4,
                "column": 75
              },
              "text": "initializer=mx.init.Uniform(0.01)",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 4,
                    "column": 42
                  },
                  "end": {
                    "row": 4,
                    "column": 53
                  },
                  "text": "initializer"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 4,
                    "column": 53
                  },
                  "end": {
                    "row": 4,
                    "column": 54
                  },
                  "text": "="
                },
                {
                  "type": "call",
                  "start": {
                    "row": 4,
                    "column": 54
                  },
                  "end": {
                    "row": 4,
                    "column": 75
                  },
                  "text": "mx.init.Uniform(0.01)",
                  "children": [
                    {
                      "type": "attribute",
                      "start": {
                        "row": 4,
                        "column": 54
                      },
                      "end": {
                        "row": 4,
                        "column": 69
                      },
                      "text": "mx.init.Uniform",
                      "children": [
                        {
                          "type": "attribute",
                          "start": {
                            "row": 4,
                            "column": 54
                          },
                          "end": {
                            "row": 4,
                            "column": 61
                          },
                          "text": "mx.init",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 4,
                                "column": 54
                              },
                              "end": {
                                "row": 4,
                                "column": 56
                              },
                              "text": "mx"
                            },
                            {
                              "type": ".",
                              "start": {
                                "row": 4,
                                "column": 56
                              },
                              "end": {
                                "row": 4,
                                "column": 57
                              },
                              "text": "."
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 4,
                                "column": 57
                              },
                              "end": {
                                "row": 4,
                                "column": 61
                              },
                              "text": "init"
                            }
                          ]
                        },
                        {
                          "type": ".",
                          "start": {
                            "row": 4,
                            "column": 61
                          },
                          "end": {
                            "row": 4,
                            "column": 62
                          },
                          "text": "."
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 4,
                            "column": 62
                          },
                          "end": {
                            "row": 4,
                            "column": 69
                          },
                          "text": "Uniform"
                        }
                      ]
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 4,
                        "column": 69
                      },
                      "end": {
                        "row": 4,
                        "column": 75
                      },
                      "text": "(0.01)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 4,
                            "column": 69
                          },
                          "end": {
                            "row": 4,
                            "column": 70
                          },
                          "text": "("
                        },
                        {
                          "type": "float",
                          "start": {
                            "row": 4,
                            "column": 70
                          },
                          "end": {
                            "row": 4,
                            "column": 74
                          },
                          "text": "0.01"
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 4,
                            "column": 74
                          },
                          "end": {
                            "row": 4,
                            "column": 75
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 4,
                "column": 75
              },
              "end": {
                "row": 4,
                "column": 76
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 5,
                "column": 12
              },
              "end": {
                "row": 5,
                "column": 27
              },
              "text": "arg_params=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 5,
                    "column": 12
                  },
                  "end": {
                    "row": 5,
                    "column": 22
                  },
                  "text": "arg_params"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 5,
                    "column": 22
                  },
                  "end": {
                    "row": 5,
                    "column": 23
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 5,
                    "column": 23
                  },
                  "end": {
                    "row": 5,
                    "column": 27
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 5,
                "column": 27
              },
              "end": {
                "row": 5,
                "column": 28
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 5,
                "column": 29
              },
              "end": {
                "row": 5,
                "column": 44
              },
              "text": "aux_params=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 5,
                    "column": 29
                  },
                  "end": {
                    "row": 5,
                    "column": 39
                  },
                  "text": "aux_params"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 5,
                    "column": 39
                  },
                  "end": {
                    "row": 5,
                    "column": 40
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 5,
                    "column": 40
                  },
                  "end": {
                    "row": 5,
                    "column": 44
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 5,
                "column": 44
              },
              "end": {
                "row": 5,
                "column": 45
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 5,
                "column": 46
              },
              "end": {
                "row": 5,
                "column": 65
              },
              "text": "allow_missing=False",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 5,
                    "column": 46
                  },
                  "end": {
                    "row": 5,
                    "column": 59
                  },
                  "text": "allow_missing"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 5,
                    "column": 59
                  },
                  "end": {
                    "row": 5,
                    "column": 60
                  },
                  "text": "="
                },
                {
                  "type": "false",
                  "start": {
                    "row": 5,
                    "column": 60
                  },
                  "end": {
                    "row": 5,
                    "column": 65
                  },
                  "text": "False"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 5,
                "column": 65
              },
              "end": {
                "row": 5,
                "column": 66
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 6,
                "column": 12
              },
              "end": {
                "row": 6,
                "column": 30
              },
              "text": "force_rebind=False",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 6,
                    "column": 12
                  },
                  "end": {
                    "row": 6,
                    "column": 24
                  },
                  "text": "force_rebind"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 6,
                    "column": 24
                  },
                  "end": {
                    "row": 6,
                    "column": 25
                  },
                  "text": "="
                },
                {
                  "type": "false",
                  "start": {
                    "row": 6,
                    "column": 25
                  },
                  "end": {
                    "row": 6,
                    "column": 30
                  },
                  "text": "False"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 6,
                "column": 30
              },
              "end": {
                "row": 6,
                "column": 31
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 6,
                "column": 32
              },
              "end": {
                "row": 6,
                "column": 48
              },
              "text": "force_init=False",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 6,
                    "column": 32
                  },
                  "end": {
                    "row": 6,
                    "column": 42
                  },
                  "text": "force_init"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 6,
                    "column": 42
                  },
                  "end": {
                    "row": 6,
                    "column": 43
                  },
                  "text": "="
                },
                {
                  "type": "false",
                  "start": {
                    "row": 6,
                    "column": 43
                  },
                  "end": {
                    "row": 6,
                    "column": 48
                  },
                  "text": "False"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 6,
                "column": 48
              },
              "end": {
                "row": 6,
                "column": 49
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 6,
                "column": 50
              },
              "end": {
                "row": 6,
                "column": 63
              },
              "text": "begin_epoch=0",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 6,
                    "column": 50
                  },
                  "end": {
                    "row": 6,
                    "column": 61
                  },
                  "text": "begin_epoch"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 6,
                    "column": 61
                  },
                  "end": {
                    "row": 6,
                    "column": 62
                  },
                  "text": "="
                },
                {
                  "type": "integer",
                  "start": {
                    "row": 6,
                    "column": 62
                  },
                  "end": {
                    "row": 6,
                    "column": 63
                  },
                  "text": "0"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 6,
                "column": 63
              },
              "end": {
                "row": 6,
                "column": 64
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 6,
                "column": 65
              },
              "end": {
                "row": 6,
                "column": 79
              },
              "text": "num_epoch=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 6,
                    "column": 65
                  },
                  "end": {
                    "row": 6,
                    "column": 74
                  },
                  "text": "num_epoch"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 6,
                    "column": 74
                  },
                  "end": {
                    "row": 6,
                    "column": 75
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 6,
                    "column": 75
                  },
                  "end": {
                    "row": 6,
                    "column": 79
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 6,
                "column": 79
              },
              "end": {
                "row": 6,
                "column": 80
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 7,
                "column": 12
              },
              "end": {
                "row": 7,
                "column": 34
              },
              "text": "validation_metric=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 7,
                    "column": 12
                  },
                  "end": {
                    "row": 7,
                    "column": 29
                  },
                  "text": "validation_metric"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 7,
                    "column": 29
                  },
                  "end": {
                    "row": 7,
                    "column": 30
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 7,
                    "column": 30
                  },
                  "end": {
                    "row": 7,
                    "column": 34
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 7,
                "column": 34
              },
              "end": {
                "row": 7,
                "column": 35
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 7,
                "column": 36
              },
              "end": {
                "row": 7,
                "column": 48
              },
              "text": "monitor=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 7,
                    "column": 36
                  },
                  "end": {
                    "row": 7,
                    "column": 43
                  },
                  "text": "monitor"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 7,
                    "column": 43
                  },
                  "end": {
                    "row": 7,
                    "column": 44
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 7,
                    "column": 44
                  },
                  "end": {
                    "row": 7,
                    "column": 48
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ",",
              "start": {
                "row": 7,
                "column": 48
              },
              "end": {
                "row": 7,
                "column": 49
              },
              "text": ","
            },
            {
              "type": "default_parameter",
              "start": {
                "row": 7,
                "column": 50
              },
              "end": {
                "row": 7,
                "column": 71
              },
              "text": "sparse_row_id_fn=None",
              "children": [
                {
                  "type": "identifier",
                  "start": {
                    "row": 7,
                    "column": 50
                  },
                  "end": {
                    "row": 7,
                    "column": 66
                  },
                  "text": "sparse_row_id_fn"
                },
                {
                  "type": "=",
                  "start": {
                    "row": 7,
                    "column": 66
                  },
                  "end": {
                    "row": 7,
                    "column": 67
                  },
                  "text": "="
                },
                {
                  "type": "none",
                  "start": {
                    "row": 7,
                    "column": 67
                  },
                  "end": {
                    "row": 7,
                    "column": 71
                  },
                  "text": "None"
                }
              ]
            },
            {
              "type": ")",
              "start": {
                "row": 7,
                "column": 71
              },
              "end": {
                "row": 7,
                "column": 72
              },
              "text": ")"
            }
          ]
        },
        {
          "type": ":",
          "start": {
            "row": 7,
            "column": 72
          },
          "end": {
            "row": 7,
            "column": 73
          },
          "text": ":"
        },
        {
          "type": "block",
          "start": {
            "row": 8,
            "column": 8
          },
          "end": {
            "row": 157,
            "column": 84
          },
          "text": "\"\"\"Trains the module parameters.\n\n        Parameters\n        ----------\n        train_data : DataIter\n            Train DataIter.\n        eval_data : DataIter\n            If not ``None``, will be used as validation set and the performance\n            after each epoch will be evaluated.\n        eval_metric : str or EvalMetric\n            Defaults to 'accuracy'. The performance measure used to display during training.\n            Other possible predefined metrics are:\n            'ce' (CrossEntropy), 'f1', 'mae', 'mse', 'rmse', 'top_k_accuracy'.\n        epoch_end_callback : function or list of functions\n            Each callback will be called with the current `epoch`, `symbol`, `arg_params`\n            and `aux_params`.\n        batch_end_callback : function or list of function\n            Each callback will be called with a `BatchEndParam`.\n        kvstore : str or KVStore\n            Defaults to 'local'.\n        optimizer : str or Optimizer\n            Defaults to 'sgd'.\n        optimizer_params : dict\n            Defaults to ``(('learning_rate', 0.01),)``. The parameters for\n            the optimizer constructor.\n            The default value is not a dict, just to avoid pylint warning on dangerous\n            default values.\n        eval_end_callback : function or list of function\n            These will be called at the end of each full evaluation, with the metrics over\n            the entire evaluation set.\n        eval_batch_end_callback : function or list of function\n            These will be called at the end of each mini-batch during evaluation.\n        initializer : Initializer\n            The initializer is called to initialize the module parameters when they are\n            not already initialized.\n        arg_params : dict\n            Defaults to ``None``, if not ``None``, should be existing parameters from a trained\n            model or loaded from a checkpoint (previously saved model). In this case,\n            the value here will be used to initialize the module parameters, unless they\n            are already initialized by the user via a call to `init_params` or `fit`.\n            `arg_params` has a higher priority than `initializer`.\n        aux_params : dict\n            Defaults to ``None``. Similar to `arg_params`, except for auxiliary states.\n        allow_missing : bool\n            Defaults to ``False``. Indicates whether to allow missing parameters when `arg_params`\n            and `aux_params` are not ``None``. If this is ``True``, then the missing parameters\n            will be initialized via the `initializer`.\n        force_rebind : bool\n            Defaults to ``False``. Whether to force rebinding the executors if already bound.\n        force_init : bool\n            Defaults to ``False``. Indicates whether to force initialization even if the\n            parameters are already initialized.\n        begin_epoch : int\n            Defaults to 0. Indicates the starting epoch. Usually, if resumed from a\n            checkpoint saved at a previous training phase at epoch N, then this value should be\n            N+1.\n        num_epoch : int\n            Number of epochs for training.\n        sparse_row_id_fn : A callback function\n            The function  takes `data_batch` as an input and returns a dict of\n            str -> NDArray. The resulting dict is used for pulling row_sparse\n            parameters from the kvstore, where the str key is the name of the param,\n            and the value is the row id of the param to pull.\n        validation_metric: str or EvalMetric\n            The performance measure used to display during validation.\n        \"\"\"\n        assert num_epoch is not None, 'please specify number of epochs'\n\n        self.bind(data_shapes=train_data.provide_data, label_shapes=train_data.provide_label,\n                  for_training=True, force_rebind=force_rebind)\n        if monitor is not None:\n            self.install_monitor(monitor)\n        self.init_params(initializer=initializer, arg_params=arg_params, aux_params=aux_params,\n                         allow_missing=allow_missing, force_init=force_init)\n        self.init_optimizer(kvstore=kvstore, optimizer=optimizer, optimizer_params=optimizer_params)\n\n        if validation_metric is None:\n            validation_metric = eval_metric\n        if not isinstance(eval_metric, mx.metric.EvalMetric):\n            eval_metric = mx.metric.create(eval_metric)\n\n        ################################################################################\n        # training loop\n        ################################################################################\n        for epoch in range(begin_epoch, num_epoch):\n            eval_metric.reset()\n            tic = time.time()\n            if epoch % self.update_freq == 0:\n                self.update_full_grads(train_data)\n\n            train_data.reset()\n            data_iter = iter(train_data)\n            end_of_batch = False\n            nbatch = 0\n            next_data_batch = next(data_iter)\n\n            while not end_of_batch:\n                data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1\n            for name, val in eval_name_vals:\n                self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)\n            toc = time.time()\n            self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))\n\n            # sync aux params across devices\n            arg_params, aux_params = self.get_params()\n            self.set_params(arg_params, aux_params)\n\n            if epoch_end_callback is not None:\n                for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)\n\n            # ----------------------------------------\n            # evaluation on validation set\n            if eval_data:\n                res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
          "children": [
            {
              "type": "expression_statement",
              "start": {
                "row": 8,
                "column": 8
              },
              "end": {
                "row": 73,
                "column": 11
              },
              "text": "\"\"\"Trains the module parameters.\n\n        Parameters\n        ----------\n        train_data : DataIter\n            Train DataIter.\n        eval_data : DataIter\n            If not ``None``, will be used as validation set and the performance\n            after each epoch will be evaluated.\n        eval_metric : str or EvalMetric\n            Defaults to 'accuracy'. The performance measure used to display during training.\n            Other possible predefined metrics are:\n            'ce' (CrossEntropy), 'f1', 'mae', 'mse', 'rmse', 'top_k_accuracy'.\n        epoch_end_callback : function or list of functions\n            Each callback will be called with the current `epoch`, `symbol`, `arg_params`\n            and `aux_params`.\n        batch_end_callback : function or list of function\n            Each callback will be called with a `BatchEndParam`.\n        kvstore : str or KVStore\n            Defaults to 'local'.\n        optimizer : str or Optimizer\n            Defaults to 'sgd'.\n        optimizer_params : dict\n            Defaults to ``(('learning_rate', 0.01),)``. The parameters for\n            the optimizer constructor.\n            The default value is not a dict, just to avoid pylint warning on dangerous\n            default values.\n        eval_end_callback : function or list of function\n            These will be called at the end of each full evaluation, with the metrics over\n            the entire evaluation set.\n        eval_batch_end_callback : function or list of function\n            These will be called at the end of each mini-batch during evaluation.\n        initializer : Initializer\n            The initializer is called to initialize the module parameters when they are\n            not already initialized.\n        arg_params : dict\n            Defaults to ``None``, if not ``None``, should be existing parameters from a trained\n            model or loaded from a checkpoint (previously saved model). In this case,\n            the value here will be used to initialize the module parameters, unless they\n            are already initialized by the user via a call to `init_params` or `fit`.\n            `arg_params` has a higher priority than `initializer`.\n        aux_params : dict\n            Defaults to ``None``. Similar to `arg_params`, except for auxiliary states.\n        allow_missing : bool\n            Defaults to ``False``. Indicates whether to allow missing parameters when `arg_params`\n            and `aux_params` are not ``None``. If this is ``True``, then the missing parameters\n            will be initialized via the `initializer`.\n        force_rebind : bool\n            Defaults to ``False``. Whether to force rebinding the executors if already bound.\n        force_init : bool\n            Defaults to ``False``. Indicates whether to force initialization even if the\n            parameters are already initialized.\n        begin_epoch : int\n            Defaults to 0. Indicates the starting epoch. Usually, if resumed from a\n            checkpoint saved at a previous training phase at epoch N, then this value should be\n            N+1.\n        num_epoch : int\n            Number of epochs for training.\n        sparse_row_id_fn : A callback function\n            The function  takes `data_batch` as an input and returns a dict of\n            str -> NDArray. The resulting dict is used for pulling row_sparse\n            parameters from the kvstore, where the str key is the name of the param,\n            and the value is the row id of the param to pull.\n        validation_metric: str or EvalMetric\n            The performance measure used to display during validation.\n        \"\"\"",
              "children": [
                {
                  "type": "string",
                  "start": {
                    "row": 8,
                    "column": 8
                  },
                  "end": {
                    "row": 73,
                    "column": 11
                  },
                  "text": "\"\"\"Trains the module parameters.\n\n        Parameters\n        ----------\n        train_data : DataIter\n            Train DataIter.\n        eval_data : DataIter\n            If not ``None``, will be used as validation set and the performance\n            after each epoch will be evaluated.\n        eval_metric : str or EvalMetric\n            Defaults to 'accuracy'. The performance measure used to display during training.\n            Other possible predefined metrics are:\n            'ce' (CrossEntropy), 'f1', 'mae', 'mse', 'rmse', 'top_k_accuracy'.\n        epoch_end_callback : function or list of functions\n            Each callback will be called with the current `epoch`, `symbol`, `arg_params`\n            and `aux_params`.\n        batch_end_callback : function or list of function\n            Each callback will be called with a `BatchEndParam`.\n        kvstore : str or KVStore\n            Defaults to 'local'.\n        optimizer : str or Optimizer\n            Defaults to 'sgd'.\n        optimizer_params : dict\n            Defaults to ``(('learning_rate', 0.01),)``. The parameters for\n            the optimizer constructor.\n            The default value is not a dict, just to avoid pylint warning on dangerous\n            default values.\n        eval_end_callback : function or list of function\n            These will be called at the end of each full evaluation, with the metrics over\n            the entire evaluation set.\n        eval_batch_end_callback : function or list of function\n            These will be called at the end of each mini-batch during evaluation.\n        initializer : Initializer\n            The initializer is called to initialize the module parameters when they are\n            not already initialized.\n        arg_params : dict\n            Defaults to ``None``, if not ``None``, should be existing parameters from a trained\n            model or loaded from a checkpoint (previously saved model). In this case,\n            the value here will be used to initialize the module parameters, unless they\n            are already initialized by the user via a call to `init_params` or `fit`.\n            `arg_params` has a higher priority than `initializer`.\n        aux_params : dict\n            Defaults to ``None``. Similar to `arg_params`, except for auxiliary states.\n        allow_missing : bool\n            Defaults to ``False``. Indicates whether to allow missing parameters when `arg_params`\n            and `aux_params` are not ``None``. If this is ``True``, then the missing parameters\n            will be initialized via the `initializer`.\n        force_rebind : bool\n            Defaults to ``False``. Whether to force rebinding the executors if already bound.\n        force_init : bool\n            Defaults to ``False``. Indicates whether to force initialization even if the\n            parameters are already initialized.\n        begin_epoch : int\n            Defaults to 0. Indicates the starting epoch. Usually, if resumed from a\n            checkpoint saved at a previous training phase at epoch N, then this value should be\n            N+1.\n        num_epoch : int\n            Number of epochs for training.\n        sparse_row_id_fn : A callback function\n            The function  takes `data_batch` as an input and returns a dict of\n            str -> NDArray. The resulting dict is used for pulling row_sparse\n            parameters from the kvstore, where the str key is the name of the param,\n            and the value is the row id of the param to pull.\n        validation_metric: str or EvalMetric\n            The performance measure used to display during validation.\n        \"\"\"",
                  "children": [
                    {
                      "type": "string_start",
                      "start": {
                        "row": 8,
                        "column": 8
                      },
                      "end": {
                        "row": 8,
                        "column": 11
                      },
                      "text": "\"\"\""
                    },
                    {
                      "type": "string_content",
                      "start": {
                        "row": 8,
                        "column": 11
                      },
                      "end": {
                        "row": 73,
                        "column": 8
                      },
                      "text": "Trains the module parameters.\n\n        Parameters\n        ----------\n        train_data : DataIter\n            Train DataIter.\n        eval_data : DataIter\n            If not ``None``, will be used as validation set and the performance\n            after each epoch will be evaluated.\n        eval_metric : str or EvalMetric\n            Defaults to 'accuracy'. The performance measure used to display during training.\n            Other possible predefined metrics are:\n            'ce' (CrossEntropy), 'f1', 'mae', 'mse', 'rmse', 'top_k_accuracy'.\n        epoch_end_callback : function or list of functions\n            Each callback will be called with the current `epoch`, `symbol`, `arg_params`\n            and `aux_params`.\n        batch_end_callback : function or list of function\n            Each callback will be called with a `BatchEndParam`.\n        kvstore : str or KVStore\n            Defaults to 'local'.\n        optimizer : str or Optimizer\n            Defaults to 'sgd'.\n        optimizer_params : dict\n            Defaults to ``(('learning_rate', 0.01),)``. The parameters for\n            the optimizer constructor.\n            The default value is not a dict, just to avoid pylint warning on dangerous\n            default values.\n        eval_end_callback : function or list of function\n            These will be called at the end of each full evaluation, with the metrics over\n            the entire evaluation set.\n        eval_batch_end_callback : function or list of function\n            These will be called at the end of each mini-batch during evaluation.\n        initializer : Initializer\n            The initializer is called to initialize the module parameters when they are\n            not already initialized.\n        arg_params : dict\n            Defaults to ``None``, if not ``None``, should be existing parameters from a trained\n            model or loaded from a checkpoint (previously saved model). In this case,\n            the value here will be used to initialize the module parameters, unless they\n            are already initialized by the user via a call to `init_params` or `fit`.\n            `arg_params` has a higher priority than `initializer`.\n        aux_params : dict\n            Defaults to ``None``. Similar to `arg_params`, except for auxiliary states.\n        allow_missing : bool\n            Defaults to ``False``. Indicates whether to allow missing parameters when `arg_params`\n            and `aux_params` are not ``None``. If this is ``True``, then the missing parameters\n            will be initialized via the `initializer`.\n        force_rebind : bool\n            Defaults to ``False``. Whether to force rebinding the executors if already bound.\n        force_init : bool\n            Defaults to ``False``. Indicates whether to force initialization even if the\n            parameters are already initialized.\n        begin_epoch : int\n            Defaults to 0. Indicates the starting epoch. Usually, if resumed from a\n            checkpoint saved at a previous training phase at epoch N, then this value should be\n            N+1.\n        num_epoch : int\n            Number of epochs for training.\n        sparse_row_id_fn : A callback function\n            The function  takes `data_batch` as an input and returns a dict of\n            str -> NDArray. The resulting dict is used for pulling row_sparse\n            parameters from the kvstore, where the str key is the name of the param,\n            and the value is the row id of the param to pull.\n        validation_metric: str or EvalMetric\n            The performance measure used to display during validation.\n        "
                    },
                    {
                      "type": "string_end",
                      "start": {
                        "row": 73,
                        "column": 8
                      },
                      "end": {
                        "row": 73,
                        "column": 11
                      },
                      "text": "\"\"\""
                    }
                  ]
                }
              ]
            },
            {
              "type": "assert_statement",
              "start": {
                "row": 74,
                "column": 8
              },
              "end": {
                "row": 74,
                "column": 71
              },
              "text": "assert num_epoch is not None, 'please specify number of epochs'",
              "children": [
                {
                  "type": "assert",
                  "start": {
                    "row": 74,
                    "column": 8
                  },
                  "end": {
                    "row": 74,
                    "column": 14
                  },
                  "text": "assert"
                },
                {
                  "type": "comparison_operator",
                  "start": {
                    "row": 74,
                    "column": 15
                  },
                  "end": {
                    "row": 74,
                    "column": 36
                  },
                  "text": "num_epoch is not None",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 74,
                        "column": 15
                      },
                      "end": {
                        "row": 74,
                        "column": 24
                      },
                      "text": "num_epoch"
                    },
                    {
                      "type": "is not",
                      "start": {
                        "row": 74,
                        "column": 25
                      },
                      "end": {
                        "row": 74,
                        "column": 27
                      },
                      "text": "is"
                    },
                    {
                      "type": "is not",
                      "start": {
                        "row": 74,
                        "column": 28
                      },
                      "end": {
                        "row": 74,
                        "column": 31
                      },
                      "text": "not"
                    },
                    {
                      "type": "none",
                      "start": {
                        "row": 74,
                        "column": 32
                      },
                      "end": {
                        "row": 74,
                        "column": 36
                      },
                      "text": "None"
                    }
                  ]
                },
                {
                  "type": ",",
                  "start": {
                    "row": 74,
                    "column": 36
                  },
                  "end": {
                    "row": 74,
                    "column": 37
                  },
                  "text": ","
                },
                {
                  "type": "string",
                  "start": {
                    "row": 74,
                    "column": 38
                  },
                  "end": {
                    "row": 74,
                    "column": 71
                  },
                  "text": "'please specify number of epochs'",
                  "children": [
                    {
                      "type": "string_start",
                      "start": {
                        "row": 74,
                        "column": 38
                      },
                      "end": {
                        "row": 74,
                        "column": 39
                      },
                      "text": "'"
                    },
                    {
                      "type": "string_content",
                      "start": {
                        "row": 74,
                        "column": 39
                      },
                      "end": {
                        "row": 74,
                        "column": 70
                      },
                      "text": "please specify number of epochs"
                    },
                    {
                      "type": "string_end",
                      "start": {
                        "row": 74,
                        "column": 70
                      },
                      "end": {
                        "row": 74,
                        "column": 71
                      },
                      "text": "'"
                    }
                  ]
                }
              ]
            },
            {
              "type": "expression_statement",
              "start": {
                "row": 76,
                "column": 8
              },
              "end": {
                "row": 77,
                "column": 63
              },
              "text": "self.bind(data_shapes=train_data.provide_data, label_shapes=train_data.provide_label,\n                  for_training=True, force_rebind=force_rebind)",
              "children": [
                {
                  "type": "call",
                  "start": {
                    "row": 76,
                    "column": 8
                  },
                  "end": {
                    "row": 77,
                    "column": 63
                  },
                  "text": "self.bind(data_shapes=train_data.provide_data, label_shapes=train_data.provide_label,\n                  for_training=True, force_rebind=force_rebind)",
                  "children": [
                    {
                      "type": "attribute",
                      "start": {
                        "row": 76,
                        "column": 8
                      },
                      "end": {
                        "row": 76,
                        "column": 17
                      },
                      "text": "self.bind",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 76,
                            "column": 8
                          },
                          "end": {
                            "row": 76,
                            "column": 12
                          },
                          "text": "self"
                        },
                        {
                          "type": ".",
                          "start": {
                            "row": 76,
                            "column": 12
                          },
                          "end": {
                            "row": 76,
                            "column": 13
                          },
                          "text": "."
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 76,
                            "column": 13
                          },
                          "end": {
                            "row": 76,
                            "column": 17
                          },
                          "text": "bind"
                        }
                      ]
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 76,
                        "column": 17
                      },
                      "end": {
                        "row": 77,
                        "column": 63
                      },
                      "text": "(data_shapes=train_data.provide_data, label_shapes=train_data.provide_label,\n                  for_training=True, force_rebind=force_rebind)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 76,
                            "column": 17
                          },
                          "end": {
                            "row": 76,
                            "column": 18
                          },
                          "text": "("
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 76,
                            "column": 18
                          },
                          "end": {
                            "row": 76,
                            "column": 53
                          },
                          "text": "data_shapes=train_data.provide_data",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 76,
                                "column": 18
                              },
                              "end": {
                                "row": 76,
                                "column": 29
                              },
                              "text": "data_shapes"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 76,
                                "column": 29
                              },
                              "end": {
                                "row": 76,
                                "column": 30
                              },
                              "text": "="
                            },
                            {
                              "type": "attribute",
                              "start": {
                                "row": 76,
                                "column": 30
                              },
                              "end": {
                                "row": 76,
                                "column": 53
                              },
                              "text": "train_data.provide_data",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 76,
                                    "column": 30
                                  },
                                  "end": {
                                    "row": 76,
                                    "column": 40
                                  },
                                  "text": "train_data"
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 76,
                                    "column": 40
                                  },
                                  "end": {
                                    "row": 76,
                                    "column": 41
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 76,
                                    "column": 41
                                  },
                                  "end": {
                                    "row": 76,
                                    "column": 53
                                  },
                                  "text": "provide_data"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 76,
                            "column": 53
                          },
                          "end": {
                            "row": 76,
                            "column": 54
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 76,
                            "column": 55
                          },
                          "end": {
                            "row": 76,
                            "column": 92
                          },
                          "text": "label_shapes=train_data.provide_label",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 76,
                                "column": 55
                              },
                              "end": {
                                "row": 76,
                                "column": 67
                              },
                              "text": "label_shapes"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 76,
                                "column": 67
                              },
                              "end": {
                                "row": 76,
                                "column": 68
                              },
                              "text": "="
                            },
                            {
                              "type": "attribute",
                              "start": {
                                "row": 76,
                                "column": 68
                              },
                              "end": {
                                "row": 76,
                                "column": 92
                              },
                              "text": "train_data.provide_label",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 76,
                                    "column": 68
                                  },
                                  "end": {
                                    "row": 76,
                                    "column": 78
                                  },
                                  "text": "train_data"
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 76,
                                    "column": 78
                                  },
                                  "end": {
                                    "row": 76,
                                    "column": 79
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 76,
                                    "column": 79
                                  },
                                  "end": {
                                    "row": 76,
                                    "column": 92
                                  },
                                  "text": "provide_label"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 76,
                            "column": 92
                          },
                          "end": {
                            "row": 76,
                            "column": 93
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 77,
                            "column": 18
                          },
                          "end": {
                            "row": 77,
                            "column": 35
                          },
                          "text": "for_training=True",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 77,
                                "column": 18
                              },
                              "end": {
                                "row": 77,
                                "column": 30
                              },
                              "text": "for_training"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 77,
                                "column": 30
                              },
                              "end": {
                                "row": 77,
                                "column": 31
                              },
                              "text": "="
                            },
                            {
                              "type": "true",
                              "start": {
                                "row": 77,
                                "column": 31
                              },
                              "end": {
                                "row": 77,
                                "column": 35
                              },
                              "text": "True"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 77,
                            "column": 35
                          },
                          "end": {
                            "row": 77,
                            "column": 36
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 77,
                            "column": 37
                          },
                          "end": {
                            "row": 77,
                            "column": 62
                          },
                          "text": "force_rebind=force_rebind",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 77,
                                "column": 37
                              },
                              "end": {
                                "row": 77,
                                "column": 49
                              },
                              "text": "force_rebind"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 77,
                                "column": 49
                              },
                              "end": {
                                "row": 77,
                                "column": 50
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 77,
                                "column": 50
                              },
                              "end": {
                                "row": 77,
                                "column": 62
                              },
                              "text": "force_rebind"
                            }
                          ]
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 77,
                            "column": 62
                          },
                          "end": {
                            "row": 77,
                            "column": 63
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "if_statement",
              "start": {
                "row": 78,
                "column": 8
              },
              "end": {
                "row": 79,
                "column": 41
              },
              "text": "if monitor is not None:\n            self.install_monitor(monitor)",
              "children": [
                {
                  "type": "if",
                  "start": {
                    "row": 78,
                    "column": 8
                  },
                  "end": {
                    "row": 78,
                    "column": 10
                  },
                  "text": "if"
                },
                {
                  "type": "comparison_operator",
                  "start": {
                    "row": 78,
                    "column": 11
                  },
                  "end": {
                    "row": 78,
                    "column": 30
                  },
                  "text": "monitor is not None",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 78,
                        "column": 11
                      },
                      "end": {
                        "row": 78,
                        "column": 18
                      },
                      "text": "monitor"
                    },
                    {
                      "type": "is not",
                      "start": {
                        "row": 78,
                        "column": 19
                      },
                      "end": {
                        "row": 78,
                        "column": 21
                      },
                      "text": "is"
                    },
                    {
                      "type": "is not",
                      "start": {
                        "row": 78,
                        "column": 22
                      },
                      "end": {
                        "row": 78,
                        "column": 25
                      },
                      "text": "not"
                    },
                    {
                      "type": "none",
                      "start": {
                        "row": 78,
                        "column": 26
                      },
                      "end": {
                        "row": 78,
                        "column": 30
                      },
                      "text": "None"
                    }
                  ]
                },
                {
                  "type": ":",
                  "start": {
                    "row": 78,
                    "column": 30
                  },
                  "end": {
                    "row": 78,
                    "column": 31
                  },
                  "text": ":"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 79,
                    "column": 12
                  },
                  "end": {
                    "row": 79,
                    "column": 41
                  },
                  "text": "self.install_monitor(monitor)",
                  "children": [
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 79,
                        "column": 12
                      },
                      "end": {
                        "row": 79,
                        "column": 41
                      },
                      "text": "self.install_monitor(monitor)",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 79,
                            "column": 12
                          },
                          "end": {
                            "row": 79,
                            "column": 41
                          },
                          "text": "self.install_monitor(monitor)",
                          "children": [
                            {
                              "type": "attribute",
                              "start": {
                                "row": 79,
                                "column": 12
                              },
                              "end": {
                                "row": 79,
                                "column": 32
                              },
                              "text": "self.install_monitor",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 79,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 79,
                                    "column": 16
                                  },
                                  "text": "self"
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 79,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 79,
                                    "column": 17
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 79,
                                    "column": 17
                                  },
                                  "end": {
                                    "row": 79,
                                    "column": 32
                                  },
                                  "text": "install_monitor"
                                }
                              ]
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 79,
                                "column": 32
                              },
                              "end": {
                                "row": 79,
                                "column": 41
                              },
                              "text": "(monitor)",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 79,
                                    "column": 32
                                  },
                                  "end": {
                                    "row": 79,
                                    "column": 33
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 79,
                                    "column": 33
                                  },
                                  "end": {
                                    "row": 79,
                                    "column": 40
                                  },
                                  "text": "monitor"
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 79,
                                    "column": 40
                                  },
                                  "end": {
                                    "row": 79,
                                    "column": 41
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "expression_statement",
              "start": {
                "row": 80,
                "column": 8
              },
              "end": {
                "row": 81,
                "column": 76
              },
              "text": "self.init_params(initializer=initializer, arg_params=arg_params, aux_params=aux_params,\n                         allow_missing=allow_missing, force_init=force_init)",
              "children": [
                {
                  "type": "call",
                  "start": {
                    "row": 80,
                    "column": 8
                  },
                  "end": {
                    "row": 81,
                    "column": 76
                  },
                  "text": "self.init_params(initializer=initializer, arg_params=arg_params, aux_params=aux_params,\n                         allow_missing=allow_missing, force_init=force_init)",
                  "children": [
                    {
                      "type": "attribute",
                      "start": {
                        "row": 80,
                        "column": 8
                      },
                      "end": {
                        "row": 80,
                        "column": 24
                      },
                      "text": "self.init_params",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 80,
                            "column": 8
                          },
                          "end": {
                            "row": 80,
                            "column": 12
                          },
                          "text": "self"
                        },
                        {
                          "type": ".",
                          "start": {
                            "row": 80,
                            "column": 12
                          },
                          "end": {
                            "row": 80,
                            "column": 13
                          },
                          "text": "."
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 80,
                            "column": 13
                          },
                          "end": {
                            "row": 80,
                            "column": 24
                          },
                          "text": "init_params"
                        }
                      ]
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 80,
                        "column": 24
                      },
                      "end": {
                        "row": 81,
                        "column": 76
                      },
                      "text": "(initializer=initializer, arg_params=arg_params, aux_params=aux_params,\n                         allow_missing=allow_missing, force_init=force_init)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 80,
                            "column": 24
                          },
                          "end": {
                            "row": 80,
                            "column": 25
                          },
                          "text": "("
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 80,
                            "column": 25
                          },
                          "end": {
                            "row": 80,
                            "column": 48
                          },
                          "text": "initializer=initializer",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 80,
                                "column": 25
                              },
                              "end": {
                                "row": 80,
                                "column": 36
                              },
                              "text": "initializer"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 80,
                                "column": 36
                              },
                              "end": {
                                "row": 80,
                                "column": 37
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 80,
                                "column": 37
                              },
                              "end": {
                                "row": 80,
                                "column": 48
                              },
                              "text": "initializer"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 80,
                            "column": 48
                          },
                          "end": {
                            "row": 80,
                            "column": 49
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 80,
                            "column": 50
                          },
                          "end": {
                            "row": 80,
                            "column": 71
                          },
                          "text": "arg_params=arg_params",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 80,
                                "column": 50
                              },
                              "end": {
                                "row": 80,
                                "column": 60
                              },
                              "text": "arg_params"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 80,
                                "column": 60
                              },
                              "end": {
                                "row": 80,
                                "column": 61
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 80,
                                "column": 61
                              },
                              "end": {
                                "row": 80,
                                "column": 71
                              },
                              "text": "arg_params"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 80,
                            "column": 71
                          },
                          "end": {
                            "row": 80,
                            "column": 72
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 80,
                            "column": 73
                          },
                          "end": {
                            "row": 80,
                            "column": 94
                          },
                          "text": "aux_params=aux_params",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 80,
                                "column": 73
                              },
                              "end": {
                                "row": 80,
                                "column": 83
                              },
                              "text": "aux_params"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 80,
                                "column": 83
                              },
                              "end": {
                                "row": 80,
                                "column": 84
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 80,
                                "column": 84
                              },
                              "end": {
                                "row": 80,
                                "column": 94
                              },
                              "text": "aux_params"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 80,
                            "column": 94
                          },
                          "end": {
                            "row": 80,
                            "column": 95
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 81,
                            "column": 25
                          },
                          "end": {
                            "row": 81,
                            "column": 52
                          },
                          "text": "allow_missing=allow_missing",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 81,
                                "column": 25
                              },
                              "end": {
                                "row": 81,
                                "column": 38
                              },
                              "text": "allow_missing"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 81,
                                "column": 38
                              },
                              "end": {
                                "row": 81,
                                "column": 39
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 81,
                                "column": 39
                              },
                              "end": {
                                "row": 81,
                                "column": 52
                              },
                              "text": "allow_missing"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 81,
                            "column": 52
                          },
                          "end": {
                            "row": 81,
                            "column": 53
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 81,
                            "column": 54
                          },
                          "end": {
                            "row": 81,
                            "column": 75
                          },
                          "text": "force_init=force_init",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 81,
                                "column": 54
                              },
                              "end": {
                                "row": 81,
                                "column": 64
                              },
                              "text": "force_init"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 81,
                                "column": 64
                              },
                              "end": {
                                "row": 81,
                                "column": 65
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 81,
                                "column": 65
                              },
                              "end": {
                                "row": 81,
                                "column": 75
                              },
                              "text": "force_init"
                            }
                          ]
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 81,
                            "column": 75
                          },
                          "end": {
                            "row": 81,
                            "column": 76
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "expression_statement",
              "start": {
                "row": 82,
                "column": 8
              },
              "end": {
                "row": 82,
                "column": 100
              },
              "text": "self.init_optimizer(kvstore=kvstore, optimizer=optimizer, optimizer_params=optimizer_params)",
              "children": [
                {
                  "type": "call",
                  "start": {
                    "row": 82,
                    "column": 8
                  },
                  "end": {
                    "row": 82,
                    "column": 100
                  },
                  "text": "self.init_optimizer(kvstore=kvstore, optimizer=optimizer, optimizer_params=optimizer_params)",
                  "children": [
                    {
                      "type": "attribute",
                      "start": {
                        "row": 82,
                        "column": 8
                      },
                      "end": {
                        "row": 82,
                        "column": 27
                      },
                      "text": "self.init_optimizer",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 82,
                            "column": 8
                          },
                          "end": {
                            "row": 82,
                            "column": 12
                          },
                          "text": "self"
                        },
                        {
                          "type": ".",
                          "start": {
                            "row": 82,
                            "column": 12
                          },
                          "end": {
                            "row": 82,
                            "column": 13
                          },
                          "text": "."
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 82,
                            "column": 13
                          },
                          "end": {
                            "row": 82,
                            "column": 27
                          },
                          "text": "init_optimizer"
                        }
                      ]
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 82,
                        "column": 27
                      },
                      "end": {
                        "row": 82,
                        "column": 100
                      },
                      "text": "(kvstore=kvstore, optimizer=optimizer, optimizer_params=optimizer_params)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 82,
                            "column": 27
                          },
                          "end": {
                            "row": 82,
                            "column": 28
                          },
                          "text": "("
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 82,
                            "column": 28
                          },
                          "end": {
                            "row": 82,
                            "column": 43
                          },
                          "text": "kvstore=kvstore",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 82,
                                "column": 28
                              },
                              "end": {
                                "row": 82,
                                "column": 35
                              },
                              "text": "kvstore"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 82,
                                "column": 35
                              },
                              "end": {
                                "row": 82,
                                "column": 36
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 82,
                                "column": 36
                              },
                              "end": {
                                "row": 82,
                                "column": 43
                              },
                              "text": "kvstore"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 82,
                            "column": 43
                          },
                          "end": {
                            "row": 82,
                            "column": 44
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 82,
                            "column": 45
                          },
                          "end": {
                            "row": 82,
                            "column": 64
                          },
                          "text": "optimizer=optimizer",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 82,
                                "column": 45
                              },
                              "end": {
                                "row": 82,
                                "column": 54
                              },
                              "text": "optimizer"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 82,
                                "column": 54
                              },
                              "end": {
                                "row": 82,
                                "column": 55
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 82,
                                "column": 55
                              },
                              "end": {
                                "row": 82,
                                "column": 64
                              },
                              "text": "optimizer"
                            }
                          ]
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 82,
                            "column": 64
                          },
                          "end": {
                            "row": 82,
                            "column": 65
                          },
                          "text": ","
                        },
                        {
                          "type": "keyword_argument",
                          "start": {
                            "row": 82,
                            "column": 66
                          },
                          "end": {
                            "row": 82,
                            "column": 99
                          },
                          "text": "optimizer_params=optimizer_params",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 82,
                                "column": 66
                              },
                              "end": {
                                "row": 82,
                                "column": 82
                              },
                              "text": "optimizer_params"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 82,
                                "column": 82
                              },
                              "end": {
                                "row": 82,
                                "column": 83
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 82,
                                "column": 83
                              },
                              "end": {
                                "row": 82,
                                "column": 99
                              },
                              "text": "optimizer_params"
                            }
                          ]
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 82,
                            "column": 99
                          },
                          "end": {
                            "row": 82,
                            "column": 100
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "if_statement",
              "start": {
                "row": 84,
                "column": 8
              },
              "end": {
                "row": 85,
                "column": 43
              },
              "text": "if validation_metric is None:\n            validation_metric = eval_metric",
              "children": [
                {
                  "type": "if",
                  "start": {
                    "row": 84,
                    "column": 8
                  },
                  "end": {
                    "row": 84,
                    "column": 10
                  },
                  "text": "if"
                },
                {
                  "type": "comparison_operator",
                  "start": {
                    "row": 84,
                    "column": 11
                  },
                  "end": {
                    "row": 84,
                    "column": 36
                  },
                  "text": "validation_metric is None",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 84,
                        "column": 11
                      },
                      "end": {
                        "row": 84,
                        "column": 28
                      },
                      "text": "validation_metric"
                    },
                    {
                      "type": "is",
                      "start": {
                        "row": 84,
                        "column": 29
                      },
                      "end": {
                        "row": 84,
                        "column": 31
                      },
                      "text": "is"
                    },
                    {
                      "type": "none",
                      "start": {
                        "row": 84,
                        "column": 32
                      },
                      "end": {
                        "row": 84,
                        "column": 36
                      },
                      "text": "None"
                    }
                  ]
                },
                {
                  "type": ":",
                  "start": {
                    "row": 84,
                    "column": 36
                  },
                  "end": {
                    "row": 84,
                    "column": 37
                  },
                  "text": ":"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 85,
                    "column": 12
                  },
                  "end": {
                    "row": 85,
                    "column": 43
                  },
                  "text": "validation_metric = eval_metric",
                  "children": [
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 85,
                        "column": 12
                      },
                      "end": {
                        "row": 85,
                        "column": 43
                      },
                      "text": "validation_metric = eval_metric",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 85,
                            "column": 12
                          },
                          "end": {
                            "row": 85,
                            "column": 43
                          },
                          "text": "validation_metric = eval_metric",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 85,
                                "column": 12
                              },
                              "end": {
                                "row": 85,
                                "column": 29
                              },
                              "text": "validation_metric"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 85,
                                "column": 30
                              },
                              "end": {
                                "row": 85,
                                "column": 31
                              },
                              "text": "="
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 85,
                                "column": 32
                              },
                              "end": {
                                "row": 85,
                                "column": 43
                              },
                              "text": "eval_metric"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "if_statement",
              "start": {
                "row": 86,
                "column": 8
              },
              "end": {
                "row": 87,
                "column": 55
              },
              "text": "if not isinstance(eval_metric, mx.metric.EvalMetric):\n            eval_metric = mx.metric.create(eval_metric)",
              "children": [
                {
                  "type": "if",
                  "start": {
                    "row": 86,
                    "column": 8
                  },
                  "end": {
                    "row": 86,
                    "column": 10
                  },
                  "text": "if"
                },
                {
                  "type": "not_operator",
                  "start": {
                    "row": 86,
                    "column": 11
                  },
                  "end": {
                    "row": 86,
                    "column": 60
                  },
                  "text": "not isinstance(eval_metric, mx.metric.EvalMetric)",
                  "children": [
                    {
                      "type": "not",
                      "start": {
                        "row": 86,
                        "column": 11
                      },
                      "end": {
                        "row": 86,
                        "column": 14
                      },
                      "text": "not"
                    },
                    {
                      "type": "call",
                      "start": {
                        "row": 86,
                        "column": 15
                      },
                      "end": {
                        "row": 86,
                        "column": 60
                      },
                      "text": "isinstance(eval_metric, mx.metric.EvalMetric)",
                      "children": [
                        {
                          "type": "identifier",
                          "start": {
                            "row": 86,
                            "column": 15
                          },
                          "end": {
                            "row": 86,
                            "column": 25
                          },
                          "text": "isinstance"
                        },
                        {
                          "type": "argument_list",
                          "start": {
                            "row": 86,
                            "column": 25
                          },
                          "end": {
                            "row": 86,
                            "column": 60
                          },
                          "text": "(eval_metric, mx.metric.EvalMetric)",
                          "children": [
                            {
                              "type": "(",
                              "start": {
                                "row": 86,
                                "column": 25
                              },
                              "end": {
                                "row": 86,
                                "column": 26
                              },
                              "text": "("
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 86,
                                "column": 26
                              },
                              "end": {
                                "row": 86,
                                "column": 37
                              },
                              "text": "eval_metric"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 86,
                                "column": 37
                              },
                              "end": {
                                "row": 86,
                                "column": 38
                              },
                              "text": ","
                            },
                            {
                              "type": "attribute",
                              "start": {
                                "row": 86,
                                "column": 39
                              },
                              "end": {
                                "row": 86,
                                "column": 59
                              },
                              "text": "mx.metric.EvalMetric",
                              "children": [
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 86,
                                    "column": 39
                                  },
                                  "end": {
                                    "row": 86,
                                    "column": 48
                                  },
                                  "text": "mx.metric",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 86,
                                        "column": 39
                                      },
                                      "end": {
                                        "row": 86,
                                        "column": 41
                                      },
                                      "text": "mx"
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 86,
                                        "column": 41
                                      },
                                      "end": {
                                        "row": 86,
                                        "column": 42
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 86,
                                        "column": 42
                                      },
                                      "end": {
                                        "row": 86,
                                        "column": 48
                                      },
                                      "text": "metric"
                                    }
                                  ]
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 86,
                                    "column": 48
                                  },
                                  "end": {
                                    "row": 86,
                                    "column": 49
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 86,
                                    "column": 49
                                  },
                                  "end": {
                                    "row": 86,
                                    "column": 59
                                  },
                                  "text": "EvalMetric"
                                }
                              ]
                            },
                            {
                              "type": ")",
                              "start": {
                                "row": 86,
                                "column": 59
                              },
                              "end": {
                                "row": 86,
                                "column": 60
                              },
                              "text": ")"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": ":",
                  "start": {
                    "row": 86,
                    "column": 60
                  },
                  "end": {
                    "row": 86,
                    "column": 61
                  },
                  "text": ":"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 87,
                    "column": 12
                  },
                  "end": {
                    "row": 87,
                    "column": 55
                  },
                  "text": "eval_metric = mx.metric.create(eval_metric)",
                  "children": [
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 87,
                        "column": 12
                      },
                      "end": {
                        "row": 87,
                        "column": 55
                      },
                      "text": "eval_metric = mx.metric.create(eval_metric)",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 87,
                            "column": 12
                          },
                          "end": {
                            "row": 87,
                            "column": 55
                          },
                          "text": "eval_metric = mx.metric.create(eval_metric)",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 87,
                                "column": 12
                              },
                              "end": {
                                "row": 87,
                                "column": 23
                              },
                              "text": "eval_metric"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 87,
                                "column": 24
                              },
                              "end": {
                                "row": 87,
                                "column": 25
                              },
                              "text": "="
                            },
                            {
                              "type": "call",
                              "start": {
                                "row": 87,
                                "column": 26
                              },
                              "end": {
                                "row": 87,
                                "column": 55
                              },
                              "text": "mx.metric.create(eval_metric)",
                              "children": [
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 87,
                                    "column": 26
                                  },
                                  "end": {
                                    "row": 87,
                                    "column": 42
                                  },
                                  "text": "mx.metric.create",
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "start": {
                                        "row": 87,
                                        "column": 26
                                      },
                                      "end": {
                                        "row": 87,
                                        "column": 35
                                      },
                                      "text": "mx.metric",
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 87,
                                            "column": 26
                                          },
                                          "end": {
                                            "row": 87,
                                            "column": 28
                                          },
                                          "text": "mx"
                                        },
                                        {
                                          "type": ".",
                                          "start": {
                                            "row": 87,
                                            "column": 28
                                          },
                                          "end": {
                                            "row": 87,
                                            "column": 29
                                          },
                                          "text": "."
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 87,
                                            "column": 29
                                          },
                                          "end": {
                                            "row": 87,
                                            "column": 35
                                          },
                                          "text": "metric"
                                        }
                                      ]
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 87,
                                        "column": 35
                                      },
                                      "end": {
                                        "row": 87,
                                        "column": 36
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 87,
                                        "column": 36
                                      },
                                      "end": {
                                        "row": 87,
                                        "column": 42
                                      },
                                      "text": "create"
                                    }
                                  ]
                                },
                                {
                                  "type": "argument_list",
                                  "start": {
                                    "row": 87,
                                    "column": 42
                                  },
                                  "end": {
                                    "row": 87,
                                    "column": 55
                                  },
                                  "text": "(eval_metric)",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 87,
                                        "column": 42
                                      },
                                      "end": {
                                        "row": 87,
                                        "column": 43
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 87,
                                        "column": 43
                                      },
                                      "end": {
                                        "row": 87,
                                        "column": 54
                                      },
                                      "text": "eval_metric"
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 87,
                                        "column": 54
                                      },
                                      "end": {
                                        "row": 87,
                                        "column": 55
                                      },
                                      "text": ")"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "comment",
              "start": {
                "row": 89,
                "column": 8
              },
              "end": {
                "row": 89,
                "column": 88
              },
              "text": "################################################################################"
            },
            {
              "type": "comment",
              "start": {
                "row": 90,
                "column": 8
              },
              "end": {
                "row": 90,
                "column": 23
              },
              "text": "# training loop"
            },
            {
              "type": "comment",
              "start": {
                "row": 91,
                "column": 8
              },
              "end": {
                "row": 91,
                "column": 88
              },
              "text": "################################################################################"
            },
            {
              "type": "for_statement",
              "start": {
                "row": 92,
                "column": 8
              },
              "end": {
                "row": 157,
                "column": 84
              },
              "text": "for epoch in range(begin_epoch, num_epoch):\n            eval_metric.reset()\n            tic = time.time()\n            if epoch % self.update_freq == 0:\n                self.update_full_grads(train_data)\n\n            train_data.reset()\n            data_iter = iter(train_data)\n            end_of_batch = False\n            nbatch = 0\n            next_data_batch = next(data_iter)\n\n            while not end_of_batch:\n                data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1\n            for name, val in eval_name_vals:\n                self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)\n            toc = time.time()\n            self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))\n\n            # sync aux params across devices\n            arg_params, aux_params = self.get_params()\n            self.set_params(arg_params, aux_params)\n\n            if epoch_end_callback is not None:\n                for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)\n\n            # ----------------------------------------\n            # evaluation on validation set\n            if eval_data:\n                res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
              "children": [
                {
                  "type": "for",
                  "start": {
                    "row": 92,
                    "column": 8
                  },
                  "end": {
                    "row": 92,
                    "column": 11
                  },
                  "text": "for"
                },
                {
                  "type": "identifier",
                  "start": {
                    "row": 92,
                    "column": 12
                  },
                  "end": {
                    "row": 92,
                    "column": 17
                  },
                  "text": "epoch"
                },
                {
                  "type": "in",
                  "start": {
                    "row": 92,
                    "column": 18
                  },
                  "end": {
                    "row": 92,
                    "column": 20
                  },
                  "text": "in"
                },
                {
                  "type": "call",
                  "start": {
                    "row": 92,
                    "column": 21
                  },
                  "end": {
                    "row": 92,
                    "column": 50
                  },
                  "text": "range(begin_epoch, num_epoch)",
                  "children": [
                    {
                      "type": "identifier",
                      "start": {
                        "row": 92,
                        "column": 21
                      },
                      "end": {
                        "row": 92,
                        "column": 26
                      },
                      "text": "range"
                    },
                    {
                      "type": "argument_list",
                      "start": {
                        "row": 92,
                        "column": 26
                      },
                      "end": {
                        "row": 92,
                        "column": 50
                      },
                      "text": "(begin_epoch, num_epoch)",
                      "children": [
                        {
                          "type": "(",
                          "start": {
                            "row": 92,
                            "column": 26
                          },
                          "end": {
                            "row": 92,
                            "column": 27
                          },
                          "text": "("
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 92,
                            "column": 27
                          },
                          "end": {
                            "row": 92,
                            "column": 38
                          },
                          "text": "begin_epoch"
                        },
                        {
                          "type": ",",
                          "start": {
                            "row": 92,
                            "column": 38
                          },
                          "end": {
                            "row": 92,
                            "column": 39
                          },
                          "text": ","
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 92,
                            "column": 40
                          },
                          "end": {
                            "row": 92,
                            "column": 49
                          },
                          "text": "num_epoch"
                        },
                        {
                          "type": ")",
                          "start": {
                            "row": 92,
                            "column": 49
                          },
                          "end": {
                            "row": 92,
                            "column": 50
                          },
                          "text": ")"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": ":",
                  "start": {
                    "row": 92,
                    "column": 50
                  },
                  "end": {
                    "row": 92,
                    "column": 51
                  },
                  "text": ":"
                },
                {
                  "type": "block",
                  "start": {
                    "row": 93,
                    "column": 12
                  },
                  "end": {
                    "row": 157,
                    "column": 84
                  },
                  "text": "eval_metric.reset()\n            tic = time.time()\n            if epoch % self.update_freq == 0:\n                self.update_full_grads(train_data)\n\n            train_data.reset()\n            data_iter = iter(train_data)\n            end_of_batch = False\n            nbatch = 0\n            next_data_batch = next(data_iter)\n\n            while not end_of_batch:\n                data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1\n            for name, val in eval_name_vals:\n                self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)\n            toc = time.time()\n            self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))\n\n            # sync aux params across devices\n            arg_params, aux_params = self.get_params()\n            self.set_params(arg_params, aux_params)\n\n            if epoch_end_callback is not None:\n                for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)\n\n            # ----------------------------------------\n            # evaluation on validation set\n            if eval_data:\n                res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                  "children": [
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 93,
                        "column": 12
                      },
                      "end": {
                        "row": 93,
                        "column": 31
                      },
                      "text": "eval_metric.reset()",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 93,
                            "column": 12
                          },
                          "end": {
                            "row": 93,
                            "column": 31
                          },
                          "text": "eval_metric.reset()",
                          "children": [
                            {
                              "type": "attribute",
                              "start": {
                                "row": 93,
                                "column": 12
                              },
                              "end": {
                                "row": 93,
                                "column": 29
                              },
                              "text": "eval_metric.reset",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 93,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 93,
                                    "column": 23
                                  },
                                  "text": "eval_metric"
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 93,
                                    "column": 23
                                  },
                                  "end": {
                                    "row": 93,
                                    "column": 24
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 93,
                                    "column": 24
                                  },
                                  "end": {
                                    "row": 93,
                                    "column": 29
                                  },
                                  "text": "reset"
                                }
                              ]
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 93,
                                "column": 29
                              },
                              "end": {
                                "row": 93,
                                "column": 31
                              },
                              "text": "()",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 93,
                                    "column": 29
                                  },
                                  "end": {
                                    "row": 93,
                                    "column": 30
                                  },
                                  "text": "("
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 93,
                                    "column": 30
                                  },
                                  "end": {
                                    "row": 93,
                                    "column": 31
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 94,
                        "column": 12
                      },
                      "end": {
                        "row": 94,
                        "column": 29
                      },
                      "text": "tic = time.time()",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 94,
                            "column": 12
                          },
                          "end": {
                            "row": 94,
                            "column": 29
                          },
                          "text": "tic = time.time()",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 94,
                                "column": 12
                              },
                              "end": {
                                "row": 94,
                                "column": 15
                              },
                              "text": "tic"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 94,
                                "column": 16
                              },
                              "end": {
                                "row": 94,
                                "column": 17
                              },
                              "text": "="
                            },
                            {
                              "type": "call",
                              "start": {
                                "row": 94,
                                "column": 18
                              },
                              "end": {
                                "row": 94,
                                "column": 29
                              },
                              "text": "time.time()",
                              "children": [
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 94,
                                    "column": 18
                                  },
                                  "end": {
                                    "row": 94,
                                    "column": 27
                                  },
                                  "text": "time.time",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 94,
                                        "column": 18
                                      },
                                      "end": {
                                        "row": 94,
                                        "column": 22
                                      },
                                      "text": "time"
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 94,
                                        "column": 22
                                      },
                                      "end": {
                                        "row": 94,
                                        "column": 23
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 94,
                                        "column": 23
                                      },
                                      "end": {
                                        "row": 94,
                                        "column": 27
                                      },
                                      "text": "time"
                                    }
                                  ]
                                },
                                {
                                  "type": "argument_list",
                                  "start": {
                                    "row": 94,
                                    "column": 27
                                  },
                                  "end": {
                                    "row": 94,
                                    "column": 29
                                  },
                                  "text": "()",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 94,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 94,
                                        "column": 28
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 94,
                                        "column": 28
                                      },
                                      "end": {
                                        "row": 94,
                                        "column": 29
                                      },
                                      "text": ")"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "if_statement",
                      "start": {
                        "row": 95,
                        "column": 12
                      },
                      "end": {
                        "row": 96,
                        "column": 50
                      },
                      "text": "if epoch % self.update_freq == 0:\n                self.update_full_grads(train_data)",
                      "children": [
                        {
                          "type": "if",
                          "start": {
                            "row": 95,
                            "column": 12
                          },
                          "end": {
                            "row": 95,
                            "column": 14
                          },
                          "text": "if"
                        },
                        {
                          "type": "comparison_operator",
                          "start": {
                            "row": 95,
                            "column": 15
                          },
                          "end": {
                            "row": 95,
                            "column": 44
                          },
                          "text": "epoch % self.update_freq == 0",
                          "children": [
                            {
                              "type": "binary_operator",
                              "start": {
                                "row": 95,
                                "column": 15
                              },
                              "end": {
                                "row": 95,
                                "column": 39
                              },
                              "text": "epoch % self.update_freq",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 95,
                                    "column": 15
                                  },
                                  "end": {
                                    "row": 95,
                                    "column": 20
                                  },
                                  "text": "epoch"
                                },
                                {
                                  "type": "%",
                                  "start": {
                                    "row": 95,
                                    "column": 21
                                  },
                                  "end": {
                                    "row": 95,
                                    "column": 22
                                  },
                                  "text": "%"
                                },
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 95,
                                    "column": 23
                                  },
                                  "end": {
                                    "row": 95,
                                    "column": 39
                                  },
                                  "text": "self.update_freq",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 95,
                                        "column": 23
                                      },
                                      "end": {
                                        "row": 95,
                                        "column": 27
                                      },
                                      "text": "self"
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 95,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 95,
                                        "column": 28
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 95,
                                        "column": 28
                                      },
                                      "end": {
                                        "row": 95,
                                        "column": 39
                                      },
                                      "text": "update_freq"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "==",
                              "start": {
                                "row": 95,
                                "column": 40
                              },
                              "end": {
                                "row": 95,
                                "column": 42
                              },
                              "text": "=="
                            },
                            {
                              "type": "integer",
                              "start": {
                                "row": 95,
                                "column": 43
                              },
                              "end": {
                                "row": 95,
                                "column": 44
                              },
                              "text": "0"
                            }
                          ]
                        },
                        {
                          "type": ":",
                          "start": {
                            "row": 95,
                            "column": 44
                          },
                          "end": {
                            "row": 95,
                            "column": 45
                          },
                          "text": ":"
                        },
                        {
                          "type": "block",
                          "start": {
                            "row": 96,
                            "column": 16
                          },
                          "end": {
                            "row": 96,
                            "column": 50
                          },
                          "text": "self.update_full_grads(train_data)",
                          "children": [
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 96,
                                "column": 16
                              },
                              "end": {
                                "row": 96,
                                "column": 50
                              },
                              "text": "self.update_full_grads(train_data)",
                              "children": [
                                {
                                  "type": "call",
                                  "start": {
                                    "row": 96,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 96,
                                    "column": 50
                                  },
                                  "text": "self.update_full_grads(train_data)",
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "start": {
                                        "row": 96,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 96,
                                        "column": 38
                                      },
                                      "text": "self.update_full_grads",
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 96,
                                            "column": 16
                                          },
                                          "end": {
                                            "row": 96,
                                            "column": 20
                                          },
                                          "text": "self"
                                        },
                                        {
                                          "type": ".",
                                          "start": {
                                            "row": 96,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 96,
                                            "column": 21
                                          },
                                          "text": "."
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 96,
                                            "column": 21
                                          },
                                          "end": {
                                            "row": 96,
                                            "column": 38
                                          },
                                          "text": "update_full_grads"
                                        }
                                      ]
                                    },
                                    {
                                      "type": "argument_list",
                                      "start": {
                                        "row": 96,
                                        "column": 38
                                      },
                                      "end": {
                                        "row": 96,
                                        "column": 50
                                      },
                                      "text": "(train_data)",
                                      "children": [
                                        {
                                          "type": "(",
                                          "start": {
                                            "row": 96,
                                            "column": 38
                                          },
                                          "end": {
                                            "row": 96,
                                            "column": 39
                                          },
                                          "text": "("
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 96,
                                            "column": 39
                                          },
                                          "end": {
                                            "row": 96,
                                            "column": 49
                                          },
                                          "text": "train_data"
                                        },
                                        {
                                          "type": ")",
                                          "start": {
                                            "row": 96,
                                            "column": 49
                                          },
                                          "end": {
                                            "row": 96,
                                            "column": 50
                                          },
                                          "text": ")"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 98,
                        "column": 12
                      },
                      "end": {
                        "row": 98,
                        "column": 30
                      },
                      "text": "train_data.reset()",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 98,
                            "column": 12
                          },
                          "end": {
                            "row": 98,
                            "column": 30
                          },
                          "text": "train_data.reset()",
                          "children": [
                            {
                              "type": "attribute",
                              "start": {
                                "row": 98,
                                "column": 12
                              },
                              "end": {
                                "row": 98,
                                "column": 28
                              },
                              "text": "train_data.reset",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 98,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 98,
                                    "column": 22
                                  },
                                  "text": "train_data"
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 98,
                                    "column": 22
                                  },
                                  "end": {
                                    "row": 98,
                                    "column": 23
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 98,
                                    "column": 23
                                  },
                                  "end": {
                                    "row": 98,
                                    "column": 28
                                  },
                                  "text": "reset"
                                }
                              ]
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 98,
                                "column": 28
                              },
                              "end": {
                                "row": 98,
                                "column": 30
                              },
                              "text": "()",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 98,
                                    "column": 28
                                  },
                                  "end": {
                                    "row": 98,
                                    "column": 29
                                  },
                                  "text": "("
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 98,
                                    "column": 29
                                  },
                                  "end": {
                                    "row": 98,
                                    "column": 30
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 99,
                        "column": 12
                      },
                      "end": {
                        "row": 99,
                        "column": 40
                      },
                      "text": "data_iter = iter(train_data)",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 99,
                            "column": 12
                          },
                          "end": {
                            "row": 99,
                            "column": 40
                          },
                          "text": "data_iter = iter(train_data)",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 99,
                                "column": 12
                              },
                              "end": {
                                "row": 99,
                                "column": 21
                              },
                              "text": "data_iter"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 99,
                                "column": 22
                              },
                              "end": {
                                "row": 99,
                                "column": 23
                              },
                              "text": "="
                            },
                            {
                              "type": "call",
                              "start": {
                                "row": 99,
                                "column": 24
                              },
                              "end": {
                                "row": 99,
                                "column": 40
                              },
                              "text": "iter(train_data)",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 99,
                                    "column": 24
                                  },
                                  "end": {
                                    "row": 99,
                                    "column": 28
                                  },
                                  "text": "iter"
                                },
                                {
                                  "type": "argument_list",
                                  "start": {
                                    "row": 99,
                                    "column": 28
                                  },
                                  "end": {
                                    "row": 99,
                                    "column": 40
                                  },
                                  "text": "(train_data)",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 99,
                                        "column": 28
                                      },
                                      "end": {
                                        "row": 99,
                                        "column": 29
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 99,
                                        "column": 29
                                      },
                                      "end": {
                                        "row": 99,
                                        "column": 39
                                      },
                                      "text": "train_data"
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 99,
                                        "column": 39
                                      },
                                      "end": {
                                        "row": 99,
                                        "column": 40
                                      },
                                      "text": ")"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 100,
                        "column": 12
                      },
                      "end": {
                        "row": 100,
                        "column": 32
                      },
                      "text": "end_of_batch = False",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 100,
                            "column": 12
                          },
                          "end": {
                            "row": 100,
                            "column": 32
                          },
                          "text": "end_of_batch = False",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 100,
                                "column": 12
                              },
                              "end": {
                                "row": 100,
                                "column": 24
                              },
                              "text": "end_of_batch"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 100,
                                "column": 25
                              },
                              "end": {
                                "row": 100,
                                "column": 26
                              },
                              "text": "="
                            },
                            {
                              "type": "false",
                              "start": {
                                "row": 100,
                                "column": 27
                              },
                              "end": {
                                "row": 100,
                                "column": 32
                              },
                              "text": "False"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 101,
                        "column": 12
                      },
                      "end": {
                        "row": 101,
                        "column": 22
                      },
                      "text": "nbatch = 0",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 101,
                            "column": 12
                          },
                          "end": {
                            "row": 101,
                            "column": 22
                          },
                          "text": "nbatch = 0",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 101,
                                "column": 12
                              },
                              "end": {
                                "row": 101,
                                "column": 18
                              },
                              "text": "nbatch"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 101,
                                "column": 19
                              },
                              "end": {
                                "row": 101,
                                "column": 20
                              },
                              "text": "="
                            },
                            {
                              "type": "integer",
                              "start": {
                                "row": 101,
                                "column": 21
                              },
                              "end": {
                                "row": 101,
                                "column": 22
                              },
                              "text": "0"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 102,
                        "column": 12
                      },
                      "end": {
                        "row": 102,
                        "column": 45
                      },
                      "text": "next_data_batch = next(data_iter)",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 102,
                            "column": 12
                          },
                          "end": {
                            "row": 102,
                            "column": 45
                          },
                          "text": "next_data_batch = next(data_iter)",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 102,
                                "column": 12
                              },
                              "end": {
                                "row": 102,
                                "column": 27
                              },
                              "text": "next_data_batch"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 102,
                                "column": 28
                              },
                              "end": {
                                "row": 102,
                                "column": 29
                              },
                              "text": "="
                            },
                            {
                              "type": "call",
                              "start": {
                                "row": 102,
                                "column": 30
                              },
                              "end": {
                                "row": 102,
                                "column": 45
                              },
                              "text": "next(data_iter)",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 102,
                                    "column": 30
                                  },
                                  "end": {
                                    "row": 102,
                                    "column": 34
                                  },
                                  "text": "next"
                                },
                                {
                                  "type": "argument_list",
                                  "start": {
                                    "row": 102,
                                    "column": 34
                                  },
                                  "end": {
                                    "row": 102,
                                    "column": 45
                                  },
                                  "text": "(data_iter)",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 102,
                                        "column": 34
                                      },
                                      "end": {
                                        "row": 102,
                                        "column": 35
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 102,
                                        "column": 35
                                      },
                                      "end": {
                                        "row": 102,
                                        "column": 44
                                      },
                                      "text": "data_iter"
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 102,
                                        "column": 44
                                      },
                                      "end": {
                                        "row": 102,
                                        "column": 45
                                      },
                                      "text": ")"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "while_statement",
                      "start": {
                        "row": 104,
                        "column": 12
                      },
                      "end": {
                        "row": 136,
                        "column": 27
                      },
                      "text": "while not end_of_batch:\n                data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1",
                      "children": [
                        {
                          "type": "while",
                          "start": {
                            "row": 104,
                            "column": 12
                          },
                          "end": {
                            "row": 104,
                            "column": 17
                          },
                          "text": "while"
                        },
                        {
                          "type": "not_operator",
                          "start": {
                            "row": 104,
                            "column": 18
                          },
                          "end": {
                            "row": 104,
                            "column": 34
                          },
                          "text": "not end_of_batch",
                          "children": [
                            {
                              "type": "not",
                              "start": {
                                "row": 104,
                                "column": 18
                              },
                              "end": {
                                "row": 104,
                                "column": 21
                              },
                              "text": "not"
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 104,
                                "column": 22
                              },
                              "end": {
                                "row": 104,
                                "column": 34
                              },
                              "text": "end_of_batch"
                            }
                          ]
                        },
                        {
                          "type": ":",
                          "start": {
                            "row": 104,
                            "column": 34
                          },
                          "end": {
                            "row": 104,
                            "column": 35
                          },
                          "text": ":"
                        },
                        {
                          "type": "block",
                          "start": {
                            "row": 105,
                            "column": 16
                          },
                          "end": {
                            "row": 136,
                            "column": 27
                          },
                          "text": "data_batch = next_data_batch\n                if monitor is not None:\n                    monitor.tic()\n\n                self.forward_backward(data_batch)\n                self.update()\n\n                if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)\n\n                try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True\n\n                if monitor is not None:\n                    monitor.toc_print()\n\n                if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()\n\n                if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)\n\n                nbatch += 1",
                          "children": [
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 105,
                                "column": 16
                              },
                              "end": {
                                "row": 105,
                                "column": 44
                              },
                              "text": "data_batch = next_data_batch",
                              "children": [
                                {
                                  "type": "assignment",
                                  "start": {
                                    "row": 105,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 105,
                                    "column": 44
                                  },
                                  "text": "data_batch = next_data_batch",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 105,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 105,
                                        "column": 26
                                      },
                                      "text": "data_batch"
                                    },
                                    {
                                      "type": "=",
                                      "start": {
                                        "row": 105,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 105,
                                        "column": 28
                                      },
                                      "text": "="
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 105,
                                        "column": 29
                                      },
                                      "end": {
                                        "row": 105,
                                        "column": 44
                                      },
                                      "text": "next_data_batch"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "start": {
                                "row": 106,
                                "column": 16
                              },
                              "end": {
                                "row": 107,
                                "column": 33
                              },
                              "text": "if monitor is not None:\n                    monitor.tic()",
                              "children": [
                                {
                                  "type": "if",
                                  "start": {
                                    "row": 106,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 106,
                                    "column": 18
                                  },
                                  "text": "if"
                                },
                                {
                                  "type": "comparison_operator",
                                  "start": {
                                    "row": 106,
                                    "column": 19
                                  },
                                  "end": {
                                    "row": 106,
                                    "column": 38
                                  },
                                  "text": "monitor is not None",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 106,
                                        "column": 19
                                      },
                                      "end": {
                                        "row": 106,
                                        "column": 26
                                      },
                                      "text": "monitor"
                                    },
                                    {
                                      "type": "is not",
                                      "start": {
                                        "row": 106,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 106,
                                        "column": 29
                                      },
                                      "text": "is"
                                    },
                                    {
                                      "type": "is not",
                                      "start": {
                                        "row": 106,
                                        "column": 30
                                      },
                                      "end": {
                                        "row": 106,
                                        "column": 33
                                      },
                                      "text": "not"
                                    },
                                    {
                                      "type": "none",
                                      "start": {
                                        "row": 106,
                                        "column": 34
                                      },
                                      "end": {
                                        "row": 106,
                                        "column": 38
                                      },
                                      "text": "None"
                                    }
                                  ]
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 106,
                                    "column": 38
                                  },
                                  "end": {
                                    "row": 106,
                                    "column": 39
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 107,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 107,
                                    "column": 33
                                  },
                                  "text": "monitor.tic()",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 107,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 107,
                                        "column": 33
                                      },
                                      "text": "monitor.tic()",
                                      "children": [
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 107,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 107,
                                            "column": 33
                                          },
                                          "text": "monitor.tic()",
                                          "children": [
                                            {
                                              "type": "attribute",
                                              "start": {
                                                "row": 107,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 107,
                                                "column": 31
                                              },
                                              "text": "monitor.tic",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 107,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 107,
                                                    "column": 27
                                                  },
                                                  "text": "monitor"
                                                },
                                                {
                                                  "type": ".",
                                                  "start": {
                                                    "row": 107,
                                                    "column": 27
                                                  },
                                                  "end": {
                                                    "row": 107,
                                                    "column": 28
                                                  },
                                                  "text": "."
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 107,
                                                    "column": 28
                                                  },
                                                  "end": {
                                                    "row": 107,
                                                    "column": 31
                                                  },
                                                  "text": "tic"
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 107,
                                                "column": 31
                                              },
                                              "end": {
                                                "row": 107,
                                                "column": 33
                                              },
                                              "text": "()",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 107,
                                                    "column": 31
                                                  },
                                                  "end": {
                                                    "row": 107,
                                                    "column": 32
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 107,
                                                    "column": 32
                                                  },
                                                  "end": {
                                                    "row": 107,
                                                    "column": 33
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 109,
                                "column": 16
                              },
                              "end": {
                                "row": 109,
                                "column": 49
                              },
                              "text": "self.forward_backward(data_batch)",
                              "children": [
                                {
                                  "type": "call",
                                  "start": {
                                    "row": 109,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 109,
                                    "column": 49
                                  },
                                  "text": "self.forward_backward(data_batch)",
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "start": {
                                        "row": 109,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 109,
                                        "column": 37
                                      },
                                      "text": "self.forward_backward",
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 109,
                                            "column": 16
                                          },
                                          "end": {
                                            "row": 109,
                                            "column": 20
                                          },
                                          "text": "self"
                                        },
                                        {
                                          "type": ".",
                                          "start": {
                                            "row": 109,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 109,
                                            "column": 21
                                          },
                                          "text": "."
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 109,
                                            "column": 21
                                          },
                                          "end": {
                                            "row": 109,
                                            "column": 37
                                          },
                                          "text": "forward_backward"
                                        }
                                      ]
                                    },
                                    {
                                      "type": "argument_list",
                                      "start": {
                                        "row": 109,
                                        "column": 37
                                      },
                                      "end": {
                                        "row": 109,
                                        "column": 49
                                      },
                                      "text": "(data_batch)",
                                      "children": [
                                        {
                                          "type": "(",
                                          "start": {
                                            "row": 109,
                                            "column": 37
                                          },
                                          "end": {
                                            "row": 109,
                                            "column": 38
                                          },
                                          "text": "("
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 109,
                                            "column": 38
                                          },
                                          "end": {
                                            "row": 109,
                                            "column": 48
                                          },
                                          "text": "data_batch"
                                        },
                                        {
                                          "type": ")",
                                          "start": {
                                            "row": 109,
                                            "column": 48
                                          },
                                          "end": {
                                            "row": 109,
                                            "column": 49
                                          },
                                          "text": ")"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 110,
                                "column": 16
                              },
                              "end": {
                                "row": 110,
                                "column": 29
                              },
                              "text": "self.update()",
                              "children": [
                                {
                                  "type": "call",
                                  "start": {
                                    "row": 110,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 110,
                                    "column": 29
                                  },
                                  "text": "self.update()",
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "start": {
                                        "row": 110,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 110,
                                        "column": 27
                                      },
                                      "text": "self.update",
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 110,
                                            "column": 16
                                          },
                                          "end": {
                                            "row": 110,
                                            "column": 20
                                          },
                                          "text": "self"
                                        },
                                        {
                                          "type": ".",
                                          "start": {
                                            "row": 110,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 110,
                                            "column": 21
                                          },
                                          "text": "."
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 110,
                                            "column": 21
                                          },
                                          "end": {
                                            "row": 110,
                                            "column": 27
                                          },
                                          "text": "update"
                                        }
                                      ]
                                    },
                                    {
                                      "type": "argument_list",
                                      "start": {
                                        "row": 110,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 110,
                                        "column": 29
                                      },
                                      "text": "()",
                                      "children": [
                                        {
                                          "type": "(",
                                          "start": {
                                            "row": 110,
                                            "column": 27
                                          },
                                          "end": {
                                            "row": 110,
                                            "column": 28
                                          },
                                          "text": "("
                                        },
                                        {
                                          "type": ")",
                                          "start": {
                                            "row": 110,
                                            "column": 28
                                          },
                                          "end": {
                                            "row": 110,
                                            "column": 29
                                          },
                                          "text": ")"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "start": {
                                "row": 112,
                                "column": 16
                              },
                              "end": {
                                "row": 115,
                                "column": 69
                              },
                              "text": "if isinstance(data_batch, list):\n                    self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)\n                else:\n                    self.update_metric(eval_metric, data_batch.label)",
                              "children": [
                                {
                                  "type": "if",
                                  "start": {
                                    "row": 112,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 112,
                                    "column": 18
                                  },
                                  "text": "if"
                                },
                                {
                                  "type": "call",
                                  "start": {
                                    "row": 112,
                                    "column": 19
                                  },
                                  "end": {
                                    "row": 112,
                                    "column": 47
                                  },
                                  "text": "isinstance(data_batch, list)",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 112,
                                        "column": 19
                                      },
                                      "end": {
                                        "row": 112,
                                        "column": 29
                                      },
                                      "text": "isinstance"
                                    },
                                    {
                                      "type": "argument_list",
                                      "start": {
                                        "row": 112,
                                        "column": 29
                                      },
                                      "end": {
                                        "row": 112,
                                        "column": 47
                                      },
                                      "text": "(data_batch, list)",
                                      "children": [
                                        {
                                          "type": "(",
                                          "start": {
                                            "row": 112,
                                            "column": 29
                                          },
                                          "end": {
                                            "row": 112,
                                            "column": 30
                                          },
                                          "text": "("
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 112,
                                            "column": 30
                                          },
                                          "end": {
                                            "row": 112,
                                            "column": 40
                                          },
                                          "text": "data_batch"
                                        },
                                        {
                                          "type": ",",
                                          "start": {
                                            "row": 112,
                                            "column": 40
                                          },
                                          "end": {
                                            "row": 112,
                                            "column": 41
                                          },
                                          "text": ","
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 112,
                                            "column": 42
                                          },
                                          "end": {
                                            "row": 112,
                                            "column": 46
                                          },
                                          "text": "list"
                                        },
                                        {
                                          "type": ")",
                                          "start": {
                                            "row": 112,
                                            "column": 46
                                          },
                                          "end": {
                                            "row": 112,
                                            "column": 47
                                          },
                                          "text": ")"
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 112,
                                    "column": 47
                                  },
                                  "end": {
                                    "row": 112,
                                    "column": 48
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 113,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 113,
                                    "column": 101
                                  },
                                  "text": "self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 113,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 113,
                                        "column": 101
                                      },
                                      "text": "self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)",
                                      "children": [
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 113,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 113,
                                            "column": 101
                                          },
                                          "text": "self.update_metric(eval_metric, [db.label for db in data_batch], pre_sliced=True)",
                                          "children": [
                                            {
                                              "type": "attribute",
                                              "start": {
                                                "row": 113,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 113,
                                                "column": 38
                                              },
                                              "text": "self.update_metric",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 24
                                                  },
                                                  "text": "self"
                                                },
                                                {
                                                  "type": ".",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 24
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 25
                                                  },
                                                  "text": "."
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 25
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 38
                                                  },
                                                  "text": "update_metric"
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 113,
                                                "column": 38
                                              },
                                              "end": {
                                                "row": 113,
                                                "column": 101
                                              },
                                              "text": "(eval_metric, [db.label for db in data_batch], pre_sliced=True)",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 38
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 39
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 39
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 50
                                                  },
                                                  "text": "eval_metric"
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 50
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 51
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "list_comprehension",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 52
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 83
                                                  },
                                                  "text": "[db.label for db in data_batch]",
                                                  "children": [
                                                    {
                                                      "type": "[",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 52
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 53
                                                      },
                                                      "text": "["
                                                    },
                                                    {
                                                      "type": "attribute",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 53
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 61
                                                      },
                                                      "text": "db.label",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 53
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 55
                                                          },
                                                          "text": "db"
                                                        },
                                                        {
                                                          "type": ".",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 55
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 56
                                                          },
                                                          "text": "."
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 56
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 61
                                                          },
                                                          "text": "label"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "for_in_clause",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 62
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 82
                                                      },
                                                      "text": "for db in data_batch",
                                                      "children": [
                                                        {
                                                          "type": "for",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 62
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 65
                                                          },
                                                          "text": "for"
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 66
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 68
                                                          },
                                                          "text": "db"
                                                        },
                                                        {
                                                          "type": "in",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 69
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 71
                                                          },
                                                          "text": "in"
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 113,
                                                            "column": 72
                                                          },
                                                          "end": {
                                                            "row": 113,
                                                            "column": 82
                                                          },
                                                          "text": "data_batch"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "]",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 82
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 83
                                                      },
                                                      "text": "]"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 83
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 84
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "keyword_argument",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 85
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 100
                                                  },
                                                  "text": "pre_sliced=True",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 85
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 95
                                                      },
                                                      "text": "pre_sliced"
                                                    },
                                                    {
                                                      "type": "=",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 95
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 96
                                                      },
                                                      "text": "="
                                                    },
                                                    {
                                                      "type": "true",
                                                      "start": {
                                                        "row": 113,
                                                        "column": 96
                                                      },
                                                      "end": {
                                                        "row": 113,
                                                        "column": 100
                                                      },
                                                      "text": "True"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 113,
                                                    "column": 100
                                                  },
                                                  "end": {
                                                    "row": 113,
                                                    "column": 101
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "else_clause",
                                  "start": {
                                    "row": 114,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 115,
                                    "column": 69
                                  },
                                  "text": "else:\n                    self.update_metric(eval_metric, data_batch.label)",
                                  "children": [
                                    {
                                      "type": "else",
                                      "start": {
                                        "row": 114,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 114,
                                        "column": 20
                                      },
                                      "text": "else"
                                    },
                                    {
                                      "type": ":",
                                      "start": {
                                        "row": 114,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 114,
                                        "column": 21
                                      },
                                      "text": ":"
                                    },
                                    {
                                      "type": "block",
                                      "start": {
                                        "row": 115,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 115,
                                        "column": 69
                                      },
                                      "text": "self.update_metric(eval_metric, data_batch.label)",
                                      "children": [
                                        {
                                          "type": "expression_statement",
                                          "start": {
                                            "row": 115,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 115,
                                            "column": 69
                                          },
                                          "text": "self.update_metric(eval_metric, data_batch.label)",
                                          "children": [
                                            {
                                              "type": "call",
                                              "start": {
                                                "row": 115,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 115,
                                                "column": 69
                                              },
                                              "text": "self.update_metric(eval_metric, data_batch.label)",
                                              "children": [
                                                {
                                                  "type": "attribute",
                                                  "start": {
                                                    "row": 115,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 115,
                                                    "column": 38
                                                  },
                                                  "text": "self.update_metric",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 20
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 24
                                                      },
                                                      "text": "self"
                                                    },
                                                    {
                                                      "type": ".",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 24
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 25
                                                      },
                                                      "text": "."
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 25
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 38
                                                      },
                                                      "text": "update_metric"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "start": {
                                                    "row": 115,
                                                    "column": 38
                                                  },
                                                  "end": {
                                                    "row": 115,
                                                    "column": 69
                                                  },
                                                  "text": "(eval_metric, data_batch.label)",
                                                  "children": [
                                                    {
                                                      "type": "(",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 38
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 39
                                                      },
                                                      "text": "("
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 39
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 50
                                                      },
                                                      "text": "eval_metric"
                                                    },
                                                    {
                                                      "type": ",",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 50
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 51
                                                      },
                                                      "text": ","
                                                    },
                                                    {
                                                      "type": "attribute",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 52
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 68
                                                      },
                                                      "text": "data_batch.label",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 115,
                                                            "column": 52
                                                          },
                                                          "end": {
                                                            "row": 115,
                                                            "column": 62
                                                          },
                                                          "text": "data_batch"
                                                        },
                                                        {
                                                          "type": ".",
                                                          "start": {
                                                            "row": 115,
                                                            "column": 62
                                                          },
                                                          "end": {
                                                            "row": 115,
                                                            "column": 63
                                                          },
                                                          "text": "."
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 115,
                                                            "column": 63
                                                          },
                                                          "end": {
                                                            "row": 115,
                                                            "column": 68
                                                          },
                                                          "text": "label"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": ")",
                                                      "start": {
                                                        "row": 115,
                                                        "column": 68
                                                      },
                                                      "end": {
                                                        "row": 115,
                                                        "column": 69
                                                      },
                                                      "text": ")"
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "try_statement",
                              "start": {
                                "row": 117,
                                "column": 16
                              },
                              "end": {
                                "row": 122,
                                "column": 39
                              },
                              "text": "try:\n                    # pre fetch next batch\n                    next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)\n                except StopIteration:\n                    end_of_batch = True",
                              "children": [
                                {
                                  "type": "try",
                                  "start": {
                                    "row": 117,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 117,
                                    "column": 19
                                  },
                                  "text": "try"
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 117,
                                    "column": 19
                                  },
                                  "end": {
                                    "row": 117,
                                    "column": 20
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "comment",
                                  "start": {
                                    "row": 118,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 118,
                                    "column": 42
                                  },
                                  "text": "# pre fetch next batch"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 119,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 120,
                                    "column": 84
                                  },
                                  "text": "next_data_batch = next(data_iter)\n                    self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 119,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 119,
                                        "column": 53
                                      },
                                      "text": "next_data_batch = next(data_iter)",
                                      "children": [
                                        {
                                          "type": "assignment",
                                          "start": {
                                            "row": 119,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 119,
                                            "column": 53
                                          },
                                          "text": "next_data_batch = next(data_iter)",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 119,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 119,
                                                "column": 35
                                              },
                                              "text": "next_data_batch"
                                            },
                                            {
                                              "type": "=",
                                              "start": {
                                                "row": 119,
                                                "column": 36
                                              },
                                              "end": {
                                                "row": 119,
                                                "column": 37
                                              },
                                              "text": "="
                                            },
                                            {
                                              "type": "call",
                                              "start": {
                                                "row": 119,
                                                "column": 38
                                              },
                                              "end": {
                                                "row": 119,
                                                "column": 53
                                              },
                                              "text": "next(data_iter)",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 119,
                                                    "column": 38
                                                  },
                                                  "end": {
                                                    "row": 119,
                                                    "column": 42
                                                  },
                                                  "text": "next"
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "start": {
                                                    "row": 119,
                                                    "column": 42
                                                  },
                                                  "end": {
                                                    "row": 119,
                                                    "column": 53
                                                  },
                                                  "text": "(data_iter)",
                                                  "children": [
                                                    {
                                                      "type": "(",
                                                      "start": {
                                                        "row": 119,
                                                        "column": 42
                                                      },
                                                      "end": {
                                                        "row": 119,
                                                        "column": 43
                                                      },
                                                      "text": "("
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 119,
                                                        "column": 43
                                                      },
                                                      "end": {
                                                        "row": 119,
                                                        "column": 52
                                                      },
                                                      "text": "data_iter"
                                                    },
                                                    {
                                                      "type": ")",
                                                      "start": {
                                                        "row": 119,
                                                        "column": 52
                                                      },
                                                      "end": {
                                                        "row": 119,
                                                        "column": 53
                                                      },
                                                      "text": ")"
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 120,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 120,
                                        "column": 84
                                      },
                                      "text": "self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)",
                                      "children": [
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 120,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 120,
                                            "column": 84
                                          },
                                          "text": "self.prepare(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)",
                                          "children": [
                                            {
                                              "type": "attribute",
                                              "start": {
                                                "row": 120,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 120,
                                                "column": 32
                                              },
                                              "text": "self.prepare",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 24
                                                  },
                                                  "text": "self"
                                                },
                                                {
                                                  "type": ".",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 24
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 25
                                                  },
                                                  "text": "."
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 25
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 32
                                                  },
                                                  "text": "prepare"
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 120,
                                                "column": 32
                                              },
                                              "end": {
                                                "row": 120,
                                                "column": 84
                                              },
                                              "text": "(next_data_batch, sparse_row_id_fn=sparse_row_id_fn)",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 32
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 33
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 33
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 48
                                                  },
                                                  "text": "next_data_batch"
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 48
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 49
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "keyword_argument",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 50
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 83
                                                  },
                                                  "text": "sparse_row_id_fn=sparse_row_id_fn",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 120,
                                                        "column": 50
                                                      },
                                                      "end": {
                                                        "row": 120,
                                                        "column": 66
                                                      },
                                                      "text": "sparse_row_id_fn"
                                                    },
                                                    {
                                                      "type": "=",
                                                      "start": {
                                                        "row": 120,
                                                        "column": 66
                                                      },
                                                      "end": {
                                                        "row": 120,
                                                        "column": 67
                                                      },
                                                      "text": "="
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 120,
                                                        "column": 67
                                                      },
                                                      "end": {
                                                        "row": 120,
                                                        "column": 83
                                                      },
                                                      "text": "sparse_row_id_fn"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 120,
                                                    "column": 83
                                                  },
                                                  "end": {
                                                    "row": 120,
                                                    "column": 84
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "except_clause",
                                  "start": {
                                    "row": 121,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 122,
                                    "column": 39
                                  },
                                  "text": "except StopIteration:\n                    end_of_batch = True",
                                  "children": [
                                    {
                                      "type": "except",
                                      "start": {
                                        "row": 121,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 121,
                                        "column": 22
                                      },
                                      "text": "except"
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 121,
                                        "column": 23
                                      },
                                      "end": {
                                        "row": 121,
                                        "column": 36
                                      },
                                      "text": "StopIteration"
                                    },
                                    {
                                      "type": ":",
                                      "start": {
                                        "row": 121,
                                        "column": 36
                                      },
                                      "end": {
                                        "row": 121,
                                        "column": 37
                                      },
                                      "text": ":"
                                    },
                                    {
                                      "type": "block",
                                      "start": {
                                        "row": 122,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 122,
                                        "column": 39
                                      },
                                      "text": "end_of_batch = True",
                                      "children": [
                                        {
                                          "type": "expression_statement",
                                          "start": {
                                            "row": 122,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 122,
                                            "column": 39
                                          },
                                          "text": "end_of_batch = True",
                                          "children": [
                                            {
                                              "type": "assignment",
                                              "start": {
                                                "row": 122,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 122,
                                                "column": 39
                                              },
                                              "text": "end_of_batch = True",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 122,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 122,
                                                    "column": 32
                                                  },
                                                  "text": "end_of_batch"
                                                },
                                                {
                                                  "type": "=",
                                                  "start": {
                                                    "row": 122,
                                                    "column": 33
                                                  },
                                                  "end": {
                                                    "row": 122,
                                                    "column": 34
                                                  },
                                                  "text": "="
                                                },
                                                {
                                                  "type": "true",
                                                  "start": {
                                                    "row": 122,
                                                    "column": 35
                                                  },
                                                  "end": {
                                                    "row": 122,
                                                    "column": 39
                                                  },
                                                  "text": "True"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "start": {
                                "row": 124,
                                "column": 16
                              },
                              "end": {
                                "row": 125,
                                "column": 39
                              },
                              "text": "if monitor is not None:\n                    monitor.toc_print()",
                              "children": [
                                {
                                  "type": "if",
                                  "start": {
                                    "row": 124,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 124,
                                    "column": 18
                                  },
                                  "text": "if"
                                },
                                {
                                  "type": "comparison_operator",
                                  "start": {
                                    "row": 124,
                                    "column": 19
                                  },
                                  "end": {
                                    "row": 124,
                                    "column": 38
                                  },
                                  "text": "monitor is not None",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 124,
                                        "column": 19
                                      },
                                      "end": {
                                        "row": 124,
                                        "column": 26
                                      },
                                      "text": "monitor"
                                    },
                                    {
                                      "type": "is not",
                                      "start": {
                                        "row": 124,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 124,
                                        "column": 29
                                      },
                                      "text": "is"
                                    },
                                    {
                                      "type": "is not",
                                      "start": {
                                        "row": 124,
                                        "column": 30
                                      },
                                      "end": {
                                        "row": 124,
                                        "column": 33
                                      },
                                      "text": "not"
                                    },
                                    {
                                      "type": "none",
                                      "start": {
                                        "row": 124,
                                        "column": 34
                                      },
                                      "end": {
                                        "row": 124,
                                        "column": 38
                                      },
                                      "text": "None"
                                    }
                                  ]
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 124,
                                    "column": 38
                                  },
                                  "end": {
                                    "row": 124,
                                    "column": 39
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 125,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 125,
                                    "column": 39
                                  },
                                  "text": "monitor.toc_print()",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 125,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 125,
                                        "column": 39
                                      },
                                      "text": "monitor.toc_print()",
                                      "children": [
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 125,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 125,
                                            "column": 39
                                          },
                                          "text": "monitor.toc_print()",
                                          "children": [
                                            {
                                              "type": "attribute",
                                              "start": {
                                                "row": 125,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 125,
                                                "column": 37
                                              },
                                              "text": "monitor.toc_print",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 125,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 125,
                                                    "column": 27
                                                  },
                                                  "text": "monitor"
                                                },
                                                {
                                                  "type": ".",
                                                  "start": {
                                                    "row": 125,
                                                    "column": 27
                                                  },
                                                  "end": {
                                                    "row": 125,
                                                    "column": 28
                                                  },
                                                  "text": "."
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 125,
                                                    "column": 28
                                                  },
                                                  "end": {
                                                    "row": 125,
                                                    "column": 37
                                                  },
                                                  "text": "toc_print"
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 125,
                                                "column": 37
                                              },
                                              "end": {
                                                "row": 125,
                                                "column": 39
                                              },
                                              "text": "()",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 125,
                                                    "column": 37
                                                  },
                                                  "end": {
                                                    "row": 125,
                                                    "column": 38
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 125,
                                                    "column": 38
                                                  },
                                                  "end": {
                                                    "row": 125,
                                                    "column": 39
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "start": {
                                "row": 127,
                                "column": 16
                              },
                              "end": {
                                "row": 128,
                                "column": 65
                              },
                              "text": "if end_of_batch:\n                    eval_name_vals = eval_metric.get_name_value()",
                              "children": [
                                {
                                  "type": "if",
                                  "start": {
                                    "row": 127,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 127,
                                    "column": 18
                                  },
                                  "text": "if"
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 127,
                                    "column": 19
                                  },
                                  "end": {
                                    "row": 127,
                                    "column": 31
                                  },
                                  "text": "end_of_batch"
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 127,
                                    "column": 31
                                  },
                                  "end": {
                                    "row": 127,
                                    "column": 32
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 128,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 128,
                                    "column": 65
                                  },
                                  "text": "eval_name_vals = eval_metric.get_name_value()",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 128,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 128,
                                        "column": 65
                                      },
                                      "text": "eval_name_vals = eval_metric.get_name_value()",
                                      "children": [
                                        {
                                          "type": "assignment",
                                          "start": {
                                            "row": 128,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 128,
                                            "column": 65
                                          },
                                          "text": "eval_name_vals = eval_metric.get_name_value()",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 128,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 128,
                                                "column": 34
                                              },
                                              "text": "eval_name_vals"
                                            },
                                            {
                                              "type": "=",
                                              "start": {
                                                "row": 128,
                                                "column": 35
                                              },
                                              "end": {
                                                "row": 128,
                                                "column": 36
                                              },
                                              "text": "="
                                            },
                                            {
                                              "type": "call",
                                              "start": {
                                                "row": 128,
                                                "column": 37
                                              },
                                              "end": {
                                                "row": 128,
                                                "column": 65
                                              },
                                              "text": "eval_metric.get_name_value()",
                                              "children": [
                                                {
                                                  "type": "attribute",
                                                  "start": {
                                                    "row": 128,
                                                    "column": 37
                                                  },
                                                  "end": {
                                                    "row": 128,
                                                    "column": 63
                                                  },
                                                  "text": "eval_metric.get_name_value",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 128,
                                                        "column": 37
                                                      },
                                                      "end": {
                                                        "row": 128,
                                                        "column": 48
                                                      },
                                                      "text": "eval_metric"
                                                    },
                                                    {
                                                      "type": ".",
                                                      "start": {
                                                        "row": 128,
                                                        "column": 48
                                                      },
                                                      "end": {
                                                        "row": 128,
                                                        "column": 49
                                                      },
                                                      "text": "."
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 128,
                                                        "column": 49
                                                      },
                                                      "end": {
                                                        "row": 128,
                                                        "column": 63
                                                      },
                                                      "text": "get_name_value"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "start": {
                                                    "row": 128,
                                                    "column": 63
                                                  },
                                                  "end": {
                                                    "row": 128,
                                                    "column": 65
                                                  },
                                                  "text": "()",
                                                  "children": [
                                                    {
                                                      "type": "(",
                                                      "start": {
                                                        "row": 128,
                                                        "column": 63
                                                      },
                                                      "end": {
                                                        "row": 128,
                                                        "column": 64
                                                      },
                                                      "text": "("
                                                    },
                                                    {
                                                      "type": ")",
                                                      "start": {
                                                        "row": 128,
                                                        "column": 64
                                                      },
                                                      "end": {
                                                        "row": 128,
                                                        "column": 65
                                                      },
                                                      "text": ")"
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "start": {
                                "row": 130,
                                "column": 16
                              },
                              "end": {
                                "row": 134,
                                "column": 50
                              },
                              "text": "if batch_end_callback is not None:\n                    batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)",
                              "children": [
                                {
                                  "type": "if",
                                  "start": {
                                    "row": 130,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 130,
                                    "column": 18
                                  },
                                  "text": "if"
                                },
                                {
                                  "type": "comparison_operator",
                                  "start": {
                                    "row": 130,
                                    "column": 19
                                  },
                                  "end": {
                                    "row": 130,
                                    "column": 49
                                  },
                                  "text": "batch_end_callback is not None",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 130,
                                        "column": 19
                                      },
                                      "end": {
                                        "row": 130,
                                        "column": 37
                                      },
                                      "text": "batch_end_callback"
                                    },
                                    {
                                      "type": "is not",
                                      "start": {
                                        "row": 130,
                                        "column": 38
                                      },
                                      "end": {
                                        "row": 130,
                                        "column": 40
                                      },
                                      "text": "is"
                                    },
                                    {
                                      "type": "is not",
                                      "start": {
                                        "row": 130,
                                        "column": 41
                                      },
                                      "end": {
                                        "row": 130,
                                        "column": 44
                                      },
                                      "text": "not"
                                    },
                                    {
                                      "type": "none",
                                      "start": {
                                        "row": 130,
                                        "column": 45
                                      },
                                      "end": {
                                        "row": 130,
                                        "column": 49
                                      },
                                      "text": "None"
                                    }
                                  ]
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 130,
                                    "column": 49
                                  },
                                  "end": {
                                    "row": 130,
                                    "column": 50
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 131,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 134,
                                    "column": 50
                                  },
                                  "text": "batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())\n                    for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 131,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 132,
                                        "column": 103
                                      },
                                      "text": "batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())",
                                      "children": [
                                        {
                                          "type": "assignment",
                                          "start": {
                                            "row": 131,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 132,
                                            "column": 103
                                          },
                                          "text": "batch_end_params = mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 131,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 131,
                                                "column": 36
                                              },
                                              "text": "batch_end_params"
                                            },
                                            {
                                              "type": "=",
                                              "start": {
                                                "row": 131,
                                                "column": 37
                                              },
                                              "end": {
                                                "row": 131,
                                                "column": 38
                                              },
                                              "text": "="
                                            },
                                            {
                                              "type": "call",
                                              "start": {
                                                "row": 131,
                                                "column": 39
                                              },
                                              "end": {
                                                "row": 132,
                                                "column": 103
                                              },
                                              "text": "mx.model.BatchEndParam(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())",
                                              "children": [
                                                {
                                                  "type": "attribute",
                                                  "start": {
                                                    "row": 131,
                                                    "column": 39
                                                  },
                                                  "end": {
                                                    "row": 131,
                                                    "column": 61
                                                  },
                                                  "text": "mx.model.BatchEndParam",
                                                  "children": [
                                                    {
                                                      "type": "attribute",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 39
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 47
                                                      },
                                                      "text": "mx.model",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 39
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 41
                                                          },
                                                          "text": "mx"
                                                        },
                                                        {
                                                          "type": ".",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 41
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 42
                                                          },
                                                          "text": "."
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 42
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 47
                                                          },
                                                          "text": "model"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": ".",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 47
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 48
                                                      },
                                                      "text": "."
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 48
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 61
                                                      },
                                                      "text": "BatchEndParam"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "start": {
                                                    "row": 131,
                                                    "column": 61
                                                  },
                                                  "end": {
                                                    "row": 132,
                                                    "column": 103
                                                  },
                                                  "text": "(epoch=epoch, nbatch=nbatch,\n                                                              eval_metric=eval_metric, locals=locals())",
                                                  "children": [
                                                    {
                                                      "type": "(",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 61
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 62
                                                      },
                                                      "text": "("
                                                    },
                                                    {
                                                      "type": "keyword_argument",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 62
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 73
                                                      },
                                                      "text": "epoch=epoch",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 62
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 67
                                                          },
                                                          "text": "epoch"
                                                        },
                                                        {
                                                          "type": "=",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 67
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 68
                                                          },
                                                          "text": "="
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 68
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 73
                                                          },
                                                          "text": "epoch"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": ",",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 73
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 74
                                                      },
                                                      "text": ","
                                                    },
                                                    {
                                                      "type": "keyword_argument",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 75
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 88
                                                      },
                                                      "text": "nbatch=nbatch",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 75
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 81
                                                          },
                                                          "text": "nbatch"
                                                        },
                                                        {
                                                          "type": "=",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 81
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 82
                                                          },
                                                          "text": "="
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 131,
                                                            "column": 82
                                                          },
                                                          "end": {
                                                            "row": 131,
                                                            "column": 88
                                                          },
                                                          "text": "nbatch"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": ",",
                                                      "start": {
                                                        "row": 131,
                                                        "column": 88
                                                      },
                                                      "end": {
                                                        "row": 131,
                                                        "column": 89
                                                      },
                                                      "text": ","
                                                    },
                                                    {
                                                      "type": "keyword_argument",
                                                      "start": {
                                                        "row": 132,
                                                        "column": 62
                                                      },
                                                      "end": {
                                                        "row": 132,
                                                        "column": 85
                                                      },
                                                      "text": "eval_metric=eval_metric",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 132,
                                                            "column": 62
                                                          },
                                                          "end": {
                                                            "row": 132,
                                                            "column": 73
                                                          },
                                                          "text": "eval_metric"
                                                        },
                                                        {
                                                          "type": "=",
                                                          "start": {
                                                            "row": 132,
                                                            "column": 73
                                                          },
                                                          "end": {
                                                            "row": 132,
                                                            "column": 74
                                                          },
                                                          "text": "="
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 132,
                                                            "column": 74
                                                          },
                                                          "end": {
                                                            "row": 132,
                                                            "column": 85
                                                          },
                                                          "text": "eval_metric"
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": ",",
                                                      "start": {
                                                        "row": 132,
                                                        "column": 85
                                                      },
                                                      "end": {
                                                        "row": 132,
                                                        "column": 86
                                                      },
                                                      "text": ","
                                                    },
                                                    {
                                                      "type": "keyword_argument",
                                                      "start": {
                                                        "row": 132,
                                                        "column": 87
                                                      },
                                                      "end": {
                                                        "row": 132,
                                                        "column": 102
                                                      },
                                                      "text": "locals=locals()",
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 132,
                                                            "column": 87
                                                          },
                                                          "end": {
                                                            "row": 132,
                                                            "column": 93
                                                          },
                                                          "text": "locals"
                                                        },
                                                        {
                                                          "type": "=",
                                                          "start": {
                                                            "row": 132,
                                                            "column": 93
                                                          },
                                                          "end": {
                                                            "row": 132,
                                                            "column": 94
                                                          },
                                                          "text": "="
                                                        },
                                                        {
                                                          "type": "call",
                                                          "start": {
                                                            "row": 132,
                                                            "column": 94
                                                          },
                                                          "end": {
                                                            "row": 132,
                                                            "column": 102
                                                          },
                                                          "text": "locals()",
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "start": {
                                                                "row": 132,
                                                                "column": 94
                                                              },
                                                              "end": {
                                                                "row": 132,
                                                                "column": 100
                                                              },
                                                              "text": "locals"
                                                            },
                                                            {
                                                              "type": "argument_list",
                                                              "start": {
                                                                "row": 132,
                                                                "column": 100
                                                              },
                                                              "end": {
                                                                "row": 132,
                                                                "column": 102
                                                              },
                                                              "text": "()",
                                                              "children": [
                                                                {
                                                                  "type": "(",
                                                                  "start": {
                                                                    "row": 132,
                                                                    "column": 100
                                                                  },
                                                                  "end": {
                                                                    "row": 132,
                                                                    "column": 101
                                                                  },
                                                                  "text": "("
                                                                },
                                                                {
                                                                  "type": ")",
                                                                  "start": {
                                                                    "row": 132,
                                                                    "column": 101
                                                                  },
                                                                  "end": {
                                                                    "row": 132,
                                                                    "column": 102
                                                                  },
                                                                  "text": ")"
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": ")",
                                                      "start": {
                                                        "row": 132,
                                                        "column": 102
                                                      },
                                                      "end": {
                                                        "row": 132,
                                                        "column": 103
                                                      },
                                                      "text": ")"
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "for_statement",
                                      "start": {
                                        "row": 133,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 134,
                                        "column": 50
                                      },
                                      "text": "for callback in mx.base._as_list(batch_end_callback):\n                        callback(batch_end_params)",
                                      "children": [
                                        {
                                          "type": "for",
                                          "start": {
                                            "row": 133,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 133,
                                            "column": 23
                                          },
                                          "text": "for"
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 133,
                                            "column": 24
                                          },
                                          "end": {
                                            "row": 133,
                                            "column": 32
                                          },
                                          "text": "callback"
                                        },
                                        {
                                          "type": "in",
                                          "start": {
                                            "row": 133,
                                            "column": 33
                                          },
                                          "end": {
                                            "row": 133,
                                            "column": 35
                                          },
                                          "text": "in"
                                        },
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 133,
                                            "column": 36
                                          },
                                          "end": {
                                            "row": 133,
                                            "column": 72
                                          },
                                          "text": "mx.base._as_list(batch_end_callback)",
                                          "children": [
                                            {
                                              "type": "attribute",
                                              "start": {
                                                "row": 133,
                                                "column": 36
                                              },
                                              "end": {
                                                "row": 133,
                                                "column": 52
                                              },
                                              "text": "mx.base._as_list",
                                              "children": [
                                                {
                                                  "type": "attribute",
                                                  "start": {
                                                    "row": 133,
                                                    "column": 36
                                                  },
                                                  "end": {
                                                    "row": 133,
                                                    "column": 43
                                                  },
                                                  "text": "mx.base",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 133,
                                                        "column": 36
                                                      },
                                                      "end": {
                                                        "row": 133,
                                                        "column": 38
                                                      },
                                                      "text": "mx"
                                                    },
                                                    {
                                                      "type": ".",
                                                      "start": {
                                                        "row": 133,
                                                        "column": 38
                                                      },
                                                      "end": {
                                                        "row": 133,
                                                        "column": 39
                                                      },
                                                      "text": "."
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 133,
                                                        "column": 39
                                                      },
                                                      "end": {
                                                        "row": 133,
                                                        "column": 43
                                                      },
                                                      "text": "base"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ".",
                                                  "start": {
                                                    "row": 133,
                                                    "column": 43
                                                  },
                                                  "end": {
                                                    "row": 133,
                                                    "column": 44
                                                  },
                                                  "text": "."
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 133,
                                                    "column": 44
                                                  },
                                                  "end": {
                                                    "row": 133,
                                                    "column": 52
                                                  },
                                                  "text": "_as_list"
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 133,
                                                "column": 52
                                              },
                                              "end": {
                                                "row": 133,
                                                "column": 72
                                              },
                                              "text": "(batch_end_callback)",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 133,
                                                    "column": 52
                                                  },
                                                  "end": {
                                                    "row": 133,
                                                    "column": 53
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 133,
                                                    "column": 53
                                                  },
                                                  "end": {
                                                    "row": 133,
                                                    "column": 71
                                                  },
                                                  "text": "batch_end_callback"
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 133,
                                                    "column": 71
                                                  },
                                                  "end": {
                                                    "row": 133,
                                                    "column": 72
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": ":",
                                          "start": {
                                            "row": 133,
                                            "column": 72
                                          },
                                          "end": {
                                            "row": 133,
                                            "column": 73
                                          },
                                          "text": ":"
                                        },
                                        {
                                          "type": "block",
                                          "start": {
                                            "row": 134,
                                            "column": 24
                                          },
                                          "end": {
                                            "row": 134,
                                            "column": 50
                                          },
                                          "text": "callback(batch_end_params)",
                                          "children": [
                                            {
                                              "type": "expression_statement",
                                              "start": {
                                                "row": 134,
                                                "column": 24
                                              },
                                              "end": {
                                                "row": 134,
                                                "column": 50
                                              },
                                              "text": "callback(batch_end_params)",
                                              "children": [
                                                {
                                                  "type": "call",
                                                  "start": {
                                                    "row": 134,
                                                    "column": 24
                                                  },
                                                  "end": {
                                                    "row": 134,
                                                    "column": 50
                                                  },
                                                  "text": "callback(batch_end_params)",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 134,
                                                        "column": 24
                                                      },
                                                      "end": {
                                                        "row": 134,
                                                        "column": 32
                                                      },
                                                      "text": "callback"
                                                    },
                                                    {
                                                      "type": "argument_list",
                                                      "start": {
                                                        "row": 134,
                                                        "column": 32
                                                      },
                                                      "end": {
                                                        "row": 134,
                                                        "column": 50
                                                      },
                                                      "text": "(batch_end_params)",
                                                      "children": [
                                                        {
                                                          "type": "(",
                                                          "start": {
                                                            "row": 134,
                                                            "column": 32
                                                          },
                                                          "end": {
                                                            "row": 134,
                                                            "column": 33
                                                          },
                                                          "text": "("
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "start": {
                                                            "row": 134,
                                                            "column": 33
                                                          },
                                                          "end": {
                                                            "row": 134,
                                                            "column": 49
                                                          },
                                                          "text": "batch_end_params"
                                                        },
                                                        {
                                                          "type": ")",
                                                          "start": {
                                                            "row": 134,
                                                            "column": 49
                                                          },
                                                          "end": {
                                                            "row": 134,
                                                            "column": 50
                                                          },
                                                          "text": ")"
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 136,
                                "column": 16
                              },
                              "end": {
                                "row": 136,
                                "column": 27
                              },
                              "text": "nbatch += 1",
                              "children": [
                                {
                                  "type": "augmented_assignment",
                                  "start": {
                                    "row": 136,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 136,
                                    "column": 27
                                  },
                                  "text": "nbatch += 1",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 136,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 136,
                                        "column": 22
                                      },
                                      "text": "nbatch"
                                    },
                                    {
                                      "type": "+=",
                                      "start": {
                                        "row": 136,
                                        "column": 23
                                      },
                                      "end": {
                                        "row": 136,
                                        "column": 25
                                      },
                                      "text": "+="
                                    },
                                    {
                                      "type": "integer",
                                      "start": {
                                        "row": 136,
                                        "column": 26
                                      },
                                      "end": {
                                        "row": 136,
                                        "column": 27
                                      },
                                      "text": "1"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "for_statement",
                      "start": {
                        "row": 137,
                        "column": 12
                      },
                      "end": {
                        "row": 138,
                        "column": 75
                      },
                      "text": "for name, val in eval_name_vals:\n                self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)",
                      "children": [
                        {
                          "type": "for",
                          "start": {
                            "row": 137,
                            "column": 12
                          },
                          "end": {
                            "row": 137,
                            "column": 15
                          },
                          "text": "for"
                        },
                        {
                          "type": "pattern_list",
                          "start": {
                            "row": 137,
                            "column": 16
                          },
                          "end": {
                            "row": 137,
                            "column": 25
                          },
                          "text": "name, val",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 137,
                                "column": 16
                              },
                              "end": {
                                "row": 137,
                                "column": 20
                              },
                              "text": "name"
                            },
                            {
                              "type": ",",
                              "start": {
                                "row": 137,
                                "column": 20
                              },
                              "end": {
                                "row": 137,
                                "column": 21
                              },
                              "text": ","
                            },
                            {
                              "type": "identifier",
                              "start": {
                                "row": 137,
                                "column": 22
                              },
                              "end": {
                                "row": 137,
                                "column": 25
                              },
                              "text": "val"
                            }
                          ]
                        },
                        {
                          "type": "in",
                          "start": {
                            "row": 137,
                            "column": 26
                          },
                          "end": {
                            "row": 137,
                            "column": 28
                          },
                          "text": "in"
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 137,
                            "column": 29
                          },
                          "end": {
                            "row": 137,
                            "column": 43
                          },
                          "text": "eval_name_vals"
                        },
                        {
                          "type": ":",
                          "start": {
                            "row": 137,
                            "column": 43
                          },
                          "end": {
                            "row": 137,
                            "column": 44
                          },
                          "text": ":"
                        },
                        {
                          "type": "block",
                          "start": {
                            "row": 138,
                            "column": 16
                          },
                          "end": {
                            "row": 138,
                            "column": 75
                          },
                          "text": "self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)",
                          "children": [
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 138,
                                "column": 16
                              },
                              "end": {
                                "row": 138,
                                "column": 75
                              },
                              "text": "self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)",
                              "children": [
                                {
                                  "type": "call",
                                  "start": {
                                    "row": 138,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 138,
                                    "column": 75
                                  },
                                  "text": "self.logger.info('Epoch[%d] Train-%s=%f', epoch, name, val)",
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "start": {
                                        "row": 138,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 138,
                                        "column": 32
                                      },
                                      "text": "self.logger.info",
                                      "children": [
                                        {
                                          "type": "attribute",
                                          "start": {
                                            "row": 138,
                                            "column": 16
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 27
                                          },
                                          "text": "self.logger",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 138,
                                                "column": 16
                                              },
                                              "end": {
                                                "row": 138,
                                                "column": 20
                                              },
                                              "text": "self"
                                            },
                                            {
                                              "type": ".",
                                              "start": {
                                                "row": 138,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 138,
                                                "column": 21
                                              },
                                              "text": "."
                                            },
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 138,
                                                "column": 21
                                              },
                                              "end": {
                                                "row": 138,
                                                "column": 27
                                              },
                                              "text": "logger"
                                            }
                                          ]
                                        },
                                        {
                                          "type": ".",
                                          "start": {
                                            "row": 138,
                                            "column": 27
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 28
                                          },
                                          "text": "."
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 138,
                                            "column": 28
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 32
                                          },
                                          "text": "info"
                                        }
                                      ]
                                    },
                                    {
                                      "type": "argument_list",
                                      "start": {
                                        "row": 138,
                                        "column": 32
                                      },
                                      "end": {
                                        "row": 138,
                                        "column": 75
                                      },
                                      "text": "('Epoch[%d] Train-%s=%f', epoch, name, val)",
                                      "children": [
                                        {
                                          "type": "(",
                                          "start": {
                                            "row": 138,
                                            "column": 32
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 33
                                          },
                                          "text": "("
                                        },
                                        {
                                          "type": "string",
                                          "start": {
                                            "row": 138,
                                            "column": 33
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 56
                                          },
                                          "text": "'Epoch[%d] Train-%s=%f'",
                                          "children": [
                                            {
                                              "type": "string_start",
                                              "start": {
                                                "row": 138,
                                                "column": 33
                                              },
                                              "end": {
                                                "row": 138,
                                                "column": 34
                                              },
                                              "text": "'"
                                            },
                                            {
                                              "type": "string_content",
                                              "start": {
                                                "row": 138,
                                                "column": 34
                                              },
                                              "end": {
                                                "row": 138,
                                                "column": 55
                                              },
                                              "text": "Epoch[%d] Train-%s=%f"
                                            },
                                            {
                                              "type": "string_end",
                                              "start": {
                                                "row": 138,
                                                "column": 55
                                              },
                                              "end": {
                                                "row": 138,
                                                "column": 56
                                              },
                                              "text": "'"
                                            }
                                          ]
                                        },
                                        {
                                          "type": ",",
                                          "start": {
                                            "row": 138,
                                            "column": 56
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 57
                                          },
                                          "text": ","
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 138,
                                            "column": 58
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 63
                                          },
                                          "text": "epoch"
                                        },
                                        {
                                          "type": ",",
                                          "start": {
                                            "row": 138,
                                            "column": 63
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 64
                                          },
                                          "text": ","
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 138,
                                            "column": 65
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 69
                                          },
                                          "text": "name"
                                        },
                                        {
                                          "type": ",",
                                          "start": {
                                            "row": 138,
                                            "column": 69
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 70
                                          },
                                          "text": ","
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 138,
                                            "column": 71
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 74
                                          },
                                          "text": "val"
                                        },
                                        {
                                          "type": ")",
                                          "start": {
                                            "row": 138,
                                            "column": 74
                                          },
                                          "end": {
                                            "row": 138,
                                            "column": 75
                                          },
                                          "text": ")"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 139,
                        "column": 12
                      },
                      "end": {
                        "row": 139,
                        "column": 29
                      },
                      "text": "toc = time.time()",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 139,
                            "column": 12
                          },
                          "end": {
                            "row": 139,
                            "column": 29
                          },
                          "text": "toc = time.time()",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 139,
                                "column": 12
                              },
                              "end": {
                                "row": 139,
                                "column": 15
                              },
                              "text": "toc"
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 139,
                                "column": 16
                              },
                              "end": {
                                "row": 139,
                                "column": 17
                              },
                              "text": "="
                            },
                            {
                              "type": "call",
                              "start": {
                                "row": 139,
                                "column": 18
                              },
                              "end": {
                                "row": 139,
                                "column": 29
                              },
                              "text": "time.time()",
                              "children": [
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 139,
                                    "column": 18
                                  },
                                  "end": {
                                    "row": 139,
                                    "column": 27
                                  },
                                  "text": "time.time",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 139,
                                        "column": 18
                                      },
                                      "end": {
                                        "row": 139,
                                        "column": 22
                                      },
                                      "text": "time"
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 139,
                                        "column": 22
                                      },
                                      "end": {
                                        "row": 139,
                                        "column": 23
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 139,
                                        "column": 23
                                      },
                                      "end": {
                                        "row": 139,
                                        "column": 27
                                      },
                                      "text": "time"
                                    }
                                  ]
                                },
                                {
                                  "type": "argument_list",
                                  "start": {
                                    "row": 139,
                                    "column": 27
                                  },
                                  "end": {
                                    "row": 139,
                                    "column": 29
                                  },
                                  "text": "()",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 139,
                                        "column": 27
                                      },
                                      "end": {
                                        "row": 139,
                                        "column": 28
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 139,
                                        "column": 28
                                      },
                                      "end": {
                                        "row": 139,
                                        "column": 29
                                      },
                                      "text": ")"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 140,
                        "column": 12
                      },
                      "end": {
                        "row": 140,
                        "column": 76
                      },
                      "text": "self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 140,
                            "column": 12
                          },
                          "end": {
                            "row": 140,
                            "column": 76
                          },
                          "text": "self.logger.info('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))",
                          "children": [
                            {
                              "type": "attribute",
                              "start": {
                                "row": 140,
                                "column": 12
                              },
                              "end": {
                                "row": 140,
                                "column": 28
                              },
                              "text": "self.logger.info",
                              "children": [
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 140,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 23
                                  },
                                  "text": "self.logger",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 140,
                                        "column": 12
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 16
                                      },
                                      "text": "self"
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 140,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 17
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 140,
                                        "column": 17
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 23
                                      },
                                      "text": "logger"
                                    }
                                  ]
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 140,
                                    "column": 23
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 24
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 140,
                                    "column": 24
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 28
                                  },
                                  "text": "info"
                                }
                              ]
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 140,
                                "column": 28
                              },
                              "end": {
                                "row": 140,
                                "column": 76
                              },
                              "text": "('Epoch[%d] Time cost=%.3f', epoch, (toc - tic))",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 140,
                                    "column": 28
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 29
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "string",
                                  "start": {
                                    "row": 140,
                                    "column": 29
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 55
                                  },
                                  "text": "'Epoch[%d] Time cost=%.3f'",
                                  "children": [
                                    {
                                      "type": "string_start",
                                      "start": {
                                        "row": 140,
                                        "column": 29
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 30
                                      },
                                      "text": "'"
                                    },
                                    {
                                      "type": "string_content",
                                      "start": {
                                        "row": 140,
                                        "column": 30
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 54
                                      },
                                      "text": "Epoch[%d] Time cost=%.3f"
                                    },
                                    {
                                      "type": "string_end",
                                      "start": {
                                        "row": 140,
                                        "column": 54
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 55
                                      },
                                      "text": "'"
                                    }
                                  ]
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 140,
                                    "column": 55
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 56
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 140,
                                    "column": 57
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 62
                                  },
                                  "text": "epoch"
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 140,
                                    "column": 62
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 63
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "parenthesized_expression",
                                  "start": {
                                    "row": 140,
                                    "column": 64
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 75
                                  },
                                  "text": "(toc - tic)",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 140,
                                        "column": 64
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 65
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": "binary_operator",
                                      "start": {
                                        "row": 140,
                                        "column": 65
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 74
                                      },
                                      "text": "toc - tic",
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 140,
                                            "column": 65
                                          },
                                          "end": {
                                            "row": 140,
                                            "column": 68
                                          },
                                          "text": "toc"
                                        },
                                        {
                                          "type": "-",
                                          "start": {
                                            "row": 140,
                                            "column": 69
                                          },
                                          "end": {
                                            "row": 140,
                                            "column": 70
                                          },
                                          "text": "-"
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 140,
                                            "column": 71
                                          },
                                          "end": {
                                            "row": 140,
                                            "column": 74
                                          },
                                          "text": "tic"
                                        }
                                      ]
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 140,
                                        "column": 74
                                      },
                                      "end": {
                                        "row": 140,
                                        "column": 75
                                      },
                                      "text": ")"
                                    }
                                  ]
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 140,
                                    "column": 75
                                  },
                                  "end": {
                                    "row": 140,
                                    "column": 76
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "comment",
                      "start": {
                        "row": 142,
                        "column": 12
                      },
                      "end": {
                        "row": 142,
                        "column": 44
                      },
                      "text": "# sync aux params across devices"
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 143,
                        "column": 12
                      },
                      "end": {
                        "row": 143,
                        "column": 54
                      },
                      "text": "arg_params, aux_params = self.get_params()",
                      "children": [
                        {
                          "type": "assignment",
                          "start": {
                            "row": 143,
                            "column": 12
                          },
                          "end": {
                            "row": 143,
                            "column": 54
                          },
                          "text": "arg_params, aux_params = self.get_params()",
                          "children": [
                            {
                              "type": "pattern_list",
                              "start": {
                                "row": 143,
                                "column": 12
                              },
                              "end": {
                                "row": 143,
                                "column": 34
                              },
                              "text": "arg_params, aux_params",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 143,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 143,
                                    "column": 22
                                  },
                                  "text": "arg_params"
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 143,
                                    "column": 22
                                  },
                                  "end": {
                                    "row": 143,
                                    "column": 23
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 143,
                                    "column": 24
                                  },
                                  "end": {
                                    "row": 143,
                                    "column": 34
                                  },
                                  "text": "aux_params"
                                }
                              ]
                            },
                            {
                              "type": "=",
                              "start": {
                                "row": 143,
                                "column": 35
                              },
                              "end": {
                                "row": 143,
                                "column": 36
                              },
                              "text": "="
                            },
                            {
                              "type": "call",
                              "start": {
                                "row": 143,
                                "column": 37
                              },
                              "end": {
                                "row": 143,
                                "column": 54
                              },
                              "text": "self.get_params()",
                              "children": [
                                {
                                  "type": "attribute",
                                  "start": {
                                    "row": 143,
                                    "column": 37
                                  },
                                  "end": {
                                    "row": 143,
                                    "column": 52
                                  },
                                  "text": "self.get_params",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 143,
                                        "column": 37
                                      },
                                      "end": {
                                        "row": 143,
                                        "column": 41
                                      },
                                      "text": "self"
                                    },
                                    {
                                      "type": ".",
                                      "start": {
                                        "row": 143,
                                        "column": 41
                                      },
                                      "end": {
                                        "row": 143,
                                        "column": 42
                                      },
                                      "text": "."
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 143,
                                        "column": 42
                                      },
                                      "end": {
                                        "row": 143,
                                        "column": 52
                                      },
                                      "text": "get_params"
                                    }
                                  ]
                                },
                                {
                                  "type": "argument_list",
                                  "start": {
                                    "row": 143,
                                    "column": 52
                                  },
                                  "end": {
                                    "row": 143,
                                    "column": 54
                                  },
                                  "text": "()",
                                  "children": [
                                    {
                                      "type": "(",
                                      "start": {
                                        "row": 143,
                                        "column": 52
                                      },
                                      "end": {
                                        "row": 143,
                                        "column": 53
                                      },
                                      "text": "("
                                    },
                                    {
                                      "type": ")",
                                      "start": {
                                        "row": 143,
                                        "column": 53
                                      },
                                      "end": {
                                        "row": 143,
                                        "column": 54
                                      },
                                      "text": ")"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "expression_statement",
                      "start": {
                        "row": 144,
                        "column": 12
                      },
                      "end": {
                        "row": 144,
                        "column": 51
                      },
                      "text": "self.set_params(arg_params, aux_params)",
                      "children": [
                        {
                          "type": "call",
                          "start": {
                            "row": 144,
                            "column": 12
                          },
                          "end": {
                            "row": 144,
                            "column": 51
                          },
                          "text": "self.set_params(arg_params, aux_params)",
                          "children": [
                            {
                              "type": "attribute",
                              "start": {
                                "row": 144,
                                "column": 12
                              },
                              "end": {
                                "row": 144,
                                "column": 27
                              },
                              "text": "self.set_params",
                              "children": [
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 144,
                                    "column": 12
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 16
                                  },
                                  "text": "self"
                                },
                                {
                                  "type": ".",
                                  "start": {
                                    "row": 144,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 17
                                  },
                                  "text": "."
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 144,
                                    "column": 17
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 27
                                  },
                                  "text": "set_params"
                                }
                              ]
                            },
                            {
                              "type": "argument_list",
                              "start": {
                                "row": 144,
                                "column": 27
                              },
                              "end": {
                                "row": 144,
                                "column": 51
                              },
                              "text": "(arg_params, aux_params)",
                              "children": [
                                {
                                  "type": "(",
                                  "start": {
                                    "row": 144,
                                    "column": 27
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 28
                                  },
                                  "text": "("
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 144,
                                    "column": 28
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 38
                                  },
                                  "text": "arg_params"
                                },
                                {
                                  "type": ",",
                                  "start": {
                                    "row": 144,
                                    "column": 38
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 39
                                  },
                                  "text": ","
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 144,
                                    "column": 40
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 50
                                  },
                                  "text": "aux_params"
                                },
                                {
                                  "type": ")",
                                  "start": {
                                    "row": 144,
                                    "column": 50
                                  },
                                  "end": {
                                    "row": 144,
                                    "column": 51
                                  },
                                  "text": ")"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "if_statement",
                      "start": {
                        "row": 146,
                        "column": 12
                      },
                      "end": {
                        "row": 148,
                        "column": 72
                      },
                      "text": "if epoch_end_callback is not None:\n                for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)",
                      "children": [
                        {
                          "type": "if",
                          "start": {
                            "row": 146,
                            "column": 12
                          },
                          "end": {
                            "row": 146,
                            "column": 14
                          },
                          "text": "if"
                        },
                        {
                          "type": "comparison_operator",
                          "start": {
                            "row": 146,
                            "column": 15
                          },
                          "end": {
                            "row": 146,
                            "column": 45
                          },
                          "text": "epoch_end_callback is not None",
                          "children": [
                            {
                              "type": "identifier",
                              "start": {
                                "row": 146,
                                "column": 15
                              },
                              "end": {
                                "row": 146,
                                "column": 33
                              },
                              "text": "epoch_end_callback"
                            },
                            {
                              "type": "is not",
                              "start": {
                                "row": 146,
                                "column": 34
                              },
                              "end": {
                                "row": 146,
                                "column": 36
                              },
                              "text": "is"
                            },
                            {
                              "type": "is not",
                              "start": {
                                "row": 146,
                                "column": 37
                              },
                              "end": {
                                "row": 146,
                                "column": 40
                              },
                              "text": "not"
                            },
                            {
                              "type": "none",
                              "start": {
                                "row": 146,
                                "column": 41
                              },
                              "end": {
                                "row": 146,
                                "column": 45
                              },
                              "text": "None"
                            }
                          ]
                        },
                        {
                          "type": ":",
                          "start": {
                            "row": 146,
                            "column": 45
                          },
                          "end": {
                            "row": 146,
                            "column": 46
                          },
                          "text": ":"
                        },
                        {
                          "type": "block",
                          "start": {
                            "row": 147,
                            "column": 16
                          },
                          "end": {
                            "row": 148,
                            "column": 72
                          },
                          "text": "for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)",
                          "children": [
                            {
                              "type": "for_statement",
                              "start": {
                                "row": 147,
                                "column": 16
                              },
                              "end": {
                                "row": 148,
                                "column": 72
                              },
                              "text": "for callback in mx.base._as_list(epoch_end_callback):\n                    callback(epoch, self.symbol, arg_params, aux_params)",
                              "children": [
                                {
                                  "type": "for",
                                  "start": {
                                    "row": 147,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 147,
                                    "column": 19
                                  },
                                  "text": "for"
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 147,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 147,
                                    "column": 28
                                  },
                                  "text": "callback"
                                },
                                {
                                  "type": "in",
                                  "start": {
                                    "row": 147,
                                    "column": 29
                                  },
                                  "end": {
                                    "row": 147,
                                    "column": 31
                                  },
                                  "text": "in"
                                },
                                {
                                  "type": "call",
                                  "start": {
                                    "row": 147,
                                    "column": 32
                                  },
                                  "end": {
                                    "row": 147,
                                    "column": 68
                                  },
                                  "text": "mx.base._as_list(epoch_end_callback)",
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "start": {
                                        "row": 147,
                                        "column": 32
                                      },
                                      "end": {
                                        "row": 147,
                                        "column": 48
                                      },
                                      "text": "mx.base._as_list",
                                      "children": [
                                        {
                                          "type": "attribute",
                                          "start": {
                                            "row": 147,
                                            "column": 32
                                          },
                                          "end": {
                                            "row": 147,
                                            "column": 39
                                          },
                                          "text": "mx.base",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 147,
                                                "column": 32
                                              },
                                              "end": {
                                                "row": 147,
                                                "column": 34
                                              },
                                              "text": "mx"
                                            },
                                            {
                                              "type": ".",
                                              "start": {
                                                "row": 147,
                                                "column": 34
                                              },
                                              "end": {
                                                "row": 147,
                                                "column": 35
                                              },
                                              "text": "."
                                            },
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 147,
                                                "column": 35
                                              },
                                              "end": {
                                                "row": 147,
                                                "column": 39
                                              },
                                              "text": "base"
                                            }
                                          ]
                                        },
                                        {
                                          "type": ".",
                                          "start": {
                                            "row": 147,
                                            "column": 39
                                          },
                                          "end": {
                                            "row": 147,
                                            "column": 40
                                          },
                                          "text": "."
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 147,
                                            "column": 40
                                          },
                                          "end": {
                                            "row": 147,
                                            "column": 48
                                          },
                                          "text": "_as_list"
                                        }
                                      ]
                                    },
                                    {
                                      "type": "argument_list",
                                      "start": {
                                        "row": 147,
                                        "column": 48
                                      },
                                      "end": {
                                        "row": 147,
                                        "column": 68
                                      },
                                      "text": "(epoch_end_callback)",
                                      "children": [
                                        {
                                          "type": "(",
                                          "start": {
                                            "row": 147,
                                            "column": 48
                                          },
                                          "end": {
                                            "row": 147,
                                            "column": 49
                                          },
                                          "text": "("
                                        },
                                        {
                                          "type": "identifier",
                                          "start": {
                                            "row": 147,
                                            "column": 49
                                          },
                                          "end": {
                                            "row": 147,
                                            "column": 67
                                          },
                                          "text": "epoch_end_callback"
                                        },
                                        {
                                          "type": ")",
                                          "start": {
                                            "row": 147,
                                            "column": 67
                                          },
                                          "end": {
                                            "row": 147,
                                            "column": 68
                                          },
                                          "text": ")"
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 147,
                                    "column": 68
                                  },
                                  "end": {
                                    "row": 147,
                                    "column": 69
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 148,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 148,
                                    "column": 72
                                  },
                                  "text": "callback(epoch, self.symbol, arg_params, aux_params)",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 148,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 148,
                                        "column": 72
                                      },
                                      "text": "callback(epoch, self.symbol, arg_params, aux_params)",
                                      "children": [
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 148,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 148,
                                            "column": 72
                                          },
                                          "text": "callback(epoch, self.symbol, arg_params, aux_params)",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 148,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 148,
                                                "column": 28
                                              },
                                              "text": "callback"
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 148,
                                                "column": 28
                                              },
                                              "end": {
                                                "row": 148,
                                                "column": 72
                                              },
                                              "text": "(epoch, self.symbol, arg_params, aux_params)",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 28
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 29
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 29
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 34
                                                  },
                                                  "text": "epoch"
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 34
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 35
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "attribute",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 36
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 47
                                                  },
                                                  "text": "self.symbol",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 148,
                                                        "column": 36
                                                      },
                                                      "end": {
                                                        "row": 148,
                                                        "column": 40
                                                      },
                                                      "text": "self"
                                                    },
                                                    {
                                                      "type": ".",
                                                      "start": {
                                                        "row": 148,
                                                        "column": 40
                                                      },
                                                      "end": {
                                                        "row": 148,
                                                        "column": 41
                                                      },
                                                      "text": "."
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 148,
                                                        "column": 41
                                                      },
                                                      "end": {
                                                        "row": 148,
                                                        "column": 47
                                                      },
                                                      "text": "symbol"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 47
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 48
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 49
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 59
                                                  },
                                                  "text": "arg_params"
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 59
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 60
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 61
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 71
                                                  },
                                                  "text": "aux_params"
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 148,
                                                    "column": 71
                                                  },
                                                  "end": {
                                                    "row": 148,
                                                    "column": 72
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "comment",
                      "start": {
                        "row": 150,
                        "column": 12
                      },
                      "end": {
                        "row": 150,
                        "column": 54
                      },
                      "text": "# ----------------------------------------"
                    },
                    {
                      "type": "comment",
                      "start": {
                        "row": 151,
                        "column": 12
                      },
                      "end": {
                        "row": 151,
                        "column": 42
                      },
                      "text": "# evaluation on validation set"
                    },
                    {
                      "type": "if_statement",
                      "start": {
                        "row": 152,
                        "column": 12
                      },
                      "end": {
                        "row": 157,
                        "column": 84
                      },
                      "text": "if eval_data:\n                res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                      "children": [
                        {
                          "type": "if",
                          "start": {
                            "row": 152,
                            "column": 12
                          },
                          "end": {
                            "row": 152,
                            "column": 14
                          },
                          "text": "if"
                        },
                        {
                          "type": "identifier",
                          "start": {
                            "row": 152,
                            "column": 15
                          },
                          "end": {
                            "row": 152,
                            "column": 24
                          },
                          "text": "eval_data"
                        },
                        {
                          "type": ":",
                          "start": {
                            "row": 152,
                            "column": 24
                          },
                          "end": {
                            "row": 152,
                            "column": 25
                          },
                          "text": ":"
                        },
                        {
                          "type": "block",
                          "start": {
                            "row": 153,
                            "column": 16
                          },
                          "end": {
                            "row": 157,
                            "column": 84
                          },
                          "text": "res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)\n                for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                          "children": [
                            {
                              "type": "expression_statement",
                              "start": {
                                "row": 153,
                                "column": 16
                              },
                              "end": {
                                "row": 155,
                                "column": 89
                              },
                              "text": "res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)",
                              "children": [
                                {
                                  "type": "assignment",
                                  "start": {
                                    "row": 153,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 155,
                                    "column": 89
                                  },
                                  "text": "res = self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 153,
                                        "column": 16
                                      },
                                      "end": {
                                        "row": 153,
                                        "column": 19
                                      },
                                      "text": "res"
                                    },
                                    {
                                      "type": "=",
                                      "start": {
                                        "row": 153,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 153,
                                        "column": 21
                                      },
                                      "text": "="
                                    },
                                    {
                                      "type": "call",
                                      "start": {
                                        "row": 153,
                                        "column": 22
                                      },
                                      "end": {
                                        "row": 155,
                                        "column": 89
                                      },
                                      "text": "self.score(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)",
                                      "children": [
                                        {
                                          "type": "attribute",
                                          "start": {
                                            "row": 153,
                                            "column": 22
                                          },
                                          "end": {
                                            "row": 153,
                                            "column": 32
                                          },
                                          "text": "self.score",
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 153,
                                                "column": 22
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 26
                                              },
                                              "text": "self"
                                            },
                                            {
                                              "type": ".",
                                              "start": {
                                                "row": 153,
                                                "column": 26
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 27
                                              },
                                              "text": "."
                                            },
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 153,
                                                "column": 27
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 32
                                              },
                                              "text": "score"
                                            }
                                          ]
                                        },
                                        {
                                          "type": "argument_list",
                                          "start": {
                                            "row": 153,
                                            "column": 32
                                          },
                                          "end": {
                                            "row": 155,
                                            "column": 89
                                          },
                                          "text": "(eval_data, validation_metric,\n                                 score_end_callback=eval_end_callback,\n                                 batch_end_callback=eval_batch_end_callback, epoch=epoch)",
                                          "children": [
                                            {
                                              "type": "(",
                                              "start": {
                                                "row": 153,
                                                "column": 32
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 33
                                              },
                                              "text": "("
                                            },
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 153,
                                                "column": 33
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 42
                                              },
                                              "text": "eval_data"
                                            },
                                            {
                                              "type": ",",
                                              "start": {
                                                "row": 153,
                                                "column": 42
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 43
                                              },
                                              "text": ","
                                            },
                                            {
                                              "type": "identifier",
                                              "start": {
                                                "row": 153,
                                                "column": 44
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 61
                                              },
                                              "text": "validation_metric"
                                            },
                                            {
                                              "type": ",",
                                              "start": {
                                                "row": 153,
                                                "column": 61
                                              },
                                              "end": {
                                                "row": 153,
                                                "column": 62
                                              },
                                              "text": ","
                                            },
                                            {
                                              "type": "keyword_argument",
                                              "start": {
                                                "row": 154,
                                                "column": 33
                                              },
                                              "end": {
                                                "row": 154,
                                                "column": 69
                                              },
                                              "text": "score_end_callback=eval_end_callback",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 154,
                                                    "column": 33
                                                  },
                                                  "end": {
                                                    "row": 154,
                                                    "column": 51
                                                  },
                                                  "text": "score_end_callback"
                                                },
                                                {
                                                  "type": "=",
                                                  "start": {
                                                    "row": 154,
                                                    "column": 51
                                                  },
                                                  "end": {
                                                    "row": 154,
                                                    "column": 52
                                                  },
                                                  "text": "="
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 154,
                                                    "column": 52
                                                  },
                                                  "end": {
                                                    "row": 154,
                                                    "column": 69
                                                  },
                                                  "text": "eval_end_callback"
                                                }
                                              ]
                                            },
                                            {
                                              "type": ",",
                                              "start": {
                                                "row": 154,
                                                "column": 69
                                              },
                                              "end": {
                                                "row": 154,
                                                "column": 70
                                              },
                                              "text": ","
                                            },
                                            {
                                              "type": "keyword_argument",
                                              "start": {
                                                "row": 155,
                                                "column": 33
                                              },
                                              "end": {
                                                "row": 155,
                                                "column": 75
                                              },
                                              "text": "batch_end_callback=eval_batch_end_callback",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 155,
                                                    "column": 33
                                                  },
                                                  "end": {
                                                    "row": 155,
                                                    "column": 51
                                                  },
                                                  "text": "batch_end_callback"
                                                },
                                                {
                                                  "type": "=",
                                                  "start": {
                                                    "row": 155,
                                                    "column": 51
                                                  },
                                                  "end": {
                                                    "row": 155,
                                                    "column": 52
                                                  },
                                                  "text": "="
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 155,
                                                    "column": 52
                                                  },
                                                  "end": {
                                                    "row": 155,
                                                    "column": 75
                                                  },
                                                  "text": "eval_batch_end_callback"
                                                }
                                              ]
                                            },
                                            {
                                              "type": ",",
                                              "start": {
                                                "row": 155,
                                                "column": 75
                                              },
                                              "end": {
                                                "row": 155,
                                                "column": 76
                                              },
                                              "text": ","
                                            },
                                            {
                                              "type": "keyword_argument",
                                              "start": {
                                                "row": 155,
                                                "column": 77
                                              },
                                              "end": {
                                                "row": 155,
                                                "column": 88
                                              },
                                              "text": "epoch=epoch",
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 155,
                                                    "column": 77
                                                  },
                                                  "end": {
                                                    "row": 155,
                                                    "column": 82
                                                  },
                                                  "text": "epoch"
                                                },
                                                {
                                                  "type": "=",
                                                  "start": {
                                                    "row": 155,
                                                    "column": 82
                                                  },
                                                  "end": {
                                                    "row": 155,
                                                    "column": 83
                                                  },
                                                  "text": "="
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 155,
                                                    "column": 83
                                                  },
                                                  "end": {
                                                    "row": 155,
                                                    "column": 88
                                                  },
                                                  "text": "epoch"
                                                }
                                              ]
                                            },
                                            {
                                              "type": ")",
                                              "start": {
                                                "row": 155,
                                                "column": 88
                                              },
                                              "end": {
                                                "row": 155,
                                                "column": 89
                                              },
                                              "text": ")"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "for_statement",
                              "start": {
                                "row": 156,
                                "column": 16
                              },
                              "end": {
                                "row": 157,
                                "column": 84
                              },
                              "text": "for name, val in res:\n                    self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                              "children": [
                                {
                                  "type": "for",
                                  "start": {
                                    "row": 156,
                                    "column": 16
                                  },
                                  "end": {
                                    "row": 156,
                                    "column": 19
                                  },
                                  "text": "for"
                                },
                                {
                                  "type": "pattern_list",
                                  "start": {
                                    "row": 156,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 156,
                                    "column": 29
                                  },
                                  "text": "name, val",
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 156,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 156,
                                        "column": 24
                                      },
                                      "text": "name"
                                    },
                                    {
                                      "type": ",",
                                      "start": {
                                        "row": 156,
                                        "column": 24
                                      },
                                      "end": {
                                        "row": 156,
                                        "column": 25
                                      },
                                      "text": ","
                                    },
                                    {
                                      "type": "identifier",
                                      "start": {
                                        "row": 156,
                                        "column": 26
                                      },
                                      "end": {
                                        "row": 156,
                                        "column": 29
                                      },
                                      "text": "val"
                                    }
                                  ]
                                },
                                {
                                  "type": "in",
                                  "start": {
                                    "row": 156,
                                    "column": 30
                                  },
                                  "end": {
                                    "row": 156,
                                    "column": 32
                                  },
                                  "text": "in"
                                },
                                {
                                  "type": "identifier",
                                  "start": {
                                    "row": 156,
                                    "column": 33
                                  },
                                  "end": {
                                    "row": 156,
                                    "column": 36
                                  },
                                  "text": "res"
                                },
                                {
                                  "type": ":",
                                  "start": {
                                    "row": 156,
                                    "column": 36
                                  },
                                  "end": {
                                    "row": 156,
                                    "column": 37
                                  },
                                  "text": ":"
                                },
                                {
                                  "type": "block",
                                  "start": {
                                    "row": 157,
                                    "column": 20
                                  },
                                  "end": {
                                    "row": 157,
                                    "column": 84
                                  },
                                  "text": "self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                                  "children": [
                                    {
                                      "type": "expression_statement",
                                      "start": {
                                        "row": 157,
                                        "column": 20
                                      },
                                      "end": {
                                        "row": 157,
                                        "column": 84
                                      },
                                      "text": "self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                                      "children": [
                                        {
                                          "type": "call",
                                          "start": {
                                            "row": 157,
                                            "column": 20
                                          },
                                          "end": {
                                            "row": 157,
                                            "column": 84
                                          },
                                          "text": "self.logger.info('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                                          "children": [
                                            {
                                              "type": "attribute",
                                              "start": {
                                                "row": 157,
                                                "column": 20
                                              },
                                              "end": {
                                                "row": 157,
                                                "column": 36
                                              },
                                              "text": "self.logger.info",
                                              "children": [
                                                {
                                                  "type": "attribute",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 20
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 31
                                                  },
                                                  "text": "self.logger",
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 157,
                                                        "column": 20
                                                      },
                                                      "end": {
                                                        "row": 157,
                                                        "column": 24
                                                      },
                                                      "text": "self"
                                                    },
                                                    {
                                                      "type": ".",
                                                      "start": {
                                                        "row": 157,
                                                        "column": 24
                                                      },
                                                      "end": {
                                                        "row": 157,
                                                        "column": 25
                                                      },
                                                      "text": "."
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "start": {
                                                        "row": 157,
                                                        "column": 25
                                                      },
                                                      "end": {
                                                        "row": 157,
                                                        "column": 31
                                                      },
                                                      "text": "logger"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ".",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 31
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 32
                                                  },
                                                  "text": "."
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 32
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 36
                                                  },
                                                  "text": "info"
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "start": {
                                                "row": 157,
                                                "column": 36
                                              },
                                              "end": {
                                                "row": 157,
                                                "column": 84
                                              },
                                              "text": "('Epoch[%d] Validation-%s=%f', epoch, name, val)",
                                              "children": [
                                                {
                                                  "type": "(",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 36
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 37
                                                  },
                                                  "text": "("
                                                },
                                                {
                                                  "type": "string",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 37
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 65
                                                  },
                                                  "text": "'Epoch[%d] Validation-%s=%f'",
                                                  "children": [
                                                    {
                                                      "type": "string_start",
                                                      "start": {
                                                        "row": 157,
                                                        "column": 37
                                                      },
                                                      "end": {
                                                        "row": 157,
                                                        "column": 38
                                                      },
                                                      "text": "'"
                                                    },
                                                    {
                                                      "type": "string_content",
                                                      "start": {
                                                        "row": 157,
                                                        "column": 38
                                                      },
                                                      "end": {
                                                        "row": 157,
                                                        "column": 64
                                                      },
                                                      "text": "Epoch[%d] Validation-%s=%f"
                                                    },
                                                    {
                                                      "type": "string_end",
                                                      "start": {
                                                        "row": 157,
                                                        "column": 64
                                                      },
                                                      "end": {
                                                        "row": 157,
                                                        "column": 65
                                                      },
                                                      "text": "'"
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 65
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 66
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 67
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 72
                                                  },
                                                  "text": "epoch"
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 72
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 73
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 74
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 78
                                                  },
                                                  "text": "name"
                                                },
                                                {
                                                  "type": ",",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 78
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 79
                                                  },
                                                  "text": ","
                                                },
                                                {
                                                  "type": "identifier",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 80
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 83
                                                  },
                                                  "text": "val"
                                                },
                                                {
                                                  "type": ")",
                                                  "start": {
                                                    "row": 157,
                                                    "column": 83
                                                  },
                                                  "end": {
                                                    "row": 157,
                                                    "column": 84
                                                  },
                                                  "text": ")"
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}